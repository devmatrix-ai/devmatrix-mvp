{
  "timestamp": "2025-11-03T14:02:35.022683",
  "summary": {
    "total_queries": 30,
    "passed_queries": 30,
    "failed_queries": 0,
    "coverage": 100.0,
    "avg_similarity": 0.8125746245333334
  },
  "results": [
    {
      "query": "repository pattern with SQLAlchemy async",
      "category": "architecture",
      "found": 5,
      "expected": 1,
      "avg_similarity": 0.8125746399999999,
      "passed": true,
      "examples": [
        {
          "id": "f7cd7a35-a101-4562-abc7-d2ede1adad3a",
          "code": "from typing import Optional\nfrom fastapi import FastAPI, status\nfrom pydantic import BaseModel\n\nclass Item(BaseModel):\n    name: str\n    description: Optional[str] = None\n    price: float\n    tax: float = 10.5\n    tags: list[str] = []\n\napp = FastAPI()\n\n@app.post(\"/items/\", response_model=Item, status_code=status.HTTP_201_CREATED)\nasync def create_item(item: Item):\n    item_dict = item.dict()\n    if item.tax:\n        price_with_tax = item.price + item.tax\n        item_dict.update({\"price_with_tax\": price_with_tax})\n    return item_dict\n\n@app.get(\"/items/\", response_model=list[Item])\nasync def read_items():\n    return [\n        {\"name\": \"Foo\", \"price\": 50},\n        {\"name\": \"Bar\", \"description\": \"The bartenders\", \"price\": 62, \"tax\": 20.2},\n        {\"name\": \"Baz\", \"price\": 50.2, \"tax\": 10.5, \"tags\": [\"tag1\"]},\n    ]",
          "metadata": {
            "source": "official_docs",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "framework": "fastapi",
            "docs_section": "Advanced - Response Model",
            "quality": "official_example",
            "task_type": "api_development",
            "language": "python",
            "approved": true,
            "code_length": 824,
            "complexity": "medium",
            "pattern": "fastapi_response_model",
            "tags": "fastapi,response-model,status,http",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257468,
          "rank": 1,
          "relevance_score": 0.8825746800000001,
          "mmr_score": null
        },
        {
          "id": "a7f7bd26-f761-4863-ba1a-02271291508f",
          "code": "from sqlalchemy.ext.hybrid import hybrid_property\nfrom sqlalchemy.orm import Mapped, mapped_column\n\nclass Product(Base):\n    __tablename__ = \"products\"\n    id: Mapped[int] = mapped_column(primary_key=True)\n    name: Mapped[str]\n    _price: Mapped[float] = mapped_column(\"price\")\n    tax_rate: Mapped[float] = mapped_column(default=0.10)\n    \n    @hybrid_property\n    def price_with_tax(self) -> float:\n        return self._price * (1 + self.tax_rate)\n    \n    @price_with_tax.expression\n    def price_with_tax(cls):\n        return cls._price * (1 + cls.tax_rate)\n\nasync def get_expensive_products(session):\n    stmt = select(Product).where(Product.price_with_tax > 100)\n    return await session.execute(stmt)",
          "metadata": {
            "task_type": "database_patterns",
            "quality": "production",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "language": "python",
            "framework": "sqlalchemy",
            "pattern": "sqlalchemy_hybrid_property",
            "code_length": 708,
            "approved": true,
            "complexity": "high",
            "tags": "sqlalchemy,hybrid_property,computed,expressions",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 2,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "711b0da2-ab81-4e4a-85f3-efa7c2c2f712",
          "code": "# Multi-stage Dockerfile\nFROM python:3.12-slim as builder\nWORKDIR /app\nRUN python -m venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nCOPY requirements.txt .\nRUN pip install --no-cache-dir -r requirements.txt\n\nFROM python:3.12-slim\nWORKDIR /app\nCOPY --from=builder /opt/venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nRUN useradd -m appuser\nCOPY . .\nUSER appuser\nHEALTHCHECK CMD curl -f http://localhost:8000/health\nEXPOSE 8000\nCMD [\"uvicorn\", \"main:app\", \"--host\", \"0.0.0.0\"]",
          "metadata": {
            "code_length": 471,
            "task_type": "deployment",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "language": "dockerfile",
            "complexity": "medium",
            "tags": "docker,multistage,optimization",
            "pattern": "docker_multistage",
            "framework": "docker",
            "approved": true,
            "quality": "production",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 3,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "47a04ff3-af4b-4388-97ef-4b6779c36b19",
          "code": "from fastapi import FastAPI, BackgroundTasks\n\napp = FastAPI()\n\ndef write_log(message: str):\n    with open(\"log.txt\", \"a\") as f:\n        f.write(message + \"\n\")\n\n@app.post(\"/notify\")\nasync def send_notification(bg: BackgroundTasks, email: str):\n    bg.add_task(write_log, f\"Notify: {email}\")\n    return {\"status\": \"scheduled\"}",
          "metadata": {
            "framework": "fastapi",
            "tags": "fastapi,background,io",
            "code_length": 324,
            "pattern": "fastapi_background_tasks",
            "language": "python",
            "complexity": "low",
            "docs_section": "Background Tasks",
            "task_type": "background_jobs",
            "source": "official_docs",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "approved": true,
            "quality": "official_example",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 4,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "f909508d-1bb3-4a88-9807-1ee5059d9798",
          "code": "def decompose_data_pipeline_tasks(requirements: str) -> List[Task]:\n    '''Decompose data pipeline/ETL system into tasks.'''\n    return [\n        Task(\n            id=1,\n            name=\"Data Source Integration\",\n            description=\"Connect to data sources (APIs, databases, S3), implement connectors with retry logic\",\n            dependencies=[],\n            priority=\"high\",\n            estimated_time=\"2h\",\n            files=[\"connectors/api_connector.py\", \"connectors/db_connector.py\", \"connectors/s3_connector.py\"]\n        ),\n        Task(\n            id=2,\n            name=\"Data Validation & Quality Checks\",\n            description=\"Implement Great Expectations for data validation, define quality rules, alerting on anomalies\",\n            dependencies=[1],\n            priority=\"high\",\n            estimated_time=\"2.5h\",\n            files=[\"validation/expectations/\", \"validation/rules.py\", \"validation/quality_checks.py\"]\n        ),\n        Task(\n            id=3,\n            name=\"Data Transformation Layer\",\n            description=\"Build transformation pipeline with Pandas/Polars, implement data cleaning, enrichment, aggregation\",\n            dependencies=[2],\n            priority=\"high\",\n            estimated_time=\"3h\",\n            files=[\"transformers/cleaning.py\", \"transformers/enrichment.py\", \"transformers/aggregation.py\"]\n        ),\n        Task(\n            id=4,\n            name=\"Data Warehouse Loading\",\n            description=\"Implement incremental loading to data warehouse, handle deduplication, maintain idempotency\",\n            dependencies=[3],\n            priority=\"high\",\n            estimated_time=\"2h\",\n            files=[\"loaders/warehouse_loader.py\", \"loaders/incremental.py\"]\n        ),\n        Task(\n            id=5,\n            name=\"Orchestration & Scheduling\",\n            description=\"Setup Airflow/Prefect DAGs, define dependencies, configure retries and SLAs\",\n            dependencies=[4],\n            priority=\"medium\",\n            estimated_time=\"2h\",\n            files=[\"dags/main_pipeline.py\", \"dags/monitoring.py\"]\n        ),\n        Task(\n            id=6,\n            name=\"Monitoring & Alerting\",\n            description=\"Data quality metrics, pipeline performance monitoring, alerting on failures or anomalies\",\n            dependencies=[5],\n            priority=\"high\",\n            estimated_time=\"1.5h\",\n            files=[\"monitoring/metrics.py\", \"monitoring/alerts.py\"]\n        ),\n    ]",
          "metadata": {
            "task_type": "project_planning",
            "code_length": 2460,
            "tags": "planning,etl,data_engineering,pipeline,airflow",
            "complexity": "high",
            "pattern": "task_decomposition",
            "quality": "production",
            "language": "python",
            "approved": true,
            "indexed_at": "2025-11-03T12:59:49.615879",
            "project_type": "data_pipeline",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 5,
          "relevance_score": 0.86257463,
          "mmr_score": null
        }
      ]
    },
    {
      "query": "service layer with business logic separation",
      "category": "architecture",
      "found": 5,
      "expected": 1,
      "avg_similarity": 0.8125746399999999,
      "passed": true,
      "examples": [
        {
          "id": "f7cd7a35-a101-4562-abc7-d2ede1adad3a",
          "code": "from typing import Optional\nfrom fastapi import FastAPI, status\nfrom pydantic import BaseModel\n\nclass Item(BaseModel):\n    name: str\n    description: Optional[str] = None\n    price: float\n    tax: float = 10.5\n    tags: list[str] = []\n\napp = FastAPI()\n\n@app.post(\"/items/\", response_model=Item, status_code=status.HTTP_201_CREATED)\nasync def create_item(item: Item):\n    item_dict = item.dict()\n    if item.tax:\n        price_with_tax = item.price + item.tax\n        item_dict.update({\"price_with_tax\": price_with_tax})\n    return item_dict\n\n@app.get(\"/items/\", response_model=list[Item])\nasync def read_items():\n    return [\n        {\"name\": \"Foo\", \"price\": 50},\n        {\"name\": \"Bar\", \"description\": \"The bartenders\", \"price\": 62, \"tax\": 20.2},\n        {\"name\": \"Baz\", \"price\": 50.2, \"tax\": 10.5, \"tags\": [\"tag1\"]},\n    ]",
          "metadata": {
            "tags": "fastapi,response-model,status,http",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "language": "python",
            "approved": true,
            "framework": "fastapi",
            "complexity": "medium",
            "source": "official_docs",
            "quality": "official_example",
            "docs_section": "Advanced - Response Model",
            "task_type": "api_development",
            "code_length": 824,
            "pattern": "fastapi_response_model",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257468,
          "rank": 1,
          "relevance_score": 0.8825746800000001,
          "mmr_score": null
        },
        {
          "id": "a7f7bd26-f761-4863-ba1a-02271291508f",
          "code": "from sqlalchemy.ext.hybrid import hybrid_property\nfrom sqlalchemy.orm import Mapped, mapped_column\n\nclass Product(Base):\n    __tablename__ = \"products\"\n    id: Mapped[int] = mapped_column(primary_key=True)\n    name: Mapped[str]\n    _price: Mapped[float] = mapped_column(\"price\")\n    tax_rate: Mapped[float] = mapped_column(default=0.10)\n    \n    @hybrid_property\n    def price_with_tax(self) -> float:\n        return self._price * (1 + self.tax_rate)\n    \n    @price_with_tax.expression\n    def price_with_tax(cls):\n        return cls._price * (1 + cls.tax_rate)\n\nasync def get_expensive_products(session):\n    stmt = select(Product).where(Product.price_with_tax > 100)\n    return await session.execute(stmt)",
          "metadata": {
            "code_length": 708,
            "approved": true,
            "indexed_at": "2025-11-03T12:59:49.615879",
            "complexity": "high",
            "pattern": "sqlalchemy_hybrid_property",
            "language": "python",
            "tags": "sqlalchemy,hybrid_property,computed,expressions",
            "quality": "production",
            "task_type": "database_patterns",
            "framework": "sqlalchemy",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 2,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "711b0da2-ab81-4e4a-85f3-efa7c2c2f712",
          "code": "# Multi-stage Dockerfile\nFROM python:3.12-slim as builder\nWORKDIR /app\nRUN python -m venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nCOPY requirements.txt .\nRUN pip install --no-cache-dir -r requirements.txt\n\nFROM python:3.12-slim\nWORKDIR /app\nCOPY --from=builder /opt/venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nRUN useradd -m appuser\nCOPY . .\nUSER appuser\nHEALTHCHECK CMD curl -f http://localhost:8000/health\nEXPOSE 8000\nCMD [\"uvicorn\", \"main:app\", \"--host\", \"0.0.0.0\"]",
          "metadata": {
            "language": "dockerfile",
            "approved": true,
            "indexed_at": "2025-11-03T12:59:49.615879",
            "quality": "production",
            "complexity": "medium",
            "tags": "docker,multistage,optimization",
            "pattern": "docker_multistage",
            "code_length": 471,
            "task_type": "deployment",
            "framework": "docker",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 3,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "47a04ff3-af4b-4388-97ef-4b6779c36b19",
          "code": "from fastapi import FastAPI, BackgroundTasks\n\napp = FastAPI()\n\ndef write_log(message: str):\n    with open(\"log.txt\", \"a\") as f:\n        f.write(message + \"\n\")\n\n@app.post(\"/notify\")\nasync def send_notification(bg: BackgroundTasks, email: str):\n    bg.add_task(write_log, f\"Notify: {email}\")\n    return {\"status\": \"scheduled\"}",
          "metadata": {
            "task_type": "background_jobs",
            "complexity": "low",
            "framework": "fastapi",
            "approved": true,
            "tags": "fastapi,background,io",
            "pattern": "fastapi_background_tasks",
            "quality": "official_example",
            "source": "official_docs",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "docs_section": "Background Tasks",
            "code_length": 324,
            "language": "python",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 4,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "f909508d-1bb3-4a88-9807-1ee5059d9798",
          "code": "def decompose_data_pipeline_tasks(requirements: str) -> List[Task]:\n    '''Decompose data pipeline/ETL system into tasks.'''\n    return [\n        Task(\n            id=1,\n            name=\"Data Source Integration\",\n            description=\"Connect to data sources (APIs, databases, S3), implement connectors with retry logic\",\n            dependencies=[],\n            priority=\"high\",\n            estimated_time=\"2h\",\n            files=[\"connectors/api_connector.py\", \"connectors/db_connector.py\", \"connectors/s3_connector.py\"]\n        ),\n        Task(\n            id=2,\n            name=\"Data Validation & Quality Checks\",\n            description=\"Implement Great Expectations for data validation, define quality rules, alerting on anomalies\",\n            dependencies=[1],\n            priority=\"high\",\n            estimated_time=\"2.5h\",\n            files=[\"validation/expectations/\", \"validation/rules.py\", \"validation/quality_checks.py\"]\n        ),\n        Task(\n            id=3,\n            name=\"Data Transformation Layer\",\n            description=\"Build transformation pipeline with Pandas/Polars, implement data cleaning, enrichment, aggregation\",\n            dependencies=[2],\n            priority=\"high\",\n            estimated_time=\"3h\",\n            files=[\"transformers/cleaning.py\", \"transformers/enrichment.py\", \"transformers/aggregation.py\"]\n        ),\n        Task(\n            id=4,\n            name=\"Data Warehouse Loading\",\n            description=\"Implement incremental loading to data warehouse, handle deduplication, maintain idempotency\",\n            dependencies=[3],\n            priority=\"high\",\n            estimated_time=\"2h\",\n            files=[\"loaders/warehouse_loader.py\", \"loaders/incremental.py\"]\n        ),\n        Task(\n            id=5,\n            name=\"Orchestration & Scheduling\",\n            description=\"Setup Airflow/Prefect DAGs, define dependencies, configure retries and SLAs\",\n            dependencies=[4],\n            priority=\"medium\",\n            estimated_time=\"2h\",\n            files=[\"dags/main_pipeline.py\", \"dags/monitoring.py\"]\n        ),\n        Task(\n            id=6,\n            name=\"Monitoring & Alerting\",\n            description=\"Data quality metrics, pipeline performance monitoring, alerting on failures or anomalies\",\n            dependencies=[5],\n            priority=\"high\",\n            estimated_time=\"1.5h\",\n            files=[\"monitoring/metrics.py\", \"monitoring/alerts.py\"]\n        ),\n    ]",
          "metadata": {
            "project_type": "data_pipeline",
            "pattern": "task_decomposition",
            "quality": "production",
            "complexity": "high",
            "approved": true,
            "tags": "planning,etl,data_engineering,pipeline,airflow",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "code_length": 2460,
            "task_type": "project_planning",
            "language": "python",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 5,
          "relevance_score": 0.86257463,
          "mmr_score": null
        }
      ]
    },
    {
      "query": "dependency injection in FastAPI",
      "category": "architecture",
      "found": 5,
      "expected": 1,
      "avg_similarity": 0.8125746399999999,
      "passed": true,
      "examples": [
        {
          "id": "f7cd7a35-a101-4562-abc7-d2ede1adad3a",
          "code": "from typing import Optional\nfrom fastapi import FastAPI, status\nfrom pydantic import BaseModel\n\nclass Item(BaseModel):\n    name: str\n    description: Optional[str] = None\n    price: float\n    tax: float = 10.5\n    tags: list[str] = []\n\napp = FastAPI()\n\n@app.post(\"/items/\", response_model=Item, status_code=status.HTTP_201_CREATED)\nasync def create_item(item: Item):\n    item_dict = item.dict()\n    if item.tax:\n        price_with_tax = item.price + item.tax\n        item_dict.update({\"price_with_tax\": price_with_tax})\n    return item_dict\n\n@app.get(\"/items/\", response_model=list[Item])\nasync def read_items():\n    return [\n        {\"name\": \"Foo\", \"price\": 50},\n        {\"name\": \"Bar\", \"description\": \"The bartenders\", \"price\": 62, \"tax\": 20.2},\n        {\"name\": \"Baz\", \"price\": 50.2, \"tax\": 10.5, \"tags\": [\"tag1\"]},\n    ]",
          "metadata": {
            "tags": "fastapi,response-model,status,http",
            "docs_section": "Advanced - Response Model",
            "complexity": "medium",
            "language": "python",
            "source": "official_docs",
            "quality": "official_example",
            "pattern": "fastapi_response_model",
            "task_type": "api_development",
            "approved": true,
            "code_length": 824,
            "indexed_at": "2025-11-03T12:59:49.615879",
            "framework": "fastapi",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257468,
          "rank": 1,
          "relevance_score": 0.8825746800000001,
          "mmr_score": null
        },
        {
          "id": "a7f7bd26-f761-4863-ba1a-02271291508f",
          "code": "from sqlalchemy.ext.hybrid import hybrid_property\nfrom sqlalchemy.orm import Mapped, mapped_column\n\nclass Product(Base):\n    __tablename__ = \"products\"\n    id: Mapped[int] = mapped_column(primary_key=True)\n    name: Mapped[str]\n    _price: Mapped[float] = mapped_column(\"price\")\n    tax_rate: Mapped[float] = mapped_column(default=0.10)\n    \n    @hybrid_property\n    def price_with_tax(self) -> float:\n        return self._price * (1 + self.tax_rate)\n    \n    @price_with_tax.expression\n    def price_with_tax(cls):\n        return cls._price * (1 + cls.tax_rate)\n\nasync def get_expensive_products(session):\n    stmt = select(Product).where(Product.price_with_tax > 100)\n    return await session.execute(stmt)",
          "metadata": {
            "pattern": "sqlalchemy_hybrid_property",
            "approved": true,
            "indexed_at": "2025-11-03T12:59:49.615879",
            "quality": "production",
            "framework": "sqlalchemy",
            "tags": "sqlalchemy,hybrid_property,computed,expressions",
            "complexity": "high",
            "language": "python",
            "task_type": "database_patterns",
            "code_length": 708,
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 2,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "711b0da2-ab81-4e4a-85f3-efa7c2c2f712",
          "code": "# Multi-stage Dockerfile\nFROM python:3.12-slim as builder\nWORKDIR /app\nRUN python -m venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nCOPY requirements.txt .\nRUN pip install --no-cache-dir -r requirements.txt\n\nFROM python:3.12-slim\nWORKDIR /app\nCOPY --from=builder /opt/venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nRUN useradd -m appuser\nCOPY . .\nUSER appuser\nHEALTHCHECK CMD curl -f http://localhost:8000/health\nEXPOSE 8000\nCMD [\"uvicorn\", \"main:app\", \"--host\", \"0.0.0.0\"]",
          "metadata": {
            "complexity": "medium",
            "pattern": "docker_multistage",
            "framework": "docker",
            "task_type": "deployment",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "approved": true,
            "quality": "production",
            "code_length": 471,
            "tags": "docker,multistage,optimization",
            "language": "dockerfile",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 3,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "47a04ff3-af4b-4388-97ef-4b6779c36b19",
          "code": "from fastapi import FastAPI, BackgroundTasks\n\napp = FastAPI()\n\ndef write_log(message: str):\n    with open(\"log.txt\", \"a\") as f:\n        f.write(message + \"\n\")\n\n@app.post(\"/notify\")\nasync def send_notification(bg: BackgroundTasks, email: str):\n    bg.add_task(write_log, f\"Notify: {email}\")\n    return {\"status\": \"scheduled\"}",
          "metadata": {
            "approved": true,
            "task_type": "background_jobs",
            "complexity": "low",
            "framework": "fastapi",
            "tags": "fastapi,background,io",
            "language": "python",
            "quality": "official_example",
            "code_length": 324,
            "source": "official_docs",
            "docs_section": "Background Tasks",
            "pattern": "fastapi_background_tasks",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 4,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "f909508d-1bb3-4a88-9807-1ee5059d9798",
          "code": "def decompose_data_pipeline_tasks(requirements: str) -> List[Task]:\n    '''Decompose data pipeline/ETL system into tasks.'''\n    return [\n        Task(\n            id=1,\n            name=\"Data Source Integration\",\n            description=\"Connect to data sources (APIs, databases, S3), implement connectors with retry logic\",\n            dependencies=[],\n            priority=\"high\",\n            estimated_time=\"2h\",\n            files=[\"connectors/api_connector.py\", \"connectors/db_connector.py\", \"connectors/s3_connector.py\"]\n        ),\n        Task(\n            id=2,\n            name=\"Data Validation & Quality Checks\",\n            description=\"Implement Great Expectations for data validation, define quality rules, alerting on anomalies\",\n            dependencies=[1],\n            priority=\"high\",\n            estimated_time=\"2.5h\",\n            files=[\"validation/expectations/\", \"validation/rules.py\", \"validation/quality_checks.py\"]\n        ),\n        Task(\n            id=3,\n            name=\"Data Transformation Layer\",\n            description=\"Build transformation pipeline with Pandas/Polars, implement data cleaning, enrichment, aggregation\",\n            dependencies=[2],\n            priority=\"high\",\n            estimated_time=\"3h\",\n            files=[\"transformers/cleaning.py\", \"transformers/enrichment.py\", \"transformers/aggregation.py\"]\n        ),\n        Task(\n            id=4,\n            name=\"Data Warehouse Loading\",\n            description=\"Implement incremental loading to data warehouse, handle deduplication, maintain idempotency\",\n            dependencies=[3],\n            priority=\"high\",\n            estimated_time=\"2h\",\n            files=[\"loaders/warehouse_loader.py\", \"loaders/incremental.py\"]\n        ),\n        Task(\n            id=5,\n            name=\"Orchestration & Scheduling\",\n            description=\"Setup Airflow/Prefect DAGs, define dependencies, configure retries and SLAs\",\n            dependencies=[4],\n            priority=\"medium\",\n            estimated_time=\"2h\",\n            files=[\"dags/main_pipeline.py\", \"dags/monitoring.py\"]\n        ),\n        Task(\n            id=6,\n            name=\"Monitoring & Alerting\",\n            description=\"Data quality metrics, pipeline performance monitoring, alerting on failures or anomalies\",\n            dependencies=[5],\n            priority=\"high\",\n            estimated_time=\"1.5h\",\n            files=[\"monitoring/metrics.py\", \"monitoring/alerts.py\"]\n        ),\n    ]",
          "metadata": {
            "indexed_at": "2025-11-03T12:59:49.615879",
            "approved": true,
            "task_type": "project_planning",
            "tags": "planning,etl,data_engineering,pipeline,airflow",
            "complexity": "high",
            "code_length": 2460,
            "pattern": "task_decomposition",
            "project_type": "data_pipeline",
            "language": "python",
            "quality": "production",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 5,
          "relevance_score": 0.86257463,
          "mmr_score": null
        }
      ]
    },
    {
      "query": "structured logging with correlation IDs",
      "category": "observability",
      "found": 5,
      "expected": 2,
      "avg_similarity": 0.8125745819999999,
      "passed": true,
      "examples": [
        {
          "id": "f7cd7a35-a101-4562-abc7-d2ede1adad3a",
          "code": "from typing import Optional\nfrom fastapi import FastAPI, status\nfrom pydantic import BaseModel\n\nclass Item(BaseModel):\n    name: str\n    description: Optional[str] = None\n    price: float\n    tax: float = 10.5\n    tags: list[str] = []\n\napp = FastAPI()\n\n@app.post(\"/items/\", response_model=Item, status_code=status.HTTP_201_CREATED)\nasync def create_item(item: Item):\n    item_dict = item.dict()\n    if item.tax:\n        price_with_tax = item.price + item.tax\n        item_dict.update({\"price_with_tax\": price_with_tax})\n    return item_dict\n\n@app.get(\"/items/\", response_model=list[Item])\nasync def read_items():\n    return [\n        {\"name\": \"Foo\", \"price\": 50},\n        {\"name\": \"Bar\", \"description\": \"The bartenders\", \"price\": 62, \"tax\": 20.2},\n        {\"name\": \"Baz\", \"price\": 50.2, \"tax\": 10.5, \"tags\": [\"tag1\"]},\n    ]",
          "metadata": {
            "tags": "fastapi,response-model,status,http",
            "task_type": "api_development",
            "source": "official_docs",
            "approved": true,
            "framework": "fastapi",
            "pattern": "fastapi_response_model",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "docs_section": "Advanced - Response Model",
            "quality": "official_example",
            "language": "python",
            "code_length": 824,
            "complexity": "medium",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 1,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "a7f7bd26-f761-4863-ba1a-02271291508f",
          "code": "from sqlalchemy.ext.hybrid import hybrid_property\nfrom sqlalchemy.orm import Mapped, mapped_column\n\nclass Product(Base):\n    __tablename__ = \"products\"\n    id: Mapped[int] = mapped_column(primary_key=True)\n    name: Mapped[str]\n    _price: Mapped[float] = mapped_column(\"price\")\n    tax_rate: Mapped[float] = mapped_column(default=0.10)\n    \n    @hybrid_property\n    def price_with_tax(self) -> float:\n        return self._price * (1 + self.tax_rate)\n    \n    @price_with_tax.expression\n    def price_with_tax(cls):\n        return cls._price * (1 + cls.tax_rate)\n\nasync def get_expensive_products(session):\n    stmt = select(Product).where(Product.price_with_tax > 100)\n    return await session.execute(stmt)",
          "metadata": {
            "complexity": "high",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "code_length": 708,
            "quality": "production",
            "tags": "sqlalchemy,hybrid_property,computed,expressions",
            "language": "python",
            "pattern": "sqlalchemy_hybrid_property",
            "task_type": "database_patterns",
            "framework": "sqlalchemy",
            "approved": true,
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257457,
          "rank": 2,
          "relevance_score": 0.8825745700000001,
          "mmr_score": null
        },
        {
          "id": "803efb55-2e90-4ffa-942c-1df8a3b92603",
          "code": "from circuitbreaker import circuit\nimport httpx\n\nclass ResilientClient:\n    @circuit(failure_threshold=5, recovery_timeout=60)\n    async def call_service(self, url: str) -> dict:\n        async with httpx.AsyncClient() as client:\n            response = await client.get(url)\n            response.raise_for_status()\n            return response.json()\n\n# Usage\nclient = ResilientClient()\ntry:\n    data = await client.call_service(\"http://api-service/endpoint\")\nexcept Exception as e:\n    # Handle circuit breaker open\n    pass",
          "metadata": {
            "pattern": "circuit_breaker",
            "quality": "production",
            "tags": "microservices,circuit-breaker,resilience",
            "task_type": "service_communication",
            "approved": true,
            "language": "python",
            "complexity": "high",
            "framework": "circuitbreaker",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "code_length": 523,
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257457,
          "rank": 3,
          "relevance_score": 0.8825745700000001,
          "mmr_score": null
        },
        {
          "id": "711b0da2-ab81-4e4a-85f3-efa7c2c2f712",
          "code": "# Multi-stage Dockerfile\nFROM python:3.12-slim as builder\nWORKDIR /app\nRUN python -m venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nCOPY requirements.txt .\nRUN pip install --no-cache-dir -r requirements.txt\n\nFROM python:3.12-slim\nWORKDIR /app\nCOPY --from=builder /opt/venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nRUN useradd -m appuser\nCOPY . .\nUSER appuser\nHEALTHCHECK CMD curl -f http://localhost:8000/health\nEXPOSE 8000\nCMD [\"uvicorn\", \"main:app\", \"--host\", \"0.0.0.0\"]",
          "metadata": {
            "framework": "docker",
            "tags": "docker,multistage,optimization",
            "approved": true,
            "pattern": "docker_multistage",
            "code_length": 471,
            "complexity": "medium",
            "task_type": "deployment",
            "quality": "production",
            "language": "dockerfile",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257457,
          "rank": 4,
          "relevance_score": 0.8825745700000001,
          "mmr_score": null
        },
        {
          "id": "47a04ff3-af4b-4388-97ef-4b6779c36b19",
          "code": "from fastapi import FastAPI, BackgroundTasks\n\napp = FastAPI()\n\ndef write_log(message: str):\n    with open(\"log.txt\", \"a\") as f:\n        f.write(message + \"\n\")\n\n@app.post(\"/notify\")\nasync def send_notification(bg: BackgroundTasks, email: str):\n    bg.add_task(write_log, f\"Notify: {email}\")\n    return {\"status\": \"scheduled\"}",
          "metadata": {
            "code_length": 324,
            "complexity": "low",
            "tags": "fastapi,background,io",
            "language": "python",
            "task_type": "background_jobs",
            "source": "official_docs",
            "framework": "fastapi",
            "docs_section": "Background Tasks",
            "approved": true,
            "quality": "official_example",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "pattern": "fastapi_background_tasks",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257457,
          "rank": 5,
          "relevance_score": 0.8825745700000001,
          "mmr_score": null
        }
      ]
    },
    {
      "query": "request/response logging middleware for FastAPI",
      "category": "observability",
      "found": 5,
      "expected": 1,
      "avg_similarity": 0.8125746399999999,
      "passed": true,
      "examples": [
        {
          "id": "f7cd7a35-a101-4562-abc7-d2ede1adad3a",
          "code": "from typing import Optional\nfrom fastapi import FastAPI, status\nfrom pydantic import BaseModel\n\nclass Item(BaseModel):\n    name: str\n    description: Optional[str] = None\n    price: float\n    tax: float = 10.5\n    tags: list[str] = []\n\napp = FastAPI()\n\n@app.post(\"/items/\", response_model=Item, status_code=status.HTTP_201_CREATED)\nasync def create_item(item: Item):\n    item_dict = item.dict()\n    if item.tax:\n        price_with_tax = item.price + item.tax\n        item_dict.update({\"price_with_tax\": price_with_tax})\n    return item_dict\n\n@app.get(\"/items/\", response_model=list[Item])\nasync def read_items():\n    return [\n        {\"name\": \"Foo\", \"price\": 50},\n        {\"name\": \"Bar\", \"description\": \"The bartenders\", \"price\": 62, \"tax\": 20.2},\n        {\"name\": \"Baz\", \"price\": 50.2, \"tax\": 10.5, \"tags\": [\"tag1\"]},\n    ]",
          "metadata": {
            "task_type": "api_development",
            "code_length": 824,
            "tags": "fastapi,response-model,status,http",
            "source": "official_docs",
            "framework": "fastapi",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "pattern": "fastapi_response_model",
            "docs_section": "Advanced - Response Model",
            "quality": "official_example",
            "language": "python",
            "complexity": "medium",
            "approved": true,
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257468,
          "rank": 1,
          "relevance_score": 0.8825746800000001,
          "mmr_score": null
        },
        {
          "id": "a7f7bd26-f761-4863-ba1a-02271291508f",
          "code": "from sqlalchemy.ext.hybrid import hybrid_property\nfrom sqlalchemy.orm import Mapped, mapped_column\n\nclass Product(Base):\n    __tablename__ = \"products\"\n    id: Mapped[int] = mapped_column(primary_key=True)\n    name: Mapped[str]\n    _price: Mapped[float] = mapped_column(\"price\")\n    tax_rate: Mapped[float] = mapped_column(default=0.10)\n    \n    @hybrid_property\n    def price_with_tax(self) -> float:\n        return self._price * (1 + self.tax_rate)\n    \n    @price_with_tax.expression\n    def price_with_tax(cls):\n        return cls._price * (1 + cls.tax_rate)\n\nasync def get_expensive_products(session):\n    stmt = select(Product).where(Product.price_with_tax > 100)\n    return await session.execute(stmt)",
          "metadata": {
            "approved": true,
            "code_length": 708,
            "indexed_at": "2025-11-03T12:59:49.615879",
            "tags": "sqlalchemy,hybrid_property,computed,expressions",
            "pattern": "sqlalchemy_hybrid_property",
            "task_type": "database_patterns",
            "language": "python",
            "quality": "production",
            "framework": "sqlalchemy",
            "complexity": "high",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 2,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "711b0da2-ab81-4e4a-85f3-efa7c2c2f712",
          "code": "# Multi-stage Dockerfile\nFROM python:3.12-slim as builder\nWORKDIR /app\nRUN python -m venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nCOPY requirements.txt .\nRUN pip install --no-cache-dir -r requirements.txt\n\nFROM python:3.12-slim\nWORKDIR /app\nCOPY --from=builder /opt/venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nRUN useradd -m appuser\nCOPY . .\nUSER appuser\nHEALTHCHECK CMD curl -f http://localhost:8000/health\nEXPOSE 8000\nCMD [\"uvicorn\", \"main:app\", \"--host\", \"0.0.0.0\"]",
          "metadata": {
            "task_type": "deployment",
            "quality": "production",
            "approved": true,
            "indexed_at": "2025-11-03T12:59:49.615879",
            "framework": "docker",
            "tags": "docker,multistage,optimization",
            "language": "dockerfile",
            "pattern": "docker_multistage",
            "code_length": 471,
            "complexity": "medium",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 3,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "47a04ff3-af4b-4388-97ef-4b6779c36b19",
          "code": "from fastapi import FastAPI, BackgroundTasks\n\napp = FastAPI()\n\ndef write_log(message: str):\n    with open(\"log.txt\", \"a\") as f:\n        f.write(message + \"\n\")\n\n@app.post(\"/notify\")\nasync def send_notification(bg: BackgroundTasks, email: str):\n    bg.add_task(write_log, f\"Notify: {email}\")\n    return {\"status\": \"scheduled\"}",
          "metadata": {
            "code_length": 324,
            "tags": "fastapi,background,io",
            "quality": "official_example",
            "pattern": "fastapi_background_tasks",
            "task_type": "background_jobs",
            "source": "official_docs",
            "docs_section": "Background Tasks",
            "language": "python",
            "framework": "fastapi",
            "complexity": "low",
            "approved": true,
            "indexed_at": "2025-11-03T12:59:49.615879",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 4,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "f909508d-1bb3-4a88-9807-1ee5059d9798",
          "code": "def decompose_data_pipeline_tasks(requirements: str) -> List[Task]:\n    '''Decompose data pipeline/ETL system into tasks.'''\n    return [\n        Task(\n            id=1,\n            name=\"Data Source Integration\",\n            description=\"Connect to data sources (APIs, databases, S3), implement connectors with retry logic\",\n            dependencies=[],\n            priority=\"high\",\n            estimated_time=\"2h\",\n            files=[\"connectors/api_connector.py\", \"connectors/db_connector.py\", \"connectors/s3_connector.py\"]\n        ),\n        Task(\n            id=2,\n            name=\"Data Validation & Quality Checks\",\n            description=\"Implement Great Expectations for data validation, define quality rules, alerting on anomalies\",\n            dependencies=[1],\n            priority=\"high\",\n            estimated_time=\"2.5h\",\n            files=[\"validation/expectations/\", \"validation/rules.py\", \"validation/quality_checks.py\"]\n        ),\n        Task(\n            id=3,\n            name=\"Data Transformation Layer\",\n            description=\"Build transformation pipeline with Pandas/Polars, implement data cleaning, enrichment, aggregation\",\n            dependencies=[2],\n            priority=\"high\",\n            estimated_time=\"3h\",\n            files=[\"transformers/cleaning.py\", \"transformers/enrichment.py\", \"transformers/aggregation.py\"]\n        ),\n        Task(\n            id=4,\n            name=\"Data Warehouse Loading\",\n            description=\"Implement incremental loading to data warehouse, handle deduplication, maintain idempotency\",\n            dependencies=[3],\n            priority=\"high\",\n            estimated_time=\"2h\",\n            files=[\"loaders/warehouse_loader.py\", \"loaders/incremental.py\"]\n        ),\n        Task(\n            id=5,\n            name=\"Orchestration & Scheduling\",\n            description=\"Setup Airflow/Prefect DAGs, define dependencies, configure retries and SLAs\",\n            dependencies=[4],\n            priority=\"medium\",\n            estimated_time=\"2h\",\n            files=[\"dags/main_pipeline.py\", \"dags/monitoring.py\"]\n        ),\n        Task(\n            id=6,\n            name=\"Monitoring & Alerting\",\n            description=\"Data quality metrics, pipeline performance monitoring, alerting on failures or anomalies\",\n            dependencies=[5],\n            priority=\"high\",\n            estimated_time=\"1.5h\",\n            files=[\"monitoring/metrics.py\", \"monitoring/alerts.py\"]\n        ),\n    ]",
          "metadata": {
            "quality": "production",
            "code_length": 2460,
            "task_type": "project_planning",
            "tags": "planning,etl,data_engineering,pipeline,airflow",
            "pattern": "task_decomposition",
            "language": "python",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "approved": true,
            "complexity": "high",
            "project_type": "data_pipeline",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 5,
          "relevance_score": 0.86257463,
          "mmr_score": null
        }
      ]
    },
    {
      "query": "timing context manager for performance logging",
      "category": "observability",
      "found": 5,
      "expected": 1,
      "avg_similarity": 0.8125746399999999,
      "passed": true,
      "examples": [
        {
          "id": "f7cd7a35-a101-4562-abc7-d2ede1adad3a",
          "code": "from typing import Optional\nfrom fastapi import FastAPI, status\nfrom pydantic import BaseModel\n\nclass Item(BaseModel):\n    name: str\n    description: Optional[str] = None\n    price: float\n    tax: float = 10.5\n    tags: list[str] = []\n\napp = FastAPI()\n\n@app.post(\"/items/\", response_model=Item, status_code=status.HTTP_201_CREATED)\nasync def create_item(item: Item):\n    item_dict = item.dict()\n    if item.tax:\n        price_with_tax = item.price + item.tax\n        item_dict.update({\"price_with_tax\": price_with_tax})\n    return item_dict\n\n@app.get(\"/items/\", response_model=list[Item])\nasync def read_items():\n    return [\n        {\"name\": \"Foo\", \"price\": 50},\n        {\"name\": \"Bar\", \"description\": \"The bartenders\", \"price\": 62, \"tax\": 20.2},\n        {\"name\": \"Baz\", \"price\": 50.2, \"tax\": 10.5, \"tags\": [\"tag1\"]},\n    ]",
          "metadata": {
            "complexity": "medium",
            "tags": "fastapi,response-model,status,http",
            "approved": true,
            "task_type": "api_development",
            "framework": "fastapi",
            "quality": "official_example",
            "docs_section": "Advanced - Response Model",
            "source": "official_docs",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "code_length": 824,
            "pattern": "fastapi_response_model",
            "language": "python",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257468,
          "rank": 1,
          "relevance_score": 0.8825746800000001,
          "mmr_score": null
        },
        {
          "id": "a7f7bd26-f761-4863-ba1a-02271291508f",
          "code": "from sqlalchemy.ext.hybrid import hybrid_property\nfrom sqlalchemy.orm import Mapped, mapped_column\n\nclass Product(Base):\n    __tablename__ = \"products\"\n    id: Mapped[int] = mapped_column(primary_key=True)\n    name: Mapped[str]\n    _price: Mapped[float] = mapped_column(\"price\")\n    tax_rate: Mapped[float] = mapped_column(default=0.10)\n    \n    @hybrid_property\n    def price_with_tax(self) -> float:\n        return self._price * (1 + self.tax_rate)\n    \n    @price_with_tax.expression\n    def price_with_tax(cls):\n        return cls._price * (1 + cls.tax_rate)\n\nasync def get_expensive_products(session):\n    stmt = select(Product).where(Product.price_with_tax > 100)\n    return await session.execute(stmt)",
          "metadata": {
            "code_length": 708,
            "pattern": "sqlalchemy_hybrid_property",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "language": "python",
            "approved": true,
            "task_type": "database_patterns",
            "tags": "sqlalchemy,hybrid_property,computed,expressions",
            "quality": "production",
            "complexity": "high",
            "framework": "sqlalchemy",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 2,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "711b0da2-ab81-4e4a-85f3-efa7c2c2f712",
          "code": "# Multi-stage Dockerfile\nFROM python:3.12-slim as builder\nWORKDIR /app\nRUN python -m venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nCOPY requirements.txt .\nRUN pip install --no-cache-dir -r requirements.txt\n\nFROM python:3.12-slim\nWORKDIR /app\nCOPY --from=builder /opt/venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nRUN useradd -m appuser\nCOPY . .\nUSER appuser\nHEALTHCHECK CMD curl -f http://localhost:8000/health\nEXPOSE 8000\nCMD [\"uvicorn\", \"main:app\", \"--host\", \"0.0.0.0\"]",
          "metadata": {
            "framework": "docker",
            "approved": true,
            "tags": "docker,multistage,optimization",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "task_type": "deployment",
            "code_length": 471,
            "language": "dockerfile",
            "complexity": "medium",
            "quality": "production",
            "pattern": "docker_multistage",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 3,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "47a04ff3-af4b-4388-97ef-4b6779c36b19",
          "code": "from fastapi import FastAPI, BackgroundTasks\n\napp = FastAPI()\n\ndef write_log(message: str):\n    with open(\"log.txt\", \"a\") as f:\n        f.write(message + \"\n\")\n\n@app.post(\"/notify\")\nasync def send_notification(bg: BackgroundTasks, email: str):\n    bg.add_task(write_log, f\"Notify: {email}\")\n    return {\"status\": \"scheduled\"}",
          "metadata": {
            "framework": "fastapi",
            "approved": true,
            "language": "python",
            "docs_section": "Background Tasks",
            "code_length": 324,
            "complexity": "low",
            "quality": "official_example",
            "tags": "fastapi,background,io",
            "source": "official_docs",
            "pattern": "fastapi_background_tasks",
            "task_type": "background_jobs",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 4,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "f909508d-1bb3-4a88-9807-1ee5059d9798",
          "code": "def decompose_data_pipeline_tasks(requirements: str) -> List[Task]:\n    '''Decompose data pipeline/ETL system into tasks.'''\n    return [\n        Task(\n            id=1,\n            name=\"Data Source Integration\",\n            description=\"Connect to data sources (APIs, databases, S3), implement connectors with retry logic\",\n            dependencies=[],\n            priority=\"high\",\n            estimated_time=\"2h\",\n            files=[\"connectors/api_connector.py\", \"connectors/db_connector.py\", \"connectors/s3_connector.py\"]\n        ),\n        Task(\n            id=2,\n            name=\"Data Validation & Quality Checks\",\n            description=\"Implement Great Expectations for data validation, define quality rules, alerting on anomalies\",\n            dependencies=[1],\n            priority=\"high\",\n            estimated_time=\"2.5h\",\n            files=[\"validation/expectations/\", \"validation/rules.py\", \"validation/quality_checks.py\"]\n        ),\n        Task(\n            id=3,\n            name=\"Data Transformation Layer\",\n            description=\"Build transformation pipeline with Pandas/Polars, implement data cleaning, enrichment, aggregation\",\n            dependencies=[2],\n            priority=\"high\",\n            estimated_time=\"3h\",\n            files=[\"transformers/cleaning.py\", \"transformers/enrichment.py\", \"transformers/aggregation.py\"]\n        ),\n        Task(\n            id=4,\n            name=\"Data Warehouse Loading\",\n            description=\"Implement incremental loading to data warehouse, handle deduplication, maintain idempotency\",\n            dependencies=[3],\n            priority=\"high\",\n            estimated_time=\"2h\",\n            files=[\"loaders/warehouse_loader.py\", \"loaders/incremental.py\"]\n        ),\n        Task(\n            id=5,\n            name=\"Orchestration & Scheduling\",\n            description=\"Setup Airflow/Prefect DAGs, define dependencies, configure retries and SLAs\",\n            dependencies=[4],\n            priority=\"medium\",\n            estimated_time=\"2h\",\n            files=[\"dags/main_pipeline.py\", \"dags/monitoring.py\"]\n        ),\n        Task(\n            id=6,\n            name=\"Monitoring & Alerting\",\n            description=\"Data quality metrics, pipeline performance monitoring, alerting on failures or anomalies\",\n            dependencies=[5],\n            priority=\"high\",\n            estimated_time=\"1.5h\",\n            files=[\"monitoring/metrics.py\", \"monitoring/alerts.py\"]\n        ),\n    ]",
          "metadata": {
            "approved": true,
            "code_length": 2460,
            "project_type": "data_pipeline",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "pattern": "task_decomposition",
            "task_type": "project_planning",
            "quality": "production",
            "language": "python",
            "complexity": "high",
            "tags": "planning,etl,data_engineering,pipeline,airflow",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 5,
          "relevance_score": 0.86257463,
          "mmr_score": null
        }
      ]
    },
    {
      "query": "error logging with stack traces and context",
      "category": "observability",
      "found": 5,
      "expected": 1,
      "avg_similarity": 0.8125746399999999,
      "passed": true,
      "examples": [
        {
          "id": "f7cd7a35-a101-4562-abc7-d2ede1adad3a",
          "code": "from typing import Optional\nfrom fastapi import FastAPI, status\nfrom pydantic import BaseModel\n\nclass Item(BaseModel):\n    name: str\n    description: Optional[str] = None\n    price: float\n    tax: float = 10.5\n    tags: list[str] = []\n\napp = FastAPI()\n\n@app.post(\"/items/\", response_model=Item, status_code=status.HTTP_201_CREATED)\nasync def create_item(item: Item):\n    item_dict = item.dict()\n    if item.tax:\n        price_with_tax = item.price + item.tax\n        item_dict.update({\"price_with_tax\": price_with_tax})\n    return item_dict\n\n@app.get(\"/items/\", response_model=list[Item])\nasync def read_items():\n    return [\n        {\"name\": \"Foo\", \"price\": 50},\n        {\"name\": \"Bar\", \"description\": \"The bartenders\", \"price\": 62, \"tax\": 20.2},\n        {\"name\": \"Baz\", \"price\": 50.2, \"tax\": 10.5, \"tags\": [\"tag1\"]},\n    ]",
          "metadata": {
            "complexity": "medium",
            "tags": "fastapi,response-model,status,http",
            "pattern": "fastapi_response_model",
            "framework": "fastapi",
            "language": "python",
            "quality": "official_example",
            "approved": true,
            "code_length": 824,
            "docs_section": "Advanced - Response Model",
            "task_type": "api_development",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "source": "official_docs",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257468,
          "rank": 1,
          "relevance_score": 0.8825746800000001,
          "mmr_score": null
        },
        {
          "id": "803efb55-2e90-4ffa-942c-1df8a3b92603",
          "code": "from circuitbreaker import circuit\nimport httpx\n\nclass ResilientClient:\n    @circuit(failure_threshold=5, recovery_timeout=60)\n    async def call_service(self, url: str) -> dict:\n        async with httpx.AsyncClient() as client:\n            response = await client.get(url)\n            response.raise_for_status()\n            return response.json()\n\n# Usage\nclient = ResilientClient()\ntry:\n    data = await client.call_service(\"http://api-service/endpoint\")\nexcept Exception as e:\n    # Handle circuit breaker open\n    pass",
          "metadata": {
            "framework": "circuitbreaker",
            "tags": "microservices,circuit-breaker,resilience",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "pattern": "circuit_breaker",
            "quality": "production",
            "complexity": "high",
            "language": "python",
            "code_length": 523,
            "task_type": "service_communication",
            "approved": true,
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 2,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "711b0da2-ab81-4e4a-85f3-efa7c2c2f712",
          "code": "# Multi-stage Dockerfile\nFROM python:3.12-slim as builder\nWORKDIR /app\nRUN python -m venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nCOPY requirements.txt .\nRUN pip install --no-cache-dir -r requirements.txt\n\nFROM python:3.12-slim\nWORKDIR /app\nCOPY --from=builder /opt/venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nRUN useradd -m appuser\nCOPY . .\nUSER appuser\nHEALTHCHECK CMD curl -f http://localhost:8000/health\nEXPOSE 8000\nCMD [\"uvicorn\", \"main:app\", \"--host\", \"0.0.0.0\"]",
          "metadata": {
            "quality": "production",
            "task_type": "deployment",
            "framework": "docker",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "pattern": "docker_multistage",
            "approved": true,
            "language": "dockerfile",
            "tags": "docker,multistage,optimization",
            "complexity": "medium",
            "code_length": 471,
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 3,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "47a04ff3-af4b-4388-97ef-4b6779c36b19",
          "code": "from fastapi import FastAPI, BackgroundTasks\n\napp = FastAPI()\n\ndef write_log(message: str):\n    with open(\"log.txt\", \"a\") as f:\n        f.write(message + \"\n\")\n\n@app.post(\"/notify\")\nasync def send_notification(bg: BackgroundTasks, email: str):\n    bg.add_task(write_log, f\"Notify: {email}\")\n    return {\"status\": \"scheduled\"}",
          "metadata": {
            "task_type": "background_jobs",
            "tags": "fastapi,background,io",
            "language": "python",
            "framework": "fastapi",
            "code_length": 324,
            "pattern": "fastapi_background_tasks",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "approved": true,
            "source": "official_docs",
            "docs_section": "Background Tasks",
            "quality": "official_example",
            "complexity": "low",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 4,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "f909508d-1bb3-4a88-9807-1ee5059d9798",
          "code": "def decompose_data_pipeline_tasks(requirements: str) -> List[Task]:\n    '''Decompose data pipeline/ETL system into tasks.'''\n    return [\n        Task(\n            id=1,\n            name=\"Data Source Integration\",\n            description=\"Connect to data sources (APIs, databases, S3), implement connectors with retry logic\",\n            dependencies=[],\n            priority=\"high\",\n            estimated_time=\"2h\",\n            files=[\"connectors/api_connector.py\", \"connectors/db_connector.py\", \"connectors/s3_connector.py\"]\n        ),\n        Task(\n            id=2,\n            name=\"Data Validation & Quality Checks\",\n            description=\"Implement Great Expectations for data validation, define quality rules, alerting on anomalies\",\n            dependencies=[1],\n            priority=\"high\",\n            estimated_time=\"2.5h\",\n            files=[\"validation/expectations/\", \"validation/rules.py\", \"validation/quality_checks.py\"]\n        ),\n        Task(\n            id=3,\n            name=\"Data Transformation Layer\",\n            description=\"Build transformation pipeline with Pandas/Polars, implement data cleaning, enrichment, aggregation\",\n            dependencies=[2],\n            priority=\"high\",\n            estimated_time=\"3h\",\n            files=[\"transformers/cleaning.py\", \"transformers/enrichment.py\", \"transformers/aggregation.py\"]\n        ),\n        Task(\n            id=4,\n            name=\"Data Warehouse Loading\",\n            description=\"Implement incremental loading to data warehouse, handle deduplication, maintain idempotency\",\n            dependencies=[3],\n            priority=\"high\",\n            estimated_time=\"2h\",\n            files=[\"loaders/warehouse_loader.py\", \"loaders/incremental.py\"]\n        ),\n        Task(\n            id=5,\n            name=\"Orchestration & Scheduling\",\n            description=\"Setup Airflow/Prefect DAGs, define dependencies, configure retries and SLAs\",\n            dependencies=[4],\n            priority=\"medium\",\n            estimated_time=\"2h\",\n            files=[\"dags/main_pipeline.py\", \"dags/monitoring.py\"]\n        ),\n        Task(\n            id=6,\n            name=\"Monitoring & Alerting\",\n            description=\"Data quality metrics, pipeline performance monitoring, alerting on failures or anomalies\",\n            dependencies=[5],\n            priority=\"high\",\n            estimated_time=\"1.5h\",\n            files=[\"monitoring/metrics.py\", \"monitoring/alerts.py\"]\n        ),\n    ]",
          "metadata": {
            "task_type": "project_planning",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "complexity": "high",
            "code_length": 2460,
            "project_type": "data_pipeline",
            "pattern": "task_decomposition",
            "language": "python",
            "quality": "production",
            "approved": true,
            "tags": "planning,etl,data_engineering,pipeline,airflow",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 5,
          "relevance_score": 0.86257463,
          "mmr_score": null
        }
      ]
    },
    {
      "query": "prevent N+1 queries in SQLAlchemy with eager loading",
      "category": "performance",
      "found": 5,
      "expected": 2,
      "avg_similarity": 0.8125745819999999,
      "passed": true,
      "examples": [
        {
          "id": "f7cd7a35-a101-4562-abc7-d2ede1adad3a",
          "code": "from typing import Optional\nfrom fastapi import FastAPI, status\nfrom pydantic import BaseModel\n\nclass Item(BaseModel):\n    name: str\n    description: Optional[str] = None\n    price: float\n    tax: float = 10.5\n    tags: list[str] = []\n\napp = FastAPI()\n\n@app.post(\"/items/\", response_model=Item, status_code=status.HTTP_201_CREATED)\nasync def create_item(item: Item):\n    item_dict = item.dict()\n    if item.tax:\n        price_with_tax = item.price + item.tax\n        item_dict.update({\"price_with_tax\": price_with_tax})\n    return item_dict\n\n@app.get(\"/items/\", response_model=list[Item])\nasync def read_items():\n    return [\n        {\"name\": \"Foo\", \"price\": 50},\n        {\"name\": \"Bar\", \"description\": \"The bartenders\", \"price\": 62, \"tax\": 20.2},\n        {\"name\": \"Baz\", \"price\": 50.2, \"tax\": 10.5, \"tags\": [\"tag1\"]},\n    ]",
          "metadata": {
            "framework": "fastapi",
            "complexity": "medium",
            "code_length": 824,
            "quality": "official_example",
            "approved": true,
            "pattern": "fastapi_response_model",
            "source": "official_docs",
            "docs_section": "Advanced - Response Model",
            "language": "python",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "tags": "fastapi,response-model,status,http",
            "task_type": "api_development",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 1,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "a7f7bd26-f761-4863-ba1a-02271291508f",
          "code": "from sqlalchemy.ext.hybrid import hybrid_property\nfrom sqlalchemy.orm import Mapped, mapped_column\n\nclass Product(Base):\n    __tablename__ = \"products\"\n    id: Mapped[int] = mapped_column(primary_key=True)\n    name: Mapped[str]\n    _price: Mapped[float] = mapped_column(\"price\")\n    tax_rate: Mapped[float] = mapped_column(default=0.10)\n    \n    @hybrid_property\n    def price_with_tax(self) -> float:\n        return self._price * (1 + self.tax_rate)\n    \n    @price_with_tax.expression\n    def price_with_tax(cls):\n        return cls._price * (1 + cls.tax_rate)\n\nasync def get_expensive_products(session):\n    stmt = select(Product).where(Product.price_with_tax > 100)\n    return await session.execute(stmt)",
          "metadata": {
            "code_length": 708,
            "framework": "sqlalchemy",
            "quality": "production",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "tags": "sqlalchemy,hybrid_property,computed,expressions",
            "language": "python",
            "task_type": "database_patterns",
            "approved": true,
            "pattern": "sqlalchemy_hybrid_property",
            "complexity": "high",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257457,
          "rank": 2,
          "relevance_score": 0.8825745700000001,
          "mmr_score": null
        },
        {
          "id": "803efb55-2e90-4ffa-942c-1df8a3b92603",
          "code": "from circuitbreaker import circuit\nimport httpx\n\nclass ResilientClient:\n    @circuit(failure_threshold=5, recovery_timeout=60)\n    async def call_service(self, url: str) -> dict:\n        async with httpx.AsyncClient() as client:\n            response = await client.get(url)\n            response.raise_for_status()\n            return response.json()\n\n# Usage\nclient = ResilientClient()\ntry:\n    data = await client.call_service(\"http://api-service/endpoint\")\nexcept Exception as e:\n    # Handle circuit breaker open\n    pass",
          "metadata": {
            "tags": "microservices,circuit-breaker,resilience",
            "pattern": "circuit_breaker",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "approved": true,
            "framework": "circuitbreaker",
            "quality": "production",
            "task_type": "service_communication",
            "language": "python",
            "code_length": 523,
            "complexity": "high",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257457,
          "rank": 3,
          "relevance_score": 0.8825745700000001,
          "mmr_score": null
        },
        {
          "id": "711b0da2-ab81-4e4a-85f3-efa7c2c2f712",
          "code": "# Multi-stage Dockerfile\nFROM python:3.12-slim as builder\nWORKDIR /app\nRUN python -m venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nCOPY requirements.txt .\nRUN pip install --no-cache-dir -r requirements.txt\n\nFROM python:3.12-slim\nWORKDIR /app\nCOPY --from=builder /opt/venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nRUN useradd -m appuser\nCOPY . .\nUSER appuser\nHEALTHCHECK CMD curl -f http://localhost:8000/health\nEXPOSE 8000\nCMD [\"uvicorn\", \"main:app\", \"--host\", \"0.0.0.0\"]",
          "metadata": {
            "framework": "docker",
            "code_length": 471,
            "language": "dockerfile",
            "complexity": "medium",
            "pattern": "docker_multistage",
            "quality": "production",
            "task_type": "deployment",
            "tags": "docker,multistage,optimization",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "approved": true,
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257457,
          "rank": 4,
          "relevance_score": 0.8825745700000001,
          "mmr_score": null
        },
        {
          "id": "47a04ff3-af4b-4388-97ef-4b6779c36b19",
          "code": "from fastapi import FastAPI, BackgroundTasks\n\napp = FastAPI()\n\ndef write_log(message: str):\n    with open(\"log.txt\", \"a\") as f:\n        f.write(message + \"\n\")\n\n@app.post(\"/notify\")\nasync def send_notification(bg: BackgroundTasks, email: str):\n    bg.add_task(write_log, f\"Notify: {email}\")\n    return {\"status\": \"scheduled\"}",
          "metadata": {
            "pattern": "fastapi_background_tasks",
            "framework": "fastapi",
            "task_type": "background_jobs",
            "complexity": "low",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "code_length": 324,
            "tags": "fastapi,background,io",
            "source": "official_docs",
            "approved": true,
            "docs_section": "Background Tasks",
            "quality": "official_example",
            "language": "python",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257457,
          "rank": 5,
          "relevance_score": 0.8825745700000001,
          "mmr_score": null
        }
      ]
    },
    {
      "query": "database query optimization selectinload joinedload",
      "category": "performance",
      "found": 5,
      "expected": 2,
      "avg_similarity": 0.8125746399999999,
      "passed": true,
      "examples": [
        {
          "id": "f7cd7a35-a101-4562-abc7-d2ede1adad3a",
          "code": "from typing import Optional\nfrom fastapi import FastAPI, status\nfrom pydantic import BaseModel\n\nclass Item(BaseModel):\n    name: str\n    description: Optional[str] = None\n    price: float\n    tax: float = 10.5\n    tags: list[str] = []\n\napp = FastAPI()\n\n@app.post(\"/items/\", response_model=Item, status_code=status.HTTP_201_CREATED)\nasync def create_item(item: Item):\n    item_dict = item.dict()\n    if item.tax:\n        price_with_tax = item.price + item.tax\n        item_dict.update({\"price_with_tax\": price_with_tax})\n    return item_dict\n\n@app.get(\"/items/\", response_model=list[Item])\nasync def read_items():\n    return [\n        {\"name\": \"Foo\", \"price\": 50},\n        {\"name\": \"Bar\", \"description\": \"The bartenders\", \"price\": 62, \"tax\": 20.2},\n        {\"name\": \"Baz\", \"price\": 50.2, \"tax\": 10.5, \"tags\": [\"tag1\"]},\n    ]",
          "metadata": {
            "language": "python",
            "task_type": "api_development",
            "docs_section": "Advanced - Response Model",
            "tags": "fastapi,response-model,status,http",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "code_length": 824,
            "quality": "official_example",
            "complexity": "medium",
            "source": "official_docs",
            "pattern": "fastapi_response_model",
            "framework": "fastapi",
            "approved": true,
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257468,
          "rank": 1,
          "relevance_score": 0.8825746800000001,
          "mmr_score": null
        },
        {
          "id": "a7f7bd26-f761-4863-ba1a-02271291508f",
          "code": "from sqlalchemy.ext.hybrid import hybrid_property\nfrom sqlalchemy.orm import Mapped, mapped_column\n\nclass Product(Base):\n    __tablename__ = \"products\"\n    id: Mapped[int] = mapped_column(primary_key=True)\n    name: Mapped[str]\n    _price: Mapped[float] = mapped_column(\"price\")\n    tax_rate: Mapped[float] = mapped_column(default=0.10)\n    \n    @hybrid_property\n    def price_with_tax(self) -> float:\n        return self._price * (1 + self.tax_rate)\n    \n    @price_with_tax.expression\n    def price_with_tax(cls):\n        return cls._price * (1 + cls.tax_rate)\n\nasync def get_expensive_products(session):\n    stmt = select(Product).where(Product.price_with_tax > 100)\n    return await session.execute(stmt)",
          "metadata": {
            "framework": "sqlalchemy",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "code_length": 708,
            "approved": true,
            "pattern": "sqlalchemy_hybrid_property",
            "quality": "production",
            "task_type": "database_patterns",
            "complexity": "high",
            "language": "python",
            "tags": "sqlalchemy,hybrid_property,computed,expressions",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 2,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "803efb55-2e90-4ffa-942c-1df8a3b92603",
          "code": "from circuitbreaker import circuit\nimport httpx\n\nclass ResilientClient:\n    @circuit(failure_threshold=5, recovery_timeout=60)\n    async def call_service(self, url: str) -> dict:\n        async with httpx.AsyncClient() as client:\n            response = await client.get(url)\n            response.raise_for_status()\n            return response.json()\n\n# Usage\nclient = ResilientClient()\ntry:\n    data = await client.call_service(\"http://api-service/endpoint\")\nexcept Exception as e:\n    # Handle circuit breaker open\n    pass",
          "metadata": {
            "indexed_at": "2025-11-03T12:59:49.615879",
            "tags": "microservices,circuit-breaker,resilience",
            "quality": "production",
            "pattern": "circuit_breaker",
            "task_type": "service_communication",
            "code_length": 523,
            "complexity": "high",
            "language": "python",
            "framework": "circuitbreaker",
            "approved": true,
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 3,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "711b0da2-ab81-4e4a-85f3-efa7c2c2f712",
          "code": "# Multi-stage Dockerfile\nFROM python:3.12-slim as builder\nWORKDIR /app\nRUN python -m venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nCOPY requirements.txt .\nRUN pip install --no-cache-dir -r requirements.txt\n\nFROM python:3.12-slim\nWORKDIR /app\nCOPY --from=builder /opt/venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nRUN useradd -m appuser\nCOPY . .\nUSER appuser\nHEALTHCHECK CMD curl -f http://localhost:8000/health\nEXPOSE 8000\nCMD [\"uvicorn\", \"main:app\", \"--host\", \"0.0.0.0\"]",
          "metadata": {
            "approved": true,
            "complexity": "medium",
            "pattern": "docker_multistage",
            "task_type": "deployment",
            "language": "dockerfile",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "quality": "production",
            "tags": "docker,multistage,optimization",
            "framework": "docker",
            "code_length": 471,
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 4,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "f909508d-1bb3-4a88-9807-1ee5059d9798",
          "code": "def decompose_data_pipeline_tasks(requirements: str) -> List[Task]:\n    '''Decompose data pipeline/ETL system into tasks.'''\n    return [\n        Task(\n            id=1,\n            name=\"Data Source Integration\",\n            description=\"Connect to data sources (APIs, databases, S3), implement connectors with retry logic\",\n            dependencies=[],\n            priority=\"high\",\n            estimated_time=\"2h\",\n            files=[\"connectors/api_connector.py\", \"connectors/db_connector.py\", \"connectors/s3_connector.py\"]\n        ),\n        Task(\n            id=2,\n            name=\"Data Validation & Quality Checks\",\n            description=\"Implement Great Expectations for data validation, define quality rules, alerting on anomalies\",\n            dependencies=[1],\n            priority=\"high\",\n            estimated_time=\"2.5h\",\n            files=[\"validation/expectations/\", \"validation/rules.py\", \"validation/quality_checks.py\"]\n        ),\n        Task(\n            id=3,\n            name=\"Data Transformation Layer\",\n            description=\"Build transformation pipeline with Pandas/Polars, implement data cleaning, enrichment, aggregation\",\n            dependencies=[2],\n            priority=\"high\",\n            estimated_time=\"3h\",\n            files=[\"transformers/cleaning.py\", \"transformers/enrichment.py\", \"transformers/aggregation.py\"]\n        ),\n        Task(\n            id=4,\n            name=\"Data Warehouse Loading\",\n            description=\"Implement incremental loading to data warehouse, handle deduplication, maintain idempotency\",\n            dependencies=[3],\n            priority=\"high\",\n            estimated_time=\"2h\",\n            files=[\"loaders/warehouse_loader.py\", \"loaders/incremental.py\"]\n        ),\n        Task(\n            id=5,\n            name=\"Orchestration & Scheduling\",\n            description=\"Setup Airflow/Prefect DAGs, define dependencies, configure retries and SLAs\",\n            dependencies=[4],\n            priority=\"medium\",\n            estimated_time=\"2h\",\n            files=[\"dags/main_pipeline.py\", \"dags/monitoring.py\"]\n        ),\n        Task(\n            id=6,\n            name=\"Monitoring & Alerting\",\n            description=\"Data quality metrics, pipeline performance monitoring, alerting on failures or anomalies\",\n            dependencies=[5],\n            priority=\"high\",\n            estimated_time=\"1.5h\",\n            files=[\"monitoring/metrics.py\", \"monitoring/alerts.py\"]\n        ),\n    ]",
          "metadata": {
            "language": "python",
            "pattern": "task_decomposition",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "project_type": "data_pipeline",
            "quality": "production",
            "tags": "planning,etl,data_engineering,pipeline,airflow",
            "task_type": "project_planning",
            "code_length": 2460,
            "complexity": "high",
            "approved": true,
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 5,
          "relevance_score": 0.86257463,
          "mmr_score": null
        }
      ]
    },
    {
      "query": "Redis caching strategies and patterns",
      "category": "performance",
      "found": 5,
      "expected": 2,
      "avg_similarity": 0.8125746399999999,
      "passed": true,
      "examples": [
        {
          "id": "f7cd7a35-a101-4562-abc7-d2ede1adad3a",
          "code": "from typing import Optional\nfrom fastapi import FastAPI, status\nfrom pydantic import BaseModel\n\nclass Item(BaseModel):\n    name: str\n    description: Optional[str] = None\n    price: float\n    tax: float = 10.5\n    tags: list[str] = []\n\napp = FastAPI()\n\n@app.post(\"/items/\", response_model=Item, status_code=status.HTTP_201_CREATED)\nasync def create_item(item: Item):\n    item_dict = item.dict()\n    if item.tax:\n        price_with_tax = item.price + item.tax\n        item_dict.update({\"price_with_tax\": price_with_tax})\n    return item_dict\n\n@app.get(\"/items/\", response_model=list[Item])\nasync def read_items():\n    return [\n        {\"name\": \"Foo\", \"price\": 50},\n        {\"name\": \"Bar\", \"description\": \"The bartenders\", \"price\": 62, \"tax\": 20.2},\n        {\"name\": \"Baz\", \"price\": 50.2, \"tax\": 10.5, \"tags\": [\"tag1\"]},\n    ]",
          "metadata": {
            "tags": "fastapi,response-model,status,http",
            "language": "python",
            "complexity": "medium",
            "code_length": 824,
            "task_type": "api_development",
            "pattern": "fastapi_response_model",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "quality": "official_example",
            "docs_section": "Advanced - Response Model",
            "source": "official_docs",
            "approved": true,
            "framework": "fastapi",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257468,
          "rank": 1,
          "relevance_score": 0.8825746800000001,
          "mmr_score": null
        },
        {
          "id": "a7f7bd26-f761-4863-ba1a-02271291508f",
          "code": "from sqlalchemy.ext.hybrid import hybrid_property\nfrom sqlalchemy.orm import Mapped, mapped_column\n\nclass Product(Base):\n    __tablename__ = \"products\"\n    id: Mapped[int] = mapped_column(primary_key=True)\n    name: Mapped[str]\n    _price: Mapped[float] = mapped_column(\"price\")\n    tax_rate: Mapped[float] = mapped_column(default=0.10)\n    \n    @hybrid_property\n    def price_with_tax(self) -> float:\n        return self._price * (1 + self.tax_rate)\n    \n    @price_with_tax.expression\n    def price_with_tax(cls):\n        return cls._price * (1 + cls.tax_rate)\n\nasync def get_expensive_products(session):\n    stmt = select(Product).where(Product.price_with_tax > 100)\n    return await session.execute(stmt)",
          "metadata": {
            "tags": "sqlalchemy,hybrid_property,computed,expressions",
            "approved": true,
            "pattern": "sqlalchemy_hybrid_property",
            "task_type": "database_patterns",
            "complexity": "high",
            "language": "python",
            "quality": "production",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "framework": "sqlalchemy",
            "code_length": 708,
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 2,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "803efb55-2e90-4ffa-942c-1df8a3b92603",
          "code": "from circuitbreaker import circuit\nimport httpx\n\nclass ResilientClient:\n    @circuit(failure_threshold=5, recovery_timeout=60)\n    async def call_service(self, url: str) -> dict:\n        async with httpx.AsyncClient() as client:\n            response = await client.get(url)\n            response.raise_for_status()\n            return response.json()\n\n# Usage\nclient = ResilientClient()\ntry:\n    data = await client.call_service(\"http://api-service/endpoint\")\nexcept Exception as e:\n    # Handle circuit breaker open\n    pass",
          "metadata": {
            "framework": "circuitbreaker",
            "task_type": "service_communication",
            "tags": "microservices,circuit-breaker,resilience",
            "approved": true,
            "pattern": "circuit_breaker",
            "complexity": "high",
            "language": "python",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "quality": "production",
            "code_length": 523,
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 3,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "711b0da2-ab81-4e4a-85f3-efa7c2c2f712",
          "code": "# Multi-stage Dockerfile\nFROM python:3.12-slim as builder\nWORKDIR /app\nRUN python -m venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nCOPY requirements.txt .\nRUN pip install --no-cache-dir -r requirements.txt\n\nFROM python:3.12-slim\nWORKDIR /app\nCOPY --from=builder /opt/venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nRUN useradd -m appuser\nCOPY . .\nUSER appuser\nHEALTHCHECK CMD curl -f http://localhost:8000/health\nEXPOSE 8000\nCMD [\"uvicorn\", \"main:app\", \"--host\", \"0.0.0.0\"]",
          "metadata": {
            "tags": "docker,multistage,optimization",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "task_type": "deployment",
            "language": "dockerfile",
            "framework": "docker",
            "complexity": "medium",
            "approved": true,
            "quality": "production",
            "pattern": "docker_multistage",
            "code_length": 471,
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 4,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "f909508d-1bb3-4a88-9807-1ee5059d9798",
          "code": "def decompose_data_pipeline_tasks(requirements: str) -> List[Task]:\n    '''Decompose data pipeline/ETL system into tasks.'''\n    return [\n        Task(\n            id=1,\n            name=\"Data Source Integration\",\n            description=\"Connect to data sources (APIs, databases, S3), implement connectors with retry logic\",\n            dependencies=[],\n            priority=\"high\",\n            estimated_time=\"2h\",\n            files=[\"connectors/api_connector.py\", \"connectors/db_connector.py\", \"connectors/s3_connector.py\"]\n        ),\n        Task(\n            id=2,\n            name=\"Data Validation & Quality Checks\",\n            description=\"Implement Great Expectations for data validation, define quality rules, alerting on anomalies\",\n            dependencies=[1],\n            priority=\"high\",\n            estimated_time=\"2.5h\",\n            files=[\"validation/expectations/\", \"validation/rules.py\", \"validation/quality_checks.py\"]\n        ),\n        Task(\n            id=3,\n            name=\"Data Transformation Layer\",\n            description=\"Build transformation pipeline with Pandas/Polars, implement data cleaning, enrichment, aggregation\",\n            dependencies=[2],\n            priority=\"high\",\n            estimated_time=\"3h\",\n            files=[\"transformers/cleaning.py\", \"transformers/enrichment.py\", \"transformers/aggregation.py\"]\n        ),\n        Task(\n            id=4,\n            name=\"Data Warehouse Loading\",\n            description=\"Implement incremental loading to data warehouse, handle deduplication, maintain idempotency\",\n            dependencies=[3],\n            priority=\"high\",\n            estimated_time=\"2h\",\n            files=[\"loaders/warehouse_loader.py\", \"loaders/incremental.py\"]\n        ),\n        Task(\n            id=5,\n            name=\"Orchestration & Scheduling\",\n            description=\"Setup Airflow/Prefect DAGs, define dependencies, configure retries and SLAs\",\n            dependencies=[4],\n            priority=\"medium\",\n            estimated_time=\"2h\",\n            files=[\"dags/main_pipeline.py\", \"dags/monitoring.py\"]\n        ),\n        Task(\n            id=6,\n            name=\"Monitoring & Alerting\",\n            description=\"Data quality metrics, pipeline performance monitoring, alerting on failures or anomalies\",\n            dependencies=[5],\n            priority=\"high\",\n            estimated_time=\"1.5h\",\n            files=[\"monitoring/metrics.py\", \"monitoring/alerts.py\"]\n        ),\n    ]",
          "metadata": {
            "tags": "planning,etl,data_engineering,pipeline,airflow",
            "pattern": "task_decomposition",
            "task_type": "project_planning",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "code_length": 2460,
            "complexity": "high",
            "quality": "production",
            "approved": true,
            "project_type": "data_pipeline",
            "language": "python",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 5,
          "relevance_score": 0.86257463,
          "mmr_score": null
        }
      ]
    },
    {
      "query": "cache-aside pattern implementation",
      "category": "performance",
      "found": 5,
      "expected": 1,
      "avg_similarity": 0.8125745819999999,
      "passed": true,
      "examples": [
        {
          "id": "f7cd7a35-a101-4562-abc7-d2ede1adad3a",
          "code": "from typing import Optional\nfrom fastapi import FastAPI, status\nfrom pydantic import BaseModel\n\nclass Item(BaseModel):\n    name: str\n    description: Optional[str] = None\n    price: float\n    tax: float = 10.5\n    tags: list[str] = []\n\napp = FastAPI()\n\n@app.post(\"/items/\", response_model=Item, status_code=status.HTTP_201_CREATED)\nasync def create_item(item: Item):\n    item_dict = item.dict()\n    if item.tax:\n        price_with_tax = item.price + item.tax\n        item_dict.update({\"price_with_tax\": price_with_tax})\n    return item_dict\n\n@app.get(\"/items/\", response_model=list[Item])\nasync def read_items():\n    return [\n        {\"name\": \"Foo\", \"price\": 50},\n        {\"name\": \"Bar\", \"description\": \"The bartenders\", \"price\": 62, \"tax\": 20.2},\n        {\"name\": \"Baz\", \"price\": 50.2, \"tax\": 10.5, \"tags\": [\"tag1\"]},\n    ]",
          "metadata": {
            "pattern": "fastapi_response_model",
            "docs_section": "Advanced - Response Model",
            "approved": true,
            "tags": "fastapi,response-model,status,http",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "framework": "fastapi",
            "language": "python",
            "code_length": 824,
            "task_type": "api_development",
            "complexity": "medium",
            "quality": "official_example",
            "source": "official_docs",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 1,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "a7f7bd26-f761-4863-ba1a-02271291508f",
          "code": "from sqlalchemy.ext.hybrid import hybrid_property\nfrom sqlalchemy.orm import Mapped, mapped_column\n\nclass Product(Base):\n    __tablename__ = \"products\"\n    id: Mapped[int] = mapped_column(primary_key=True)\n    name: Mapped[str]\n    _price: Mapped[float] = mapped_column(\"price\")\n    tax_rate: Mapped[float] = mapped_column(default=0.10)\n    \n    @hybrid_property\n    def price_with_tax(self) -> float:\n        return self._price * (1 + self.tax_rate)\n    \n    @price_with_tax.expression\n    def price_with_tax(cls):\n        return cls._price * (1 + cls.tax_rate)\n\nasync def get_expensive_products(session):\n    stmt = select(Product).where(Product.price_with_tax > 100)\n    return await session.execute(stmt)",
          "metadata": {
            "code_length": 708,
            "tags": "sqlalchemy,hybrid_property,computed,expressions",
            "language": "python",
            "task_type": "database_patterns",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "quality": "production",
            "complexity": "high",
            "approved": true,
            "framework": "sqlalchemy",
            "pattern": "sqlalchemy_hybrid_property",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257457,
          "rank": 2,
          "relevance_score": 0.8825745700000001,
          "mmr_score": null
        },
        {
          "id": "803efb55-2e90-4ffa-942c-1df8a3b92603",
          "code": "from circuitbreaker import circuit\nimport httpx\n\nclass ResilientClient:\n    @circuit(failure_threshold=5, recovery_timeout=60)\n    async def call_service(self, url: str) -> dict:\n        async with httpx.AsyncClient() as client:\n            response = await client.get(url)\n            response.raise_for_status()\n            return response.json()\n\n# Usage\nclient = ResilientClient()\ntry:\n    data = await client.call_service(\"http://api-service/endpoint\")\nexcept Exception as e:\n    # Handle circuit breaker open\n    pass",
          "metadata": {
            "framework": "circuitbreaker",
            "language": "python",
            "approved": true,
            "complexity": "high",
            "quality": "production",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "tags": "microservices,circuit-breaker,resilience",
            "task_type": "service_communication",
            "code_length": 523,
            "pattern": "circuit_breaker",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257457,
          "rank": 3,
          "relevance_score": 0.8825745700000001,
          "mmr_score": null
        },
        {
          "id": "711b0da2-ab81-4e4a-85f3-efa7c2c2f712",
          "code": "# Multi-stage Dockerfile\nFROM python:3.12-slim as builder\nWORKDIR /app\nRUN python -m venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nCOPY requirements.txt .\nRUN pip install --no-cache-dir -r requirements.txt\n\nFROM python:3.12-slim\nWORKDIR /app\nCOPY --from=builder /opt/venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nRUN useradd -m appuser\nCOPY . .\nUSER appuser\nHEALTHCHECK CMD curl -f http://localhost:8000/health\nEXPOSE 8000\nCMD [\"uvicorn\", \"main:app\", \"--host\", \"0.0.0.0\"]",
          "metadata": {
            "approved": true,
            "task_type": "deployment",
            "code_length": 471,
            "pattern": "docker_multistage",
            "tags": "docker,multistage,optimization",
            "framework": "docker",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "language": "dockerfile",
            "quality": "production",
            "complexity": "medium",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257457,
          "rank": 4,
          "relevance_score": 0.8825745700000001,
          "mmr_score": null
        },
        {
          "id": "47a04ff3-af4b-4388-97ef-4b6779c36b19",
          "code": "from fastapi import FastAPI, BackgroundTasks\n\napp = FastAPI()\n\ndef write_log(message: str):\n    with open(\"log.txt\", \"a\") as f:\n        f.write(message + \"\n\")\n\n@app.post(\"/notify\")\nasync def send_notification(bg: BackgroundTasks, email: str):\n    bg.add_task(write_log, f\"Notify: {email}\")\n    return {\"status\": \"scheduled\"}",
          "metadata": {
            "indexed_at": "2025-11-03T12:59:49.615879",
            "source": "official_docs",
            "language": "python",
            "task_type": "background_jobs",
            "complexity": "low",
            "quality": "official_example",
            "tags": "fastapi,background,io",
            "code_length": 324,
            "pattern": "fastapi_background_tasks",
            "framework": "fastapi",
            "docs_section": "Background Tasks",
            "approved": true,
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257457,
          "rank": 5,
          "relevance_score": 0.8825745700000001,
          "mmr_score": null
        }
      ]
    },
    {
      "query": "async concurrent requests with asyncio gather",
      "category": "performance",
      "found": 5,
      "expected": 1,
      "avg_similarity": 0.8125746399999999,
      "passed": true,
      "examples": [
        {
          "id": "f7cd7a35-a101-4562-abc7-d2ede1adad3a",
          "code": "from typing import Optional\nfrom fastapi import FastAPI, status\nfrom pydantic import BaseModel\n\nclass Item(BaseModel):\n    name: str\n    description: Optional[str] = None\n    price: float\n    tax: float = 10.5\n    tags: list[str] = []\n\napp = FastAPI()\n\n@app.post(\"/items/\", response_model=Item, status_code=status.HTTP_201_CREATED)\nasync def create_item(item: Item):\n    item_dict = item.dict()\n    if item.tax:\n        price_with_tax = item.price + item.tax\n        item_dict.update({\"price_with_tax\": price_with_tax})\n    return item_dict\n\n@app.get(\"/items/\", response_model=list[Item])\nasync def read_items():\n    return [\n        {\"name\": \"Foo\", \"price\": 50},\n        {\"name\": \"Bar\", \"description\": \"The bartenders\", \"price\": 62, \"tax\": 20.2},\n        {\"name\": \"Baz\", \"price\": 50.2, \"tax\": 10.5, \"tags\": [\"tag1\"]},\n    ]",
          "metadata": {
            "complexity": "medium",
            "pattern": "fastapi_response_model",
            "source": "official_docs",
            "task_type": "api_development",
            "docs_section": "Advanced - Response Model",
            "framework": "fastapi",
            "approved": true,
            "quality": "official_example",
            "tags": "fastapi,response-model,status,http",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "code_length": 824,
            "language": "python",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257468,
          "rank": 1,
          "relevance_score": 0.8825746800000001,
          "mmr_score": null
        },
        {
          "id": "a7f7bd26-f761-4863-ba1a-02271291508f",
          "code": "from sqlalchemy.ext.hybrid import hybrid_property\nfrom sqlalchemy.orm import Mapped, mapped_column\n\nclass Product(Base):\n    __tablename__ = \"products\"\n    id: Mapped[int] = mapped_column(primary_key=True)\n    name: Mapped[str]\n    _price: Mapped[float] = mapped_column(\"price\")\n    tax_rate: Mapped[float] = mapped_column(default=0.10)\n    \n    @hybrid_property\n    def price_with_tax(self) -> float:\n        return self._price * (1 + self.tax_rate)\n    \n    @price_with_tax.expression\n    def price_with_tax(cls):\n        return cls._price * (1 + cls.tax_rate)\n\nasync def get_expensive_products(session):\n    stmt = select(Product).where(Product.price_with_tax > 100)\n    return await session.execute(stmt)",
          "metadata": {
            "task_type": "database_patterns",
            "tags": "sqlalchemy,hybrid_property,computed,expressions",
            "framework": "sqlalchemy",
            "approved": true,
            "language": "python",
            "complexity": "high",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "pattern": "sqlalchemy_hybrid_property",
            "quality": "production",
            "code_length": 708,
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 2,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "711b0da2-ab81-4e4a-85f3-efa7c2c2f712",
          "code": "# Multi-stage Dockerfile\nFROM python:3.12-slim as builder\nWORKDIR /app\nRUN python -m venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nCOPY requirements.txt .\nRUN pip install --no-cache-dir -r requirements.txt\n\nFROM python:3.12-slim\nWORKDIR /app\nCOPY --from=builder /opt/venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nRUN useradd -m appuser\nCOPY . .\nUSER appuser\nHEALTHCHECK CMD curl -f http://localhost:8000/health\nEXPOSE 8000\nCMD [\"uvicorn\", \"main:app\", \"--host\", \"0.0.0.0\"]",
          "metadata": {
            "quality": "production",
            "approved": true,
            "framework": "docker",
            "task_type": "deployment",
            "code_length": 471,
            "pattern": "docker_multistage",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "complexity": "medium",
            "tags": "docker,multistage,optimization",
            "language": "dockerfile",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 3,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "47a04ff3-af4b-4388-97ef-4b6779c36b19",
          "code": "from fastapi import FastAPI, BackgroundTasks\n\napp = FastAPI()\n\ndef write_log(message: str):\n    with open(\"log.txt\", \"a\") as f:\n        f.write(message + \"\n\")\n\n@app.post(\"/notify\")\nasync def send_notification(bg: BackgroundTasks, email: str):\n    bg.add_task(write_log, f\"Notify: {email}\")\n    return {\"status\": \"scheduled\"}",
          "metadata": {
            "task_type": "background_jobs",
            "language": "python",
            "source": "official_docs",
            "pattern": "fastapi_background_tasks",
            "complexity": "low",
            "quality": "official_example",
            "approved": true,
            "docs_section": "Background Tasks",
            "tags": "fastapi,background,io",
            "code_length": 324,
            "indexed_at": "2025-11-03T12:59:49.615879",
            "framework": "fastapi",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 4,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "f909508d-1bb3-4a88-9807-1ee5059d9798",
          "code": "def decompose_data_pipeline_tasks(requirements: str) -> List[Task]:\n    '''Decompose data pipeline/ETL system into tasks.'''\n    return [\n        Task(\n            id=1,\n            name=\"Data Source Integration\",\n            description=\"Connect to data sources (APIs, databases, S3), implement connectors with retry logic\",\n            dependencies=[],\n            priority=\"high\",\n            estimated_time=\"2h\",\n            files=[\"connectors/api_connector.py\", \"connectors/db_connector.py\", \"connectors/s3_connector.py\"]\n        ),\n        Task(\n            id=2,\n            name=\"Data Validation & Quality Checks\",\n            description=\"Implement Great Expectations for data validation, define quality rules, alerting on anomalies\",\n            dependencies=[1],\n            priority=\"high\",\n            estimated_time=\"2.5h\",\n            files=[\"validation/expectations/\", \"validation/rules.py\", \"validation/quality_checks.py\"]\n        ),\n        Task(\n            id=3,\n            name=\"Data Transformation Layer\",\n            description=\"Build transformation pipeline with Pandas/Polars, implement data cleaning, enrichment, aggregation\",\n            dependencies=[2],\n            priority=\"high\",\n            estimated_time=\"3h\",\n            files=[\"transformers/cleaning.py\", \"transformers/enrichment.py\", \"transformers/aggregation.py\"]\n        ),\n        Task(\n            id=4,\n            name=\"Data Warehouse Loading\",\n            description=\"Implement incremental loading to data warehouse, handle deduplication, maintain idempotency\",\n            dependencies=[3],\n            priority=\"high\",\n            estimated_time=\"2h\",\n            files=[\"loaders/warehouse_loader.py\", \"loaders/incremental.py\"]\n        ),\n        Task(\n            id=5,\n            name=\"Orchestration & Scheduling\",\n            description=\"Setup Airflow/Prefect DAGs, define dependencies, configure retries and SLAs\",\n            dependencies=[4],\n            priority=\"medium\",\n            estimated_time=\"2h\",\n            files=[\"dags/main_pipeline.py\", \"dags/monitoring.py\"]\n        ),\n        Task(\n            id=6,\n            name=\"Monitoring & Alerting\",\n            description=\"Data quality metrics, pipeline performance monitoring, alerting on failures or anomalies\",\n            dependencies=[5],\n            priority=\"high\",\n            estimated_time=\"1.5h\",\n            files=[\"monitoring/metrics.py\", \"monitoring/alerts.py\"]\n        ),\n    ]",
          "metadata": {
            "quality": "production",
            "pattern": "task_decomposition",
            "code_length": 2460,
            "approved": true,
            "project_type": "data_pipeline",
            "task_type": "project_planning",
            "tags": "planning,etl,data_engineering,pipeline,airflow",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "language": "python",
            "complexity": "high",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 5,
          "relevance_score": 0.86257463,
          "mmr_score": null
        }
      ]
    },
    {
      "query": "batch processing to avoid large IN clauses",
      "category": "performance",
      "found": 5,
      "expected": 1,
      "avg_similarity": 0.8125746399999999,
      "passed": true,
      "examples": [
        {
          "id": "f7cd7a35-a101-4562-abc7-d2ede1adad3a",
          "code": "from typing import Optional\nfrom fastapi import FastAPI, status\nfrom pydantic import BaseModel\n\nclass Item(BaseModel):\n    name: str\n    description: Optional[str] = None\n    price: float\n    tax: float = 10.5\n    tags: list[str] = []\n\napp = FastAPI()\n\n@app.post(\"/items/\", response_model=Item, status_code=status.HTTP_201_CREATED)\nasync def create_item(item: Item):\n    item_dict = item.dict()\n    if item.tax:\n        price_with_tax = item.price + item.tax\n        item_dict.update({\"price_with_tax\": price_with_tax})\n    return item_dict\n\n@app.get(\"/items/\", response_model=list[Item])\nasync def read_items():\n    return [\n        {\"name\": \"Foo\", \"price\": 50},\n        {\"name\": \"Bar\", \"description\": \"The bartenders\", \"price\": 62, \"tax\": 20.2},\n        {\"name\": \"Baz\", \"price\": 50.2, \"tax\": 10.5, \"tags\": [\"tag1\"]},\n    ]",
          "metadata": {
            "complexity": "medium",
            "quality": "official_example",
            "tags": "fastapi,response-model,status,http",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "approved": true,
            "pattern": "fastapi_response_model",
            "source": "official_docs",
            "framework": "fastapi",
            "code_length": 824,
            "task_type": "api_development",
            "docs_section": "Advanced - Response Model",
            "language": "python",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257468,
          "rank": 1,
          "relevance_score": 0.8825746800000001,
          "mmr_score": null
        },
        {
          "id": "a7f7bd26-f761-4863-ba1a-02271291508f",
          "code": "from sqlalchemy.ext.hybrid import hybrid_property\nfrom sqlalchemy.orm import Mapped, mapped_column\n\nclass Product(Base):\n    __tablename__ = \"products\"\n    id: Mapped[int] = mapped_column(primary_key=True)\n    name: Mapped[str]\n    _price: Mapped[float] = mapped_column(\"price\")\n    tax_rate: Mapped[float] = mapped_column(default=0.10)\n    \n    @hybrid_property\n    def price_with_tax(self) -> float:\n        return self._price * (1 + self.tax_rate)\n    \n    @price_with_tax.expression\n    def price_with_tax(cls):\n        return cls._price * (1 + cls.tax_rate)\n\nasync def get_expensive_products(session):\n    stmt = select(Product).where(Product.price_with_tax > 100)\n    return await session.execute(stmt)",
          "metadata": {
            "complexity": "high",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "tags": "sqlalchemy,hybrid_property,computed,expressions",
            "approved": true,
            "language": "python",
            "quality": "production",
            "task_type": "database_patterns",
            "pattern": "sqlalchemy_hybrid_property",
            "framework": "sqlalchemy",
            "code_length": 708,
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 2,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "711b0da2-ab81-4e4a-85f3-efa7c2c2f712",
          "code": "# Multi-stage Dockerfile\nFROM python:3.12-slim as builder\nWORKDIR /app\nRUN python -m venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nCOPY requirements.txt .\nRUN pip install --no-cache-dir -r requirements.txt\n\nFROM python:3.12-slim\nWORKDIR /app\nCOPY --from=builder /opt/venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nRUN useradd -m appuser\nCOPY . .\nUSER appuser\nHEALTHCHECK CMD curl -f http://localhost:8000/health\nEXPOSE 8000\nCMD [\"uvicorn\", \"main:app\", \"--host\", \"0.0.0.0\"]",
          "metadata": {
            "complexity": "medium",
            "tags": "docker,multistage,optimization",
            "quality": "production",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "pattern": "docker_multistage",
            "code_length": 471,
            "approved": true,
            "framework": "docker",
            "task_type": "deployment",
            "language": "dockerfile",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 3,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "47a04ff3-af4b-4388-97ef-4b6779c36b19",
          "code": "from fastapi import FastAPI, BackgroundTasks\n\napp = FastAPI()\n\ndef write_log(message: str):\n    with open(\"log.txt\", \"a\") as f:\n        f.write(message + \"\n\")\n\n@app.post(\"/notify\")\nasync def send_notification(bg: BackgroundTasks, email: str):\n    bg.add_task(write_log, f\"Notify: {email}\")\n    return {\"status\": \"scheduled\"}",
          "metadata": {
            "source": "official_docs",
            "pattern": "fastapi_background_tasks",
            "code_length": 324,
            "tags": "fastapi,background,io",
            "framework": "fastapi",
            "task_type": "background_jobs",
            "language": "python",
            "complexity": "low",
            "docs_section": "Background Tasks",
            "approved": true,
            "indexed_at": "2025-11-03T12:59:49.615879",
            "quality": "official_example",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 4,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "f909508d-1bb3-4a88-9807-1ee5059d9798",
          "code": "def decompose_data_pipeline_tasks(requirements: str) -> List[Task]:\n    '''Decompose data pipeline/ETL system into tasks.'''\n    return [\n        Task(\n            id=1,\n            name=\"Data Source Integration\",\n            description=\"Connect to data sources (APIs, databases, S3), implement connectors with retry logic\",\n            dependencies=[],\n            priority=\"high\",\n            estimated_time=\"2h\",\n            files=[\"connectors/api_connector.py\", \"connectors/db_connector.py\", \"connectors/s3_connector.py\"]\n        ),\n        Task(\n            id=2,\n            name=\"Data Validation & Quality Checks\",\n            description=\"Implement Great Expectations for data validation, define quality rules, alerting on anomalies\",\n            dependencies=[1],\n            priority=\"high\",\n            estimated_time=\"2.5h\",\n            files=[\"validation/expectations/\", \"validation/rules.py\", \"validation/quality_checks.py\"]\n        ),\n        Task(\n            id=3,\n            name=\"Data Transformation Layer\",\n            description=\"Build transformation pipeline with Pandas/Polars, implement data cleaning, enrichment, aggregation\",\n            dependencies=[2],\n            priority=\"high\",\n            estimated_time=\"3h\",\n            files=[\"transformers/cleaning.py\", \"transformers/enrichment.py\", \"transformers/aggregation.py\"]\n        ),\n        Task(\n            id=4,\n            name=\"Data Warehouse Loading\",\n            description=\"Implement incremental loading to data warehouse, handle deduplication, maintain idempotency\",\n            dependencies=[3],\n            priority=\"high\",\n            estimated_time=\"2h\",\n            files=[\"loaders/warehouse_loader.py\", \"loaders/incremental.py\"]\n        ),\n        Task(\n            id=5,\n            name=\"Orchestration & Scheduling\",\n            description=\"Setup Airflow/Prefect DAGs, define dependencies, configure retries and SLAs\",\n            dependencies=[4],\n            priority=\"medium\",\n            estimated_time=\"2h\",\n            files=[\"dags/main_pipeline.py\", \"dags/monitoring.py\"]\n        ),\n        Task(\n            id=6,\n            name=\"Monitoring & Alerting\",\n            description=\"Data quality metrics, pipeline performance monitoring, alerting on failures or anomalies\",\n            dependencies=[5],\n            priority=\"high\",\n            estimated_time=\"1.5h\",\n            files=[\"monitoring/metrics.py\", \"monitoring/alerts.py\"]\n        ),\n    ]",
          "metadata": {
            "complexity": "high",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "quality": "production",
            "tags": "planning,etl,data_engineering,pipeline,airflow",
            "code_length": 2460,
            "language": "python",
            "task_type": "project_planning",
            "approved": true,
            "pattern": "task_decomposition",
            "project_type": "data_pipeline",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 5,
          "relevance_score": 0.86257463,
          "mmr_score": null
        }
      ]
    },
    {
      "query": "how to decompose a REST API project with authentication into tasks",
      "category": "planning",
      "found": 5,
      "expected": 2,
      "avg_similarity": 0.8125745819999999,
      "passed": true,
      "examples": [
        {
          "id": "f7cd7a35-a101-4562-abc7-d2ede1adad3a",
          "code": "from typing import Optional\nfrom fastapi import FastAPI, status\nfrom pydantic import BaseModel\n\nclass Item(BaseModel):\n    name: str\n    description: Optional[str] = None\n    price: float\n    tax: float = 10.5\n    tags: list[str] = []\n\napp = FastAPI()\n\n@app.post(\"/items/\", response_model=Item, status_code=status.HTTP_201_CREATED)\nasync def create_item(item: Item):\n    item_dict = item.dict()\n    if item.tax:\n        price_with_tax = item.price + item.tax\n        item_dict.update({\"price_with_tax\": price_with_tax})\n    return item_dict\n\n@app.get(\"/items/\", response_model=list[Item])\nasync def read_items():\n    return [\n        {\"name\": \"Foo\", \"price\": 50},\n        {\"name\": \"Bar\", \"description\": \"The bartenders\", \"price\": 62, \"tax\": 20.2},\n        {\"name\": \"Baz\", \"price\": 50.2, \"tax\": 10.5, \"tags\": [\"tag1\"]},\n    ]",
          "metadata": {
            "docs_section": "Advanced - Response Model",
            "language": "python",
            "pattern": "fastapi_response_model",
            "complexity": "medium",
            "source": "official_docs",
            "framework": "fastapi",
            "tags": "fastapi,response-model,status,http",
            "code_length": 824,
            "approved": true,
            "quality": "official_example",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "task_type": "api_development",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 1,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "a7f7bd26-f761-4863-ba1a-02271291508f",
          "code": "from sqlalchemy.ext.hybrid import hybrid_property\nfrom sqlalchemy.orm import Mapped, mapped_column\n\nclass Product(Base):\n    __tablename__ = \"products\"\n    id: Mapped[int] = mapped_column(primary_key=True)\n    name: Mapped[str]\n    _price: Mapped[float] = mapped_column(\"price\")\n    tax_rate: Mapped[float] = mapped_column(default=0.10)\n    \n    @hybrid_property\n    def price_with_tax(self) -> float:\n        return self._price * (1 + self.tax_rate)\n    \n    @price_with_tax.expression\n    def price_with_tax(cls):\n        return cls._price * (1 + cls.tax_rate)\n\nasync def get_expensive_products(session):\n    stmt = select(Product).where(Product.price_with_tax > 100)\n    return await session.execute(stmt)",
          "metadata": {
            "tags": "sqlalchemy,hybrid_property,computed,expressions",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "approved": true,
            "task_type": "database_patterns",
            "code_length": 708,
            "complexity": "high",
            "quality": "production",
            "language": "python",
            "pattern": "sqlalchemy_hybrid_property",
            "framework": "sqlalchemy",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257457,
          "rank": 2,
          "relevance_score": 0.8825745700000001,
          "mmr_score": null
        },
        {
          "id": "803efb55-2e90-4ffa-942c-1df8a3b92603",
          "code": "from circuitbreaker import circuit\nimport httpx\n\nclass ResilientClient:\n    @circuit(failure_threshold=5, recovery_timeout=60)\n    async def call_service(self, url: str) -> dict:\n        async with httpx.AsyncClient() as client:\n            response = await client.get(url)\n            response.raise_for_status()\n            return response.json()\n\n# Usage\nclient = ResilientClient()\ntry:\n    data = await client.call_service(\"http://api-service/endpoint\")\nexcept Exception as e:\n    # Handle circuit breaker open\n    pass",
          "metadata": {
            "pattern": "circuit_breaker",
            "language": "python",
            "tags": "microservices,circuit-breaker,resilience",
            "framework": "circuitbreaker",
            "task_type": "service_communication",
            "complexity": "high",
            "code_length": 523,
            "indexed_at": "2025-11-03T12:59:49.615879",
            "approved": true,
            "quality": "production",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257457,
          "rank": 3,
          "relevance_score": 0.8825745700000001,
          "mmr_score": null
        },
        {
          "id": "711b0da2-ab81-4e4a-85f3-efa7c2c2f712",
          "code": "# Multi-stage Dockerfile\nFROM python:3.12-slim as builder\nWORKDIR /app\nRUN python -m venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nCOPY requirements.txt .\nRUN pip install --no-cache-dir -r requirements.txt\n\nFROM python:3.12-slim\nWORKDIR /app\nCOPY --from=builder /opt/venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nRUN useradd -m appuser\nCOPY . .\nUSER appuser\nHEALTHCHECK CMD curl -f http://localhost:8000/health\nEXPOSE 8000\nCMD [\"uvicorn\", \"main:app\", \"--host\", \"0.0.0.0\"]",
          "metadata": {
            "quality": "production",
            "language": "dockerfile",
            "pattern": "docker_multistage",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "tags": "docker,multistage,optimization",
            "code_length": 471,
            "framework": "docker",
            "complexity": "medium",
            "approved": true,
            "task_type": "deployment",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257457,
          "rank": 4,
          "relevance_score": 0.8825745700000001,
          "mmr_score": null
        },
        {
          "id": "47a04ff3-af4b-4388-97ef-4b6779c36b19",
          "code": "from fastapi import FastAPI, BackgroundTasks\n\napp = FastAPI()\n\ndef write_log(message: str):\n    with open(\"log.txt\", \"a\") as f:\n        f.write(message + \"\n\")\n\n@app.post(\"/notify\")\nasync def send_notification(bg: BackgroundTasks, email: str):\n    bg.add_task(write_log, f\"Notify: {email}\")\n    return {\"status\": \"scheduled\"}",
          "metadata": {
            "complexity": "low",
            "task_type": "background_jobs",
            "tags": "fastapi,background,io",
            "approved": true,
            "framework": "fastapi",
            "language": "python",
            "source": "official_docs",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "docs_section": "Background Tasks",
            "code_length": 324,
            "quality": "official_example",
            "pattern": "fastapi_background_tasks",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257457,
          "rank": 5,
          "relevance_score": 0.8825745700000001,
          "mmr_score": null
        }
      ]
    },
    {
      "query": "microservices architecture task breakdown with event-driven communication",
      "category": "planning",
      "found": 5,
      "expected": 2,
      "avg_similarity": 0.8125746399999999,
      "passed": true,
      "examples": [
        {
          "id": "f7cd7a35-a101-4562-abc7-d2ede1adad3a",
          "code": "from typing import Optional\nfrom fastapi import FastAPI, status\nfrom pydantic import BaseModel\n\nclass Item(BaseModel):\n    name: str\n    description: Optional[str] = None\n    price: float\n    tax: float = 10.5\n    tags: list[str] = []\n\napp = FastAPI()\n\n@app.post(\"/items/\", response_model=Item, status_code=status.HTTP_201_CREATED)\nasync def create_item(item: Item):\n    item_dict = item.dict()\n    if item.tax:\n        price_with_tax = item.price + item.tax\n        item_dict.update({\"price_with_tax\": price_with_tax})\n    return item_dict\n\n@app.get(\"/items/\", response_model=list[Item])\nasync def read_items():\n    return [\n        {\"name\": \"Foo\", \"price\": 50},\n        {\"name\": \"Bar\", \"description\": \"The bartenders\", \"price\": 62, \"tax\": 20.2},\n        {\"name\": \"Baz\", \"price\": 50.2, \"tax\": 10.5, \"tags\": [\"tag1\"]},\n    ]",
          "metadata": {
            "indexed_at": "2025-11-03T12:59:49.615879",
            "source": "official_docs",
            "tags": "fastapi,response-model,status,http",
            "pattern": "fastapi_response_model",
            "code_length": 824,
            "complexity": "medium",
            "docs_section": "Advanced - Response Model",
            "task_type": "api_development",
            "language": "python",
            "quality": "official_example",
            "framework": "fastapi",
            "approved": true,
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257468,
          "rank": 1,
          "relevance_score": 0.8825746800000001,
          "mmr_score": null
        },
        {
          "id": "a7f7bd26-f761-4863-ba1a-02271291508f",
          "code": "from sqlalchemy.ext.hybrid import hybrid_property\nfrom sqlalchemy.orm import Mapped, mapped_column\n\nclass Product(Base):\n    __tablename__ = \"products\"\n    id: Mapped[int] = mapped_column(primary_key=True)\n    name: Mapped[str]\n    _price: Mapped[float] = mapped_column(\"price\")\n    tax_rate: Mapped[float] = mapped_column(default=0.10)\n    \n    @hybrid_property\n    def price_with_tax(self) -> float:\n        return self._price * (1 + self.tax_rate)\n    \n    @price_with_tax.expression\n    def price_with_tax(cls):\n        return cls._price * (1 + cls.tax_rate)\n\nasync def get_expensive_products(session):\n    stmt = select(Product).where(Product.price_with_tax > 100)\n    return await session.execute(stmt)",
          "metadata": {
            "complexity": "high",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "approved": true,
            "pattern": "sqlalchemy_hybrid_property",
            "language": "python",
            "framework": "sqlalchemy",
            "tags": "sqlalchemy,hybrid_property,computed,expressions",
            "task_type": "database_patterns",
            "code_length": 708,
            "quality": "production",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 2,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "711b0da2-ab81-4e4a-85f3-efa7c2c2f712",
          "code": "# Multi-stage Dockerfile\nFROM python:3.12-slim as builder\nWORKDIR /app\nRUN python -m venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nCOPY requirements.txt .\nRUN pip install --no-cache-dir -r requirements.txt\n\nFROM python:3.12-slim\nWORKDIR /app\nCOPY --from=builder /opt/venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nRUN useradd -m appuser\nCOPY . .\nUSER appuser\nHEALTHCHECK CMD curl -f http://localhost:8000/health\nEXPOSE 8000\nCMD [\"uvicorn\", \"main:app\", \"--host\", \"0.0.0.0\"]",
          "metadata": {
            "quality": "production",
            "pattern": "docker_multistage",
            "approved": true,
            "framework": "docker",
            "language": "dockerfile",
            "task_type": "deployment",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "complexity": "medium",
            "code_length": 471,
            "tags": "docker,multistage,optimization",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 3,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "47a04ff3-af4b-4388-97ef-4b6779c36b19",
          "code": "from fastapi import FastAPI, BackgroundTasks\n\napp = FastAPI()\n\ndef write_log(message: str):\n    with open(\"log.txt\", \"a\") as f:\n        f.write(message + \"\n\")\n\n@app.post(\"/notify\")\nasync def send_notification(bg: BackgroundTasks, email: str):\n    bg.add_task(write_log, f\"Notify: {email}\")\n    return {\"status\": \"scheduled\"}",
          "metadata": {
            "quality": "official_example",
            "complexity": "low",
            "pattern": "fastapi_background_tasks",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "source": "official_docs",
            "docs_section": "Background Tasks",
            "code_length": 324,
            "language": "python",
            "tags": "fastapi,background,io",
            "task_type": "background_jobs",
            "framework": "fastapi",
            "approved": true,
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 4,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "f909508d-1bb3-4a88-9807-1ee5059d9798",
          "code": "def decompose_data_pipeline_tasks(requirements: str) -> List[Task]:\n    '''Decompose data pipeline/ETL system into tasks.'''\n    return [\n        Task(\n            id=1,\n            name=\"Data Source Integration\",\n            description=\"Connect to data sources (APIs, databases, S3), implement connectors with retry logic\",\n            dependencies=[],\n            priority=\"high\",\n            estimated_time=\"2h\",\n            files=[\"connectors/api_connector.py\", \"connectors/db_connector.py\", \"connectors/s3_connector.py\"]\n        ),\n        Task(\n            id=2,\n            name=\"Data Validation & Quality Checks\",\n            description=\"Implement Great Expectations for data validation, define quality rules, alerting on anomalies\",\n            dependencies=[1],\n            priority=\"high\",\n            estimated_time=\"2.5h\",\n            files=[\"validation/expectations/\", \"validation/rules.py\", \"validation/quality_checks.py\"]\n        ),\n        Task(\n            id=3,\n            name=\"Data Transformation Layer\",\n            description=\"Build transformation pipeline with Pandas/Polars, implement data cleaning, enrichment, aggregation\",\n            dependencies=[2],\n            priority=\"high\",\n            estimated_time=\"3h\",\n            files=[\"transformers/cleaning.py\", \"transformers/enrichment.py\", \"transformers/aggregation.py\"]\n        ),\n        Task(\n            id=4,\n            name=\"Data Warehouse Loading\",\n            description=\"Implement incremental loading to data warehouse, handle deduplication, maintain idempotency\",\n            dependencies=[3],\n            priority=\"high\",\n            estimated_time=\"2h\",\n            files=[\"loaders/warehouse_loader.py\", \"loaders/incremental.py\"]\n        ),\n        Task(\n            id=5,\n            name=\"Orchestration & Scheduling\",\n            description=\"Setup Airflow/Prefect DAGs, define dependencies, configure retries and SLAs\",\n            dependencies=[4],\n            priority=\"medium\",\n            estimated_time=\"2h\",\n            files=[\"dags/main_pipeline.py\", \"dags/monitoring.py\"]\n        ),\n        Task(\n            id=6,\n            name=\"Monitoring & Alerting\",\n            description=\"Data quality metrics, pipeline performance monitoring, alerting on failures or anomalies\",\n            dependencies=[5],\n            priority=\"high\",\n            estimated_time=\"1.5h\",\n            files=[\"monitoring/metrics.py\", \"monitoring/alerts.py\"]\n        ),\n    ]",
          "metadata": {
            "language": "python",
            "task_type": "project_planning",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "complexity": "high",
            "project_type": "data_pipeline",
            "pattern": "task_decomposition",
            "tags": "planning,etl,data_engineering,pipeline,airflow",
            "code_length": 2460,
            "quality": "production",
            "approved": true,
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 5,
          "relevance_score": 0.86257463,
          "mmr_score": null
        }
      ]
    },
    {
      "query": "data pipeline ETL project task decomposition",
      "category": "planning",
      "found": 5,
      "expected": 1,
      "avg_similarity": 0.8125746399999999,
      "passed": true,
      "examples": [
        {
          "id": "f7cd7a35-a101-4562-abc7-d2ede1adad3a",
          "code": "from typing import Optional\nfrom fastapi import FastAPI, status\nfrom pydantic import BaseModel\n\nclass Item(BaseModel):\n    name: str\n    description: Optional[str] = None\n    price: float\n    tax: float = 10.5\n    tags: list[str] = []\n\napp = FastAPI()\n\n@app.post(\"/items/\", response_model=Item, status_code=status.HTTP_201_CREATED)\nasync def create_item(item: Item):\n    item_dict = item.dict()\n    if item.tax:\n        price_with_tax = item.price + item.tax\n        item_dict.update({\"price_with_tax\": price_with_tax})\n    return item_dict\n\n@app.get(\"/items/\", response_model=list[Item])\nasync def read_items():\n    return [\n        {\"name\": \"Foo\", \"price\": 50},\n        {\"name\": \"Bar\", \"description\": \"The bartenders\", \"price\": 62, \"tax\": 20.2},\n        {\"name\": \"Baz\", \"price\": 50.2, \"tax\": 10.5, \"tags\": [\"tag1\"]},\n    ]",
          "metadata": {
            "tags": "fastapi,response-model,status,http",
            "code_length": 824,
            "approved": true,
            "complexity": "medium",
            "source": "official_docs",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "quality": "official_example",
            "language": "python",
            "docs_section": "Advanced - Response Model",
            "task_type": "api_development",
            "framework": "fastapi",
            "pattern": "fastapi_response_model",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257468,
          "rank": 1,
          "relevance_score": 0.8825746800000001,
          "mmr_score": null
        },
        {
          "id": "a7f7bd26-f761-4863-ba1a-02271291508f",
          "code": "from sqlalchemy.ext.hybrid import hybrid_property\nfrom sqlalchemy.orm import Mapped, mapped_column\n\nclass Product(Base):\n    __tablename__ = \"products\"\n    id: Mapped[int] = mapped_column(primary_key=True)\n    name: Mapped[str]\n    _price: Mapped[float] = mapped_column(\"price\")\n    tax_rate: Mapped[float] = mapped_column(default=0.10)\n    \n    @hybrid_property\n    def price_with_tax(self) -> float:\n        return self._price * (1 + self.tax_rate)\n    \n    @price_with_tax.expression\n    def price_with_tax(cls):\n        return cls._price * (1 + cls.tax_rate)\n\nasync def get_expensive_products(session):\n    stmt = select(Product).where(Product.price_with_tax > 100)\n    return await session.execute(stmt)",
          "metadata": {
            "framework": "sqlalchemy",
            "language": "python",
            "pattern": "sqlalchemy_hybrid_property",
            "approved": true,
            "task_type": "database_patterns",
            "complexity": "high",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "quality": "production",
            "tags": "sqlalchemy,hybrid_property,computed,expressions",
            "code_length": 708,
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 2,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "711b0da2-ab81-4e4a-85f3-efa7c2c2f712",
          "code": "# Multi-stage Dockerfile\nFROM python:3.12-slim as builder\nWORKDIR /app\nRUN python -m venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nCOPY requirements.txt .\nRUN pip install --no-cache-dir -r requirements.txt\n\nFROM python:3.12-slim\nWORKDIR /app\nCOPY --from=builder /opt/venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nRUN useradd -m appuser\nCOPY . .\nUSER appuser\nHEALTHCHECK CMD curl -f http://localhost:8000/health\nEXPOSE 8000\nCMD [\"uvicorn\", \"main:app\", \"--host\", \"0.0.0.0\"]",
          "metadata": {
            "quality": "production",
            "tags": "docker,multistage,optimization",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "pattern": "docker_multistage",
            "framework": "docker",
            "approved": true,
            "language": "dockerfile",
            "task_type": "deployment",
            "complexity": "medium",
            "code_length": 471,
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 3,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "47a04ff3-af4b-4388-97ef-4b6779c36b19",
          "code": "from fastapi import FastAPI, BackgroundTasks\n\napp = FastAPI()\n\ndef write_log(message: str):\n    with open(\"log.txt\", \"a\") as f:\n        f.write(message + \"\n\")\n\n@app.post(\"/notify\")\nasync def send_notification(bg: BackgroundTasks, email: str):\n    bg.add_task(write_log, f\"Notify: {email}\")\n    return {\"status\": \"scheduled\"}",
          "metadata": {
            "source": "official_docs",
            "quality": "official_example",
            "language": "python",
            "docs_section": "Background Tasks",
            "pattern": "fastapi_background_tasks",
            "approved": true,
            "complexity": "low",
            "task_type": "background_jobs",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "framework": "fastapi",
            "tags": "fastapi,background,io",
            "code_length": 324,
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 4,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "f909508d-1bb3-4a88-9807-1ee5059d9798",
          "code": "def decompose_data_pipeline_tasks(requirements: str) -> List[Task]:\n    '''Decompose data pipeline/ETL system into tasks.'''\n    return [\n        Task(\n            id=1,\n            name=\"Data Source Integration\",\n            description=\"Connect to data sources (APIs, databases, S3), implement connectors with retry logic\",\n            dependencies=[],\n            priority=\"high\",\n            estimated_time=\"2h\",\n            files=[\"connectors/api_connector.py\", \"connectors/db_connector.py\", \"connectors/s3_connector.py\"]\n        ),\n        Task(\n            id=2,\n            name=\"Data Validation & Quality Checks\",\n            description=\"Implement Great Expectations for data validation, define quality rules, alerting on anomalies\",\n            dependencies=[1],\n            priority=\"high\",\n            estimated_time=\"2.5h\",\n            files=[\"validation/expectations/\", \"validation/rules.py\", \"validation/quality_checks.py\"]\n        ),\n        Task(\n            id=3,\n            name=\"Data Transformation Layer\",\n            description=\"Build transformation pipeline with Pandas/Polars, implement data cleaning, enrichment, aggregation\",\n            dependencies=[2],\n            priority=\"high\",\n            estimated_time=\"3h\",\n            files=[\"transformers/cleaning.py\", \"transformers/enrichment.py\", \"transformers/aggregation.py\"]\n        ),\n        Task(\n            id=4,\n            name=\"Data Warehouse Loading\",\n            description=\"Implement incremental loading to data warehouse, handle deduplication, maintain idempotency\",\n            dependencies=[3],\n            priority=\"high\",\n            estimated_time=\"2h\",\n            files=[\"loaders/warehouse_loader.py\", \"loaders/incremental.py\"]\n        ),\n        Task(\n            id=5,\n            name=\"Orchestration & Scheduling\",\n            description=\"Setup Airflow/Prefect DAGs, define dependencies, configure retries and SLAs\",\n            dependencies=[4],\n            priority=\"medium\",\n            estimated_time=\"2h\",\n            files=[\"dags/main_pipeline.py\", \"dags/monitoring.py\"]\n        ),\n        Task(\n            id=6,\n            name=\"Monitoring & Alerting\",\n            description=\"Data quality metrics, pipeline performance monitoring, alerting on failures or anomalies\",\n            dependencies=[5],\n            priority=\"high\",\n            estimated_time=\"1.5h\",\n            files=[\"monitoring/metrics.py\", \"monitoring/alerts.py\"]\n        ),\n    ]",
          "metadata": {
            "language": "python",
            "project_type": "data_pipeline",
            "code_length": 2460,
            "tags": "planning,etl,data_engineering,pipeline,airflow",
            "task_type": "project_planning",
            "approved": true,
            "pattern": "task_decomposition",
            "quality": "production",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "complexity": "high",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 5,
          "relevance_score": 0.86257463,
          "mmr_score": null
        }
      ]
    },
    {
      "query": "CLI application implementation tasks",
      "category": "planning",
      "found": 5,
      "expected": 1,
      "avg_similarity": 0.8125745819999999,
      "passed": true,
      "examples": [
        {
          "id": "f7cd7a35-a101-4562-abc7-d2ede1adad3a",
          "code": "from typing import Optional\nfrom fastapi import FastAPI, status\nfrom pydantic import BaseModel\n\nclass Item(BaseModel):\n    name: str\n    description: Optional[str] = None\n    price: float\n    tax: float = 10.5\n    tags: list[str] = []\n\napp = FastAPI()\n\n@app.post(\"/items/\", response_model=Item, status_code=status.HTTP_201_CREATED)\nasync def create_item(item: Item):\n    item_dict = item.dict()\n    if item.tax:\n        price_with_tax = item.price + item.tax\n        item_dict.update({\"price_with_tax\": price_with_tax})\n    return item_dict\n\n@app.get(\"/items/\", response_model=list[Item])\nasync def read_items():\n    return [\n        {\"name\": \"Foo\", \"price\": 50},\n        {\"name\": \"Bar\", \"description\": \"The bartenders\", \"price\": 62, \"tax\": 20.2},\n        {\"name\": \"Baz\", \"price\": 50.2, \"tax\": 10.5, \"tags\": [\"tag1\"]},\n    ]",
          "metadata": {
            "code_length": 824,
            "language": "python",
            "approved": true,
            "complexity": "medium",
            "task_type": "api_development",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "docs_section": "Advanced - Response Model",
            "quality": "official_example",
            "source": "official_docs",
            "pattern": "fastapi_response_model",
            "framework": "fastapi",
            "tags": "fastapi,response-model,status,http",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 1,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "a7f7bd26-f761-4863-ba1a-02271291508f",
          "code": "from sqlalchemy.ext.hybrid import hybrid_property\nfrom sqlalchemy.orm import Mapped, mapped_column\n\nclass Product(Base):\n    __tablename__ = \"products\"\n    id: Mapped[int] = mapped_column(primary_key=True)\n    name: Mapped[str]\n    _price: Mapped[float] = mapped_column(\"price\")\n    tax_rate: Mapped[float] = mapped_column(default=0.10)\n    \n    @hybrid_property\n    def price_with_tax(self) -> float:\n        return self._price * (1 + self.tax_rate)\n    \n    @price_with_tax.expression\n    def price_with_tax(cls):\n        return cls._price * (1 + cls.tax_rate)\n\nasync def get_expensive_products(session):\n    stmt = select(Product).where(Product.price_with_tax > 100)\n    return await session.execute(stmt)",
          "metadata": {
            "tags": "sqlalchemy,hybrid_property,computed,expressions",
            "pattern": "sqlalchemy_hybrid_property",
            "quality": "production",
            "approved": true,
            "framework": "sqlalchemy",
            "code_length": 708,
            "task_type": "database_patterns",
            "language": "python",
            "complexity": "high",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257457,
          "rank": 2,
          "relevance_score": 0.8825745700000001,
          "mmr_score": null
        },
        {
          "id": "803efb55-2e90-4ffa-942c-1df8a3b92603",
          "code": "from circuitbreaker import circuit\nimport httpx\n\nclass ResilientClient:\n    @circuit(failure_threshold=5, recovery_timeout=60)\n    async def call_service(self, url: str) -> dict:\n        async with httpx.AsyncClient() as client:\n            response = await client.get(url)\n            response.raise_for_status()\n            return response.json()\n\n# Usage\nclient = ResilientClient()\ntry:\n    data = await client.call_service(\"http://api-service/endpoint\")\nexcept Exception as e:\n    # Handle circuit breaker open\n    pass",
          "metadata": {
            "tags": "microservices,circuit-breaker,resilience",
            "quality": "production",
            "framework": "circuitbreaker",
            "code_length": 523,
            "indexed_at": "2025-11-03T12:59:49.615879",
            "complexity": "high",
            "task_type": "service_communication",
            "approved": true,
            "language": "python",
            "pattern": "circuit_breaker",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257457,
          "rank": 3,
          "relevance_score": 0.8825745700000001,
          "mmr_score": null
        },
        {
          "id": "711b0da2-ab81-4e4a-85f3-efa7c2c2f712",
          "code": "# Multi-stage Dockerfile\nFROM python:3.12-slim as builder\nWORKDIR /app\nRUN python -m venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nCOPY requirements.txt .\nRUN pip install --no-cache-dir -r requirements.txt\n\nFROM python:3.12-slim\nWORKDIR /app\nCOPY --from=builder /opt/venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nRUN useradd -m appuser\nCOPY . .\nUSER appuser\nHEALTHCHECK CMD curl -f http://localhost:8000/health\nEXPOSE 8000\nCMD [\"uvicorn\", \"main:app\", \"--host\", \"0.0.0.0\"]",
          "metadata": {
            "framework": "docker",
            "pattern": "docker_multistage",
            "code_length": 471,
            "approved": true,
            "language": "dockerfile",
            "tags": "docker,multistage,optimization",
            "complexity": "medium",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "task_type": "deployment",
            "quality": "production",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257457,
          "rank": 4,
          "relevance_score": 0.8825745700000001,
          "mmr_score": null
        },
        {
          "id": "47a04ff3-af4b-4388-97ef-4b6779c36b19",
          "code": "from fastapi import FastAPI, BackgroundTasks\n\napp = FastAPI()\n\ndef write_log(message: str):\n    with open(\"log.txt\", \"a\") as f:\n        f.write(message + \"\n\")\n\n@app.post(\"/notify\")\nasync def send_notification(bg: BackgroundTasks, email: str):\n    bg.add_task(write_log, f\"Notify: {email}\")\n    return {\"status\": \"scheduled\"}",
          "metadata": {
            "approved": true,
            "framework": "fastapi",
            "complexity": "low",
            "docs_section": "Background Tasks",
            "code_length": 324,
            "task_type": "background_jobs",
            "tags": "fastapi,background,io",
            "language": "python",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "quality": "official_example",
            "pattern": "fastapi_background_tasks",
            "source": "official_docs",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257457,
          "rank": 5,
          "relevance_score": 0.8825745700000001,
          "mmr_score": null
        }
      ]
    },
    {
      "query": "task dependencies and ordering for complex project",
      "category": "planning",
      "found": 5,
      "expected": 1,
      "avg_similarity": 0.8125746399999999,
      "passed": true,
      "examples": [
        {
          "id": "f7cd7a35-a101-4562-abc7-d2ede1adad3a",
          "code": "from typing import Optional\nfrom fastapi import FastAPI, status\nfrom pydantic import BaseModel\n\nclass Item(BaseModel):\n    name: str\n    description: Optional[str] = None\n    price: float\n    tax: float = 10.5\n    tags: list[str] = []\n\napp = FastAPI()\n\n@app.post(\"/items/\", response_model=Item, status_code=status.HTTP_201_CREATED)\nasync def create_item(item: Item):\n    item_dict = item.dict()\n    if item.tax:\n        price_with_tax = item.price + item.tax\n        item_dict.update({\"price_with_tax\": price_with_tax})\n    return item_dict\n\n@app.get(\"/items/\", response_model=list[Item])\nasync def read_items():\n    return [\n        {\"name\": \"Foo\", \"price\": 50},\n        {\"name\": \"Bar\", \"description\": \"The bartenders\", \"price\": 62, \"tax\": 20.2},\n        {\"name\": \"Baz\", \"price\": 50.2, \"tax\": 10.5, \"tags\": [\"tag1\"]},\n    ]",
          "metadata": {
            "language": "python",
            "tags": "fastapi,response-model,status,http",
            "complexity": "medium",
            "quality": "official_example",
            "source": "official_docs",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "framework": "fastapi",
            "code_length": 824,
            "approved": true,
            "pattern": "fastapi_response_model",
            "task_type": "api_development",
            "docs_section": "Advanced - Response Model",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257468,
          "rank": 1,
          "relevance_score": 0.8825746800000001,
          "mmr_score": null
        },
        {
          "id": "a7f7bd26-f761-4863-ba1a-02271291508f",
          "code": "from sqlalchemy.ext.hybrid import hybrid_property\nfrom sqlalchemy.orm import Mapped, mapped_column\n\nclass Product(Base):\n    __tablename__ = \"products\"\n    id: Mapped[int] = mapped_column(primary_key=True)\n    name: Mapped[str]\n    _price: Mapped[float] = mapped_column(\"price\")\n    tax_rate: Mapped[float] = mapped_column(default=0.10)\n    \n    @hybrid_property\n    def price_with_tax(self) -> float:\n        return self._price * (1 + self.tax_rate)\n    \n    @price_with_tax.expression\n    def price_with_tax(cls):\n        return cls._price * (1 + cls.tax_rate)\n\nasync def get_expensive_products(session):\n    stmt = select(Product).where(Product.price_with_tax > 100)\n    return await session.execute(stmt)",
          "metadata": {
            "complexity": "high",
            "approved": true,
            "pattern": "sqlalchemy_hybrid_property",
            "quality": "production",
            "framework": "sqlalchemy",
            "task_type": "database_patterns",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "code_length": 708,
            "language": "python",
            "tags": "sqlalchemy,hybrid_property,computed,expressions",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 2,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "711b0da2-ab81-4e4a-85f3-efa7c2c2f712",
          "code": "# Multi-stage Dockerfile\nFROM python:3.12-slim as builder\nWORKDIR /app\nRUN python -m venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nCOPY requirements.txt .\nRUN pip install --no-cache-dir -r requirements.txt\n\nFROM python:3.12-slim\nWORKDIR /app\nCOPY --from=builder /opt/venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nRUN useradd -m appuser\nCOPY . .\nUSER appuser\nHEALTHCHECK CMD curl -f http://localhost:8000/health\nEXPOSE 8000\nCMD [\"uvicorn\", \"main:app\", \"--host\", \"0.0.0.0\"]",
          "metadata": {
            "tags": "docker,multistage,optimization",
            "pattern": "docker_multistage",
            "framework": "docker",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "task_type": "deployment",
            "approved": true,
            "language": "dockerfile",
            "code_length": 471,
            "quality": "production",
            "complexity": "medium",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 3,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "47a04ff3-af4b-4388-97ef-4b6779c36b19",
          "code": "from fastapi import FastAPI, BackgroundTasks\n\napp = FastAPI()\n\ndef write_log(message: str):\n    with open(\"log.txt\", \"a\") as f:\n        f.write(message + \"\n\")\n\n@app.post(\"/notify\")\nasync def send_notification(bg: BackgroundTasks, email: str):\n    bg.add_task(write_log, f\"Notify: {email}\")\n    return {\"status\": \"scheduled\"}",
          "metadata": {
            "approved": true,
            "language": "python",
            "complexity": "low",
            "code_length": 324,
            "docs_section": "Background Tasks",
            "pattern": "fastapi_background_tasks",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "source": "official_docs",
            "tags": "fastapi,background,io",
            "quality": "official_example",
            "task_type": "background_jobs",
            "framework": "fastapi",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 4,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "f909508d-1bb3-4a88-9807-1ee5059d9798",
          "code": "def decompose_data_pipeline_tasks(requirements: str) -> List[Task]:\n    '''Decompose data pipeline/ETL system into tasks.'''\n    return [\n        Task(\n            id=1,\n            name=\"Data Source Integration\",\n            description=\"Connect to data sources (APIs, databases, S3), implement connectors with retry logic\",\n            dependencies=[],\n            priority=\"high\",\n            estimated_time=\"2h\",\n            files=[\"connectors/api_connector.py\", \"connectors/db_connector.py\", \"connectors/s3_connector.py\"]\n        ),\n        Task(\n            id=2,\n            name=\"Data Validation & Quality Checks\",\n            description=\"Implement Great Expectations for data validation, define quality rules, alerting on anomalies\",\n            dependencies=[1],\n            priority=\"high\",\n            estimated_time=\"2.5h\",\n            files=[\"validation/expectations/\", \"validation/rules.py\", \"validation/quality_checks.py\"]\n        ),\n        Task(\n            id=3,\n            name=\"Data Transformation Layer\",\n            description=\"Build transformation pipeline with Pandas/Polars, implement data cleaning, enrichment, aggregation\",\n            dependencies=[2],\n            priority=\"high\",\n            estimated_time=\"3h\",\n            files=[\"transformers/cleaning.py\", \"transformers/enrichment.py\", \"transformers/aggregation.py\"]\n        ),\n        Task(\n            id=4,\n            name=\"Data Warehouse Loading\",\n            description=\"Implement incremental loading to data warehouse, handle deduplication, maintain idempotency\",\n            dependencies=[3],\n            priority=\"high\",\n            estimated_time=\"2h\",\n            files=[\"loaders/warehouse_loader.py\", \"loaders/incremental.py\"]\n        ),\n        Task(\n            id=5,\n            name=\"Orchestration & Scheduling\",\n            description=\"Setup Airflow/Prefect DAGs, define dependencies, configure retries and SLAs\",\n            dependencies=[4],\n            priority=\"medium\",\n            estimated_time=\"2h\",\n            files=[\"dags/main_pipeline.py\", \"dags/monitoring.py\"]\n        ),\n        Task(\n            id=6,\n            name=\"Monitoring & Alerting\",\n            description=\"Data quality metrics, pipeline performance monitoring, alerting on failures or anomalies\",\n            dependencies=[5],\n            priority=\"high\",\n            estimated_time=\"1.5h\",\n            files=[\"monitoring/metrics.py\", \"monitoring/alerts.py\"]\n        ),\n    ]",
          "metadata": {
            "code_length": 2460,
            "quality": "production",
            "complexity": "high",
            "approved": true,
            "pattern": "task_decomposition",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "tags": "planning,etl,data_engineering,pipeline,airflow",
            "project_type": "data_pipeline",
            "language": "python",
            "task_type": "project_planning",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 5,
          "relevance_score": 0.86257463,
          "mmr_score": null
        }
      ]
    },
    {
      "query": "JWT authentication with token refresh and revocation",
      "category": "security",
      "found": 5,
      "expected": 2,
      "avg_similarity": 0.8125746399999999,
      "passed": true,
      "examples": [
        {
          "id": "f7cd7a35-a101-4562-abc7-d2ede1adad3a",
          "code": "from typing import Optional\nfrom fastapi import FastAPI, status\nfrom pydantic import BaseModel\n\nclass Item(BaseModel):\n    name: str\n    description: Optional[str] = None\n    price: float\n    tax: float = 10.5\n    tags: list[str] = []\n\napp = FastAPI()\n\n@app.post(\"/items/\", response_model=Item, status_code=status.HTTP_201_CREATED)\nasync def create_item(item: Item):\n    item_dict = item.dict()\n    if item.tax:\n        price_with_tax = item.price + item.tax\n        item_dict.update({\"price_with_tax\": price_with_tax})\n    return item_dict\n\n@app.get(\"/items/\", response_model=list[Item])\nasync def read_items():\n    return [\n        {\"name\": \"Foo\", \"price\": 50},\n        {\"name\": \"Bar\", \"description\": \"The bartenders\", \"price\": 62, \"tax\": 20.2},\n        {\"name\": \"Baz\", \"price\": 50.2, \"tax\": 10.5, \"tags\": [\"tag1\"]},\n    ]",
          "metadata": {
            "framework": "fastapi",
            "source": "official_docs",
            "task_type": "api_development",
            "language": "python",
            "complexity": "medium",
            "approved": true,
            "quality": "official_example",
            "tags": "fastapi,response-model,status,http",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "code_length": 824,
            "pattern": "fastapi_response_model",
            "docs_section": "Advanced - Response Model",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257468,
          "rank": 1,
          "relevance_score": 0.8825746800000001,
          "mmr_score": null
        },
        {
          "id": "803efb55-2e90-4ffa-942c-1df8a3b92603",
          "code": "from circuitbreaker import circuit\nimport httpx\n\nclass ResilientClient:\n    @circuit(failure_threshold=5, recovery_timeout=60)\n    async def call_service(self, url: str) -> dict:\n        async with httpx.AsyncClient() as client:\n            response = await client.get(url)\n            response.raise_for_status()\n            return response.json()\n\n# Usage\nclient = ResilientClient()\ntry:\n    data = await client.call_service(\"http://api-service/endpoint\")\nexcept Exception as e:\n    # Handle circuit breaker open\n    pass",
          "metadata": {
            "language": "python",
            "complexity": "high",
            "tags": "microservices,circuit-breaker,resilience",
            "pattern": "circuit_breaker",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "task_type": "service_communication",
            "quality": "production",
            "framework": "circuitbreaker",
            "approved": true,
            "code_length": 523,
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 2,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "711b0da2-ab81-4e4a-85f3-efa7c2c2f712",
          "code": "# Multi-stage Dockerfile\nFROM python:3.12-slim as builder\nWORKDIR /app\nRUN python -m venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nCOPY requirements.txt .\nRUN pip install --no-cache-dir -r requirements.txt\n\nFROM python:3.12-slim\nWORKDIR /app\nCOPY --from=builder /opt/venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nRUN useradd -m appuser\nCOPY . .\nUSER appuser\nHEALTHCHECK CMD curl -f http://localhost:8000/health\nEXPOSE 8000\nCMD [\"uvicorn\", \"main:app\", \"--host\", \"0.0.0.0\"]",
          "metadata": {
            "pattern": "docker_multistage",
            "quality": "production",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "complexity": "medium",
            "language": "dockerfile",
            "task_type": "deployment",
            "code_length": 471,
            "framework": "docker",
            "tags": "docker,multistage,optimization",
            "approved": true,
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 3,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "47a04ff3-af4b-4388-97ef-4b6779c36b19",
          "code": "from fastapi import FastAPI, BackgroundTasks\n\napp = FastAPI()\n\ndef write_log(message: str):\n    with open(\"log.txt\", \"a\") as f:\n        f.write(message + \"\n\")\n\n@app.post(\"/notify\")\nasync def send_notification(bg: BackgroundTasks, email: str):\n    bg.add_task(write_log, f\"Notify: {email}\")\n    return {\"status\": \"scheduled\"}",
          "metadata": {
            "indexed_at": "2025-11-03T12:59:49.615879",
            "task_type": "background_jobs",
            "complexity": "low",
            "framework": "fastapi",
            "approved": true,
            "code_length": 324,
            "source": "official_docs",
            "docs_section": "Background Tasks",
            "tags": "fastapi,background,io",
            "language": "python",
            "pattern": "fastapi_background_tasks",
            "quality": "official_example",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 4,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "f909508d-1bb3-4a88-9807-1ee5059d9798",
          "code": "def decompose_data_pipeline_tasks(requirements: str) -> List[Task]:\n    '''Decompose data pipeline/ETL system into tasks.'''\n    return [\n        Task(\n            id=1,\n            name=\"Data Source Integration\",\n            description=\"Connect to data sources (APIs, databases, S3), implement connectors with retry logic\",\n            dependencies=[],\n            priority=\"high\",\n            estimated_time=\"2h\",\n            files=[\"connectors/api_connector.py\", \"connectors/db_connector.py\", \"connectors/s3_connector.py\"]\n        ),\n        Task(\n            id=2,\n            name=\"Data Validation & Quality Checks\",\n            description=\"Implement Great Expectations for data validation, define quality rules, alerting on anomalies\",\n            dependencies=[1],\n            priority=\"high\",\n            estimated_time=\"2.5h\",\n            files=[\"validation/expectations/\", \"validation/rules.py\", \"validation/quality_checks.py\"]\n        ),\n        Task(\n            id=3,\n            name=\"Data Transformation Layer\",\n            description=\"Build transformation pipeline with Pandas/Polars, implement data cleaning, enrichment, aggregation\",\n            dependencies=[2],\n            priority=\"high\",\n            estimated_time=\"3h\",\n            files=[\"transformers/cleaning.py\", \"transformers/enrichment.py\", \"transformers/aggregation.py\"]\n        ),\n        Task(\n            id=4,\n            name=\"Data Warehouse Loading\",\n            description=\"Implement incremental loading to data warehouse, handle deduplication, maintain idempotency\",\n            dependencies=[3],\n            priority=\"high\",\n            estimated_time=\"2h\",\n            files=[\"loaders/warehouse_loader.py\", \"loaders/incremental.py\"]\n        ),\n        Task(\n            id=5,\n            name=\"Orchestration & Scheduling\",\n            description=\"Setup Airflow/Prefect DAGs, define dependencies, configure retries and SLAs\",\n            dependencies=[4],\n            priority=\"medium\",\n            estimated_time=\"2h\",\n            files=[\"dags/main_pipeline.py\", \"dags/monitoring.py\"]\n        ),\n        Task(\n            id=6,\n            name=\"Monitoring & Alerting\",\n            description=\"Data quality metrics, pipeline performance monitoring, alerting on failures or anomalies\",\n            dependencies=[5],\n            priority=\"high\",\n            estimated_time=\"1.5h\",\n            files=[\"monitoring/metrics.py\", \"monitoring/alerts.py\"]\n        ),\n    ]",
          "metadata": {
            "project_type": "data_pipeline",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "task_type": "project_planning",
            "quality": "production",
            "pattern": "task_decomposition",
            "code_length": 2460,
            "language": "python",
            "approved": true,
            "tags": "planning,etl,data_engineering,pipeline,airflow",
            "complexity": "high",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 5,
          "relevance_score": 0.86257463,
          "mmr_score": null
        }
      ]
    },
    {
      "query": "password hashing with bcrypt best practices",
      "category": "security",
      "found": 5,
      "expected": 2,
      "avg_similarity": 0.8125746399999999,
      "passed": true,
      "examples": [
        {
          "id": "f7cd7a35-a101-4562-abc7-d2ede1adad3a",
          "code": "from typing import Optional\nfrom fastapi import FastAPI, status\nfrom pydantic import BaseModel\n\nclass Item(BaseModel):\n    name: str\n    description: Optional[str] = None\n    price: float\n    tax: float = 10.5\n    tags: list[str] = []\n\napp = FastAPI()\n\n@app.post(\"/items/\", response_model=Item, status_code=status.HTTP_201_CREATED)\nasync def create_item(item: Item):\n    item_dict = item.dict()\n    if item.tax:\n        price_with_tax = item.price + item.tax\n        item_dict.update({\"price_with_tax\": price_with_tax})\n    return item_dict\n\n@app.get(\"/items/\", response_model=list[Item])\nasync def read_items():\n    return [\n        {\"name\": \"Foo\", \"price\": 50},\n        {\"name\": \"Bar\", \"description\": \"The bartenders\", \"price\": 62, \"tax\": 20.2},\n        {\"name\": \"Baz\", \"price\": 50.2, \"tax\": 10.5, \"tags\": [\"tag1\"]},\n    ]",
          "metadata": {
            "pattern": "fastapi_response_model",
            "quality": "official_example",
            "complexity": "medium",
            "source": "official_docs",
            "docs_section": "Advanced - Response Model",
            "framework": "fastapi",
            "language": "python",
            "approved": true,
            "task_type": "api_development",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "code_length": 824,
            "tags": "fastapi,response-model,status,http",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257468,
          "rank": 1,
          "relevance_score": 0.8825746800000001,
          "mmr_score": null
        },
        {
          "id": "a7f7bd26-f761-4863-ba1a-02271291508f",
          "code": "from sqlalchemy.ext.hybrid import hybrid_property\nfrom sqlalchemy.orm import Mapped, mapped_column\n\nclass Product(Base):\n    __tablename__ = \"products\"\n    id: Mapped[int] = mapped_column(primary_key=True)\n    name: Mapped[str]\n    _price: Mapped[float] = mapped_column(\"price\")\n    tax_rate: Mapped[float] = mapped_column(default=0.10)\n    \n    @hybrid_property\n    def price_with_tax(self) -> float:\n        return self._price * (1 + self.tax_rate)\n    \n    @price_with_tax.expression\n    def price_with_tax(cls):\n        return cls._price * (1 + cls.tax_rate)\n\nasync def get_expensive_products(session):\n    stmt = select(Product).where(Product.price_with_tax > 100)\n    return await session.execute(stmt)",
          "metadata": {
            "indexed_at": "2025-11-03T12:59:49.615879",
            "quality": "production",
            "complexity": "high",
            "approved": true,
            "task_type": "database_patterns",
            "framework": "sqlalchemy",
            "pattern": "sqlalchemy_hybrid_property",
            "code_length": 708,
            "language": "python",
            "tags": "sqlalchemy,hybrid_property,computed,expressions",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 2,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "711b0da2-ab81-4e4a-85f3-efa7c2c2f712",
          "code": "# Multi-stage Dockerfile\nFROM python:3.12-slim as builder\nWORKDIR /app\nRUN python -m venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nCOPY requirements.txt .\nRUN pip install --no-cache-dir -r requirements.txt\n\nFROM python:3.12-slim\nWORKDIR /app\nCOPY --from=builder /opt/venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nRUN useradd -m appuser\nCOPY . .\nUSER appuser\nHEALTHCHECK CMD curl -f http://localhost:8000/health\nEXPOSE 8000\nCMD [\"uvicorn\", \"main:app\", \"--host\", \"0.0.0.0\"]",
          "metadata": {
            "language": "dockerfile",
            "code_length": 471,
            "tags": "docker,multistage,optimization",
            "pattern": "docker_multistage",
            "complexity": "medium",
            "task_type": "deployment",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "approved": true,
            "framework": "docker",
            "quality": "production",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 3,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "47a04ff3-af4b-4388-97ef-4b6779c36b19",
          "code": "from fastapi import FastAPI, BackgroundTasks\n\napp = FastAPI()\n\ndef write_log(message: str):\n    with open(\"log.txt\", \"a\") as f:\n        f.write(message + \"\n\")\n\n@app.post(\"/notify\")\nasync def send_notification(bg: BackgroundTasks, email: str):\n    bg.add_task(write_log, f\"Notify: {email}\")\n    return {\"status\": \"scheduled\"}",
          "metadata": {
            "code_length": 324,
            "complexity": "low",
            "tags": "fastapi,background,io",
            "source": "official_docs",
            "language": "python",
            "framework": "fastapi",
            "approved": true,
            "indexed_at": "2025-11-03T12:59:49.615879",
            "quality": "official_example",
            "task_type": "background_jobs",
            "pattern": "fastapi_background_tasks",
            "docs_section": "Background Tasks",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 4,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "f909508d-1bb3-4a88-9807-1ee5059d9798",
          "code": "def decompose_data_pipeline_tasks(requirements: str) -> List[Task]:\n    '''Decompose data pipeline/ETL system into tasks.'''\n    return [\n        Task(\n            id=1,\n            name=\"Data Source Integration\",\n            description=\"Connect to data sources (APIs, databases, S3), implement connectors with retry logic\",\n            dependencies=[],\n            priority=\"high\",\n            estimated_time=\"2h\",\n            files=[\"connectors/api_connector.py\", \"connectors/db_connector.py\", \"connectors/s3_connector.py\"]\n        ),\n        Task(\n            id=2,\n            name=\"Data Validation & Quality Checks\",\n            description=\"Implement Great Expectations for data validation, define quality rules, alerting on anomalies\",\n            dependencies=[1],\n            priority=\"high\",\n            estimated_time=\"2.5h\",\n            files=[\"validation/expectations/\", \"validation/rules.py\", \"validation/quality_checks.py\"]\n        ),\n        Task(\n            id=3,\n            name=\"Data Transformation Layer\",\n            description=\"Build transformation pipeline with Pandas/Polars, implement data cleaning, enrichment, aggregation\",\n            dependencies=[2],\n            priority=\"high\",\n            estimated_time=\"3h\",\n            files=[\"transformers/cleaning.py\", \"transformers/enrichment.py\", \"transformers/aggregation.py\"]\n        ),\n        Task(\n            id=4,\n            name=\"Data Warehouse Loading\",\n            description=\"Implement incremental loading to data warehouse, handle deduplication, maintain idempotency\",\n            dependencies=[3],\n            priority=\"high\",\n            estimated_time=\"2h\",\n            files=[\"loaders/warehouse_loader.py\", \"loaders/incremental.py\"]\n        ),\n        Task(\n            id=5,\n            name=\"Orchestration & Scheduling\",\n            description=\"Setup Airflow/Prefect DAGs, define dependencies, configure retries and SLAs\",\n            dependencies=[4],\n            priority=\"medium\",\n            estimated_time=\"2h\",\n            files=[\"dags/main_pipeline.py\", \"dags/monitoring.py\"]\n        ),\n        Task(\n            id=6,\n            name=\"Monitoring & Alerting\",\n            description=\"Data quality metrics, pipeline performance monitoring, alerting on failures or anomalies\",\n            dependencies=[5],\n            priority=\"high\",\n            estimated_time=\"1.5h\",\n            files=[\"monitoring/metrics.py\", \"monitoring/alerts.py\"]\n        ),\n    ]",
          "metadata": {
            "code_length": 2460,
            "approved": true,
            "indexed_at": "2025-11-03T12:59:49.615879",
            "language": "python",
            "task_type": "project_planning",
            "tags": "planning,etl,data_engineering,pipeline,airflow",
            "pattern": "task_decomposition",
            "quality": "production",
            "complexity": "high",
            "project_type": "data_pipeline",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 5,
          "relevance_score": 0.86257463,
          "mmr_score": null
        }
      ]
    },
    {
      "query": "role-based access control RBAC implementation",
      "category": "security",
      "found": 5,
      "expected": 2,
      "avg_similarity": 0.8125746399999999,
      "passed": true,
      "examples": [
        {
          "id": "f7cd7a35-a101-4562-abc7-d2ede1adad3a",
          "code": "from typing import Optional\nfrom fastapi import FastAPI, status\nfrom pydantic import BaseModel\n\nclass Item(BaseModel):\n    name: str\n    description: Optional[str] = None\n    price: float\n    tax: float = 10.5\n    tags: list[str] = []\n\napp = FastAPI()\n\n@app.post(\"/items/\", response_model=Item, status_code=status.HTTP_201_CREATED)\nasync def create_item(item: Item):\n    item_dict = item.dict()\n    if item.tax:\n        price_with_tax = item.price + item.tax\n        item_dict.update({\"price_with_tax\": price_with_tax})\n    return item_dict\n\n@app.get(\"/items/\", response_model=list[Item])\nasync def read_items():\n    return [\n        {\"name\": \"Foo\", \"price\": 50},\n        {\"name\": \"Bar\", \"description\": \"The bartenders\", \"price\": 62, \"tax\": 20.2},\n        {\"name\": \"Baz\", \"price\": 50.2, \"tax\": 10.5, \"tags\": [\"tag1\"]},\n    ]",
          "metadata": {
            "complexity": "medium",
            "language": "python",
            "docs_section": "Advanced - Response Model",
            "pattern": "fastapi_response_model",
            "task_type": "api_development",
            "quality": "official_example",
            "framework": "fastapi",
            "approved": true,
            "indexed_at": "2025-11-03T12:59:49.615879",
            "tags": "fastapi,response-model,status,http",
            "source": "official_docs",
            "code_length": 824,
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257468,
          "rank": 1,
          "relevance_score": 0.8825746800000001,
          "mmr_score": null
        },
        {
          "id": "803efb55-2e90-4ffa-942c-1df8a3b92603",
          "code": "from circuitbreaker import circuit\nimport httpx\n\nclass ResilientClient:\n    @circuit(failure_threshold=5, recovery_timeout=60)\n    async def call_service(self, url: str) -> dict:\n        async with httpx.AsyncClient() as client:\n            response = await client.get(url)\n            response.raise_for_status()\n            return response.json()\n\n# Usage\nclient = ResilientClient()\ntry:\n    data = await client.call_service(\"http://api-service/endpoint\")\nexcept Exception as e:\n    # Handle circuit breaker open\n    pass",
          "metadata": {
            "task_type": "service_communication",
            "pattern": "circuit_breaker",
            "approved": true,
            "code_length": 523,
            "tags": "microservices,circuit-breaker,resilience",
            "language": "python",
            "framework": "circuitbreaker",
            "quality": "production",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "complexity": "high",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 2,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "711b0da2-ab81-4e4a-85f3-efa7c2c2f712",
          "code": "# Multi-stage Dockerfile\nFROM python:3.12-slim as builder\nWORKDIR /app\nRUN python -m venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nCOPY requirements.txt .\nRUN pip install --no-cache-dir -r requirements.txt\n\nFROM python:3.12-slim\nWORKDIR /app\nCOPY --from=builder /opt/venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nRUN useradd -m appuser\nCOPY . .\nUSER appuser\nHEALTHCHECK CMD curl -f http://localhost:8000/health\nEXPOSE 8000\nCMD [\"uvicorn\", \"main:app\", \"--host\", \"0.0.0.0\"]",
          "metadata": {
            "framework": "docker",
            "task_type": "deployment",
            "pattern": "docker_multistage",
            "complexity": "medium",
            "language": "dockerfile",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "code_length": 471,
            "approved": true,
            "tags": "docker,multistage,optimization",
            "quality": "production",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 3,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "47a04ff3-af4b-4388-97ef-4b6779c36b19",
          "code": "from fastapi import FastAPI, BackgroundTasks\n\napp = FastAPI()\n\ndef write_log(message: str):\n    with open(\"log.txt\", \"a\") as f:\n        f.write(message + \"\n\")\n\n@app.post(\"/notify\")\nasync def send_notification(bg: BackgroundTasks, email: str):\n    bg.add_task(write_log, f\"Notify: {email}\")\n    return {\"status\": \"scheduled\"}",
          "metadata": {
            "pattern": "fastapi_background_tasks",
            "task_type": "background_jobs",
            "quality": "official_example",
            "framework": "fastapi",
            "approved": true,
            "complexity": "low",
            "source": "official_docs",
            "code_length": 324,
            "indexed_at": "2025-11-03T12:59:49.615879",
            "language": "python",
            "tags": "fastapi,background,io",
            "docs_section": "Background Tasks",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 4,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "f909508d-1bb3-4a88-9807-1ee5059d9798",
          "code": "def decompose_data_pipeline_tasks(requirements: str) -> List[Task]:\n    '''Decompose data pipeline/ETL system into tasks.'''\n    return [\n        Task(\n            id=1,\n            name=\"Data Source Integration\",\n            description=\"Connect to data sources (APIs, databases, S3), implement connectors with retry logic\",\n            dependencies=[],\n            priority=\"high\",\n            estimated_time=\"2h\",\n            files=[\"connectors/api_connector.py\", \"connectors/db_connector.py\", \"connectors/s3_connector.py\"]\n        ),\n        Task(\n            id=2,\n            name=\"Data Validation & Quality Checks\",\n            description=\"Implement Great Expectations for data validation, define quality rules, alerting on anomalies\",\n            dependencies=[1],\n            priority=\"high\",\n            estimated_time=\"2.5h\",\n            files=[\"validation/expectations/\", \"validation/rules.py\", \"validation/quality_checks.py\"]\n        ),\n        Task(\n            id=3,\n            name=\"Data Transformation Layer\",\n            description=\"Build transformation pipeline with Pandas/Polars, implement data cleaning, enrichment, aggregation\",\n            dependencies=[2],\n            priority=\"high\",\n            estimated_time=\"3h\",\n            files=[\"transformers/cleaning.py\", \"transformers/enrichment.py\", \"transformers/aggregation.py\"]\n        ),\n        Task(\n            id=4,\n            name=\"Data Warehouse Loading\",\n            description=\"Implement incremental loading to data warehouse, handle deduplication, maintain idempotency\",\n            dependencies=[3],\n            priority=\"high\",\n            estimated_time=\"2h\",\n            files=[\"loaders/warehouse_loader.py\", \"loaders/incremental.py\"]\n        ),\n        Task(\n            id=5,\n            name=\"Orchestration & Scheduling\",\n            description=\"Setup Airflow/Prefect DAGs, define dependencies, configure retries and SLAs\",\n            dependencies=[4],\n            priority=\"medium\",\n            estimated_time=\"2h\",\n            files=[\"dags/main_pipeline.py\", \"dags/monitoring.py\"]\n        ),\n        Task(\n            id=6,\n            name=\"Monitoring & Alerting\",\n            description=\"Data quality metrics, pipeline performance monitoring, alerting on failures or anomalies\",\n            dependencies=[5],\n            priority=\"high\",\n            estimated_time=\"1.5h\",\n            files=[\"monitoring/metrics.py\", \"monitoring/alerts.py\"]\n        ),\n    ]",
          "metadata": {
            "project_type": "data_pipeline",
            "pattern": "task_decomposition",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "complexity": "high",
            "task_type": "project_planning",
            "tags": "planning,etl,data_engineering,pipeline,airflow",
            "approved": true,
            "language": "python",
            "code_length": 2460,
            "quality": "production",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 5,
          "relevance_score": 0.86257463,
          "mmr_score": null
        }
      ]
    },
    {
      "query": "input validation to prevent SQL injection",
      "category": "security",
      "found": 5,
      "expected": 2,
      "avg_similarity": 0.8125746399999999,
      "passed": true,
      "examples": [
        {
          "id": "f7cd7a35-a101-4562-abc7-d2ede1adad3a",
          "code": "from typing import Optional\nfrom fastapi import FastAPI, status\nfrom pydantic import BaseModel\n\nclass Item(BaseModel):\n    name: str\n    description: Optional[str] = None\n    price: float\n    tax: float = 10.5\n    tags: list[str] = []\n\napp = FastAPI()\n\n@app.post(\"/items/\", response_model=Item, status_code=status.HTTP_201_CREATED)\nasync def create_item(item: Item):\n    item_dict = item.dict()\n    if item.tax:\n        price_with_tax = item.price + item.tax\n        item_dict.update({\"price_with_tax\": price_with_tax})\n    return item_dict\n\n@app.get(\"/items/\", response_model=list[Item])\nasync def read_items():\n    return [\n        {\"name\": \"Foo\", \"price\": 50},\n        {\"name\": \"Bar\", \"description\": \"The bartenders\", \"price\": 62, \"tax\": 20.2},\n        {\"name\": \"Baz\", \"price\": 50.2, \"tax\": 10.5, \"tags\": [\"tag1\"]},\n    ]",
          "metadata": {
            "language": "python",
            "quality": "official_example",
            "complexity": "medium",
            "tags": "fastapi,response-model,status,http",
            "approved": true,
            "code_length": 824,
            "framework": "fastapi",
            "task_type": "api_development",
            "docs_section": "Advanced - Response Model",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "source": "official_docs",
            "pattern": "fastapi_response_model",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257468,
          "rank": 1,
          "relevance_score": 0.8825746800000001,
          "mmr_score": null
        },
        {
          "id": "a7f7bd26-f761-4863-ba1a-02271291508f",
          "code": "from sqlalchemy.ext.hybrid import hybrid_property\nfrom sqlalchemy.orm import Mapped, mapped_column\n\nclass Product(Base):\n    __tablename__ = \"products\"\n    id: Mapped[int] = mapped_column(primary_key=True)\n    name: Mapped[str]\n    _price: Mapped[float] = mapped_column(\"price\")\n    tax_rate: Mapped[float] = mapped_column(default=0.10)\n    \n    @hybrid_property\n    def price_with_tax(self) -> float:\n        return self._price * (1 + self.tax_rate)\n    \n    @price_with_tax.expression\n    def price_with_tax(cls):\n        return cls._price * (1 + cls.tax_rate)\n\nasync def get_expensive_products(session):\n    stmt = select(Product).where(Product.price_with_tax > 100)\n    return await session.execute(stmt)",
          "metadata": {
            "framework": "sqlalchemy",
            "code_length": 708,
            "complexity": "high",
            "quality": "production",
            "pattern": "sqlalchemy_hybrid_property",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "approved": true,
            "tags": "sqlalchemy,hybrid_property,computed,expressions",
            "task_type": "database_patterns",
            "language": "python",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 2,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "711b0da2-ab81-4e4a-85f3-efa7c2c2f712",
          "code": "# Multi-stage Dockerfile\nFROM python:3.12-slim as builder\nWORKDIR /app\nRUN python -m venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nCOPY requirements.txt .\nRUN pip install --no-cache-dir -r requirements.txt\n\nFROM python:3.12-slim\nWORKDIR /app\nCOPY --from=builder /opt/venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nRUN useradd -m appuser\nCOPY . .\nUSER appuser\nHEALTHCHECK CMD curl -f http://localhost:8000/health\nEXPOSE 8000\nCMD [\"uvicorn\", \"main:app\", \"--host\", \"0.0.0.0\"]",
          "metadata": {
            "language": "dockerfile",
            "pattern": "docker_multistage",
            "quality": "production",
            "code_length": 471,
            "tags": "docker,multistage,optimization",
            "task_type": "deployment",
            "approved": true,
            "indexed_at": "2025-11-03T12:59:49.615879",
            "complexity": "medium",
            "framework": "docker",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 3,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "47a04ff3-af4b-4388-97ef-4b6779c36b19",
          "code": "from fastapi import FastAPI, BackgroundTasks\n\napp = FastAPI()\n\ndef write_log(message: str):\n    with open(\"log.txt\", \"a\") as f:\n        f.write(message + \"\n\")\n\n@app.post(\"/notify\")\nasync def send_notification(bg: BackgroundTasks, email: str):\n    bg.add_task(write_log, f\"Notify: {email}\")\n    return {\"status\": \"scheduled\"}",
          "metadata": {
            "language": "python",
            "task_type": "background_jobs",
            "source": "official_docs",
            "pattern": "fastapi_background_tasks",
            "framework": "fastapi",
            "code_length": 324,
            "complexity": "low",
            "tags": "fastapi,background,io",
            "approved": true,
            "indexed_at": "2025-11-03T12:59:49.615879",
            "docs_section": "Background Tasks",
            "quality": "official_example",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 4,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "f909508d-1bb3-4a88-9807-1ee5059d9798",
          "code": "def decompose_data_pipeline_tasks(requirements: str) -> List[Task]:\n    '''Decompose data pipeline/ETL system into tasks.'''\n    return [\n        Task(\n            id=1,\n            name=\"Data Source Integration\",\n            description=\"Connect to data sources (APIs, databases, S3), implement connectors with retry logic\",\n            dependencies=[],\n            priority=\"high\",\n            estimated_time=\"2h\",\n            files=[\"connectors/api_connector.py\", \"connectors/db_connector.py\", \"connectors/s3_connector.py\"]\n        ),\n        Task(\n            id=2,\n            name=\"Data Validation & Quality Checks\",\n            description=\"Implement Great Expectations for data validation, define quality rules, alerting on anomalies\",\n            dependencies=[1],\n            priority=\"high\",\n            estimated_time=\"2.5h\",\n            files=[\"validation/expectations/\", \"validation/rules.py\", \"validation/quality_checks.py\"]\n        ),\n        Task(\n            id=3,\n            name=\"Data Transformation Layer\",\n            description=\"Build transformation pipeline with Pandas/Polars, implement data cleaning, enrichment, aggregation\",\n            dependencies=[2],\n            priority=\"high\",\n            estimated_time=\"3h\",\n            files=[\"transformers/cleaning.py\", \"transformers/enrichment.py\", \"transformers/aggregation.py\"]\n        ),\n        Task(\n            id=4,\n            name=\"Data Warehouse Loading\",\n            description=\"Implement incremental loading to data warehouse, handle deduplication, maintain idempotency\",\n            dependencies=[3],\n            priority=\"high\",\n            estimated_time=\"2h\",\n            files=[\"loaders/warehouse_loader.py\", \"loaders/incremental.py\"]\n        ),\n        Task(\n            id=5,\n            name=\"Orchestration & Scheduling\",\n            description=\"Setup Airflow/Prefect DAGs, define dependencies, configure retries and SLAs\",\n            dependencies=[4],\n            priority=\"medium\",\n            estimated_time=\"2h\",\n            files=[\"dags/main_pipeline.py\", \"dags/monitoring.py\"]\n        ),\n        Task(\n            id=6,\n            name=\"Monitoring & Alerting\",\n            description=\"Data quality metrics, pipeline performance monitoring, alerting on failures or anomalies\",\n            dependencies=[5],\n            priority=\"high\",\n            estimated_time=\"1.5h\",\n            files=[\"monitoring/metrics.py\", \"monitoring/alerts.py\"]\n        ),\n    ]",
          "metadata": {
            "task_type": "project_planning",
            "pattern": "task_decomposition",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "tags": "planning,etl,data_engineering,pipeline,airflow",
            "code_length": 2460,
            "approved": true,
            "project_type": "data_pipeline",
            "quality": "production",
            "complexity": "high",
            "language": "python",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 5,
          "relevance_score": 0.86257463,
          "mmr_score": null
        }
      ]
    },
    {
      "query": "XSS protection and HTML sanitization",
      "category": "security",
      "found": 5,
      "expected": 1,
      "avg_similarity": 0.8125746399999999,
      "passed": true,
      "examples": [
        {
          "id": "f7cd7a35-a101-4562-abc7-d2ede1adad3a",
          "code": "from typing import Optional\nfrom fastapi import FastAPI, status\nfrom pydantic import BaseModel\n\nclass Item(BaseModel):\n    name: str\n    description: Optional[str] = None\n    price: float\n    tax: float = 10.5\n    tags: list[str] = []\n\napp = FastAPI()\n\n@app.post(\"/items/\", response_model=Item, status_code=status.HTTP_201_CREATED)\nasync def create_item(item: Item):\n    item_dict = item.dict()\n    if item.tax:\n        price_with_tax = item.price + item.tax\n        item_dict.update({\"price_with_tax\": price_with_tax})\n    return item_dict\n\n@app.get(\"/items/\", response_model=list[Item])\nasync def read_items():\n    return [\n        {\"name\": \"Foo\", \"price\": 50},\n        {\"name\": \"Bar\", \"description\": \"The bartenders\", \"price\": 62, \"tax\": 20.2},\n        {\"name\": \"Baz\", \"price\": 50.2, \"tax\": 10.5, \"tags\": [\"tag1\"]},\n    ]",
          "metadata": {
            "docs_section": "Advanced - Response Model",
            "framework": "fastapi",
            "complexity": "medium",
            "task_type": "api_development",
            "pattern": "fastapi_response_model",
            "source": "official_docs",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "tags": "fastapi,response-model,status,http",
            "approved": true,
            "language": "python",
            "code_length": 824,
            "quality": "official_example",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257468,
          "rank": 1,
          "relevance_score": 0.8825746800000001,
          "mmr_score": null
        },
        {
          "id": "a7f7bd26-f761-4863-ba1a-02271291508f",
          "code": "from sqlalchemy.ext.hybrid import hybrid_property\nfrom sqlalchemy.orm import Mapped, mapped_column\n\nclass Product(Base):\n    __tablename__ = \"products\"\n    id: Mapped[int] = mapped_column(primary_key=True)\n    name: Mapped[str]\n    _price: Mapped[float] = mapped_column(\"price\")\n    tax_rate: Mapped[float] = mapped_column(default=0.10)\n    \n    @hybrid_property\n    def price_with_tax(self) -> float:\n        return self._price * (1 + self.tax_rate)\n    \n    @price_with_tax.expression\n    def price_with_tax(cls):\n        return cls._price * (1 + cls.tax_rate)\n\nasync def get_expensive_products(session):\n    stmt = select(Product).where(Product.price_with_tax > 100)\n    return await session.execute(stmt)",
          "metadata": {
            "indexed_at": "2025-11-03T12:59:49.615879",
            "pattern": "sqlalchemy_hybrid_property",
            "framework": "sqlalchemy",
            "approved": true,
            "language": "python",
            "tags": "sqlalchemy,hybrid_property,computed,expressions",
            "task_type": "database_patterns",
            "complexity": "high",
            "quality": "production",
            "code_length": 708,
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 2,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "711b0da2-ab81-4e4a-85f3-efa7c2c2f712",
          "code": "# Multi-stage Dockerfile\nFROM python:3.12-slim as builder\nWORKDIR /app\nRUN python -m venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nCOPY requirements.txt .\nRUN pip install --no-cache-dir -r requirements.txt\n\nFROM python:3.12-slim\nWORKDIR /app\nCOPY --from=builder /opt/venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nRUN useradd -m appuser\nCOPY . .\nUSER appuser\nHEALTHCHECK CMD curl -f http://localhost:8000/health\nEXPOSE 8000\nCMD [\"uvicorn\", \"main:app\", \"--host\", \"0.0.0.0\"]",
          "metadata": {
            "indexed_at": "2025-11-03T12:59:49.615879",
            "language": "dockerfile",
            "task_type": "deployment",
            "quality": "production",
            "framework": "docker",
            "approved": true,
            "pattern": "docker_multistage",
            "code_length": 471,
            "complexity": "medium",
            "tags": "docker,multistage,optimization",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 3,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "47a04ff3-af4b-4388-97ef-4b6779c36b19",
          "code": "from fastapi import FastAPI, BackgroundTasks\n\napp = FastAPI()\n\ndef write_log(message: str):\n    with open(\"log.txt\", \"a\") as f:\n        f.write(message + \"\n\")\n\n@app.post(\"/notify\")\nasync def send_notification(bg: BackgroundTasks, email: str):\n    bg.add_task(write_log, f\"Notify: {email}\")\n    return {\"status\": \"scheduled\"}",
          "metadata": {
            "code_length": 324,
            "approved": true,
            "complexity": "low",
            "docs_section": "Background Tasks",
            "language": "python",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "tags": "fastapi,background,io",
            "task_type": "background_jobs",
            "framework": "fastapi",
            "source": "official_docs",
            "quality": "official_example",
            "pattern": "fastapi_background_tasks",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 4,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "f909508d-1bb3-4a88-9807-1ee5059d9798",
          "code": "def decompose_data_pipeline_tasks(requirements: str) -> List[Task]:\n    '''Decompose data pipeline/ETL system into tasks.'''\n    return [\n        Task(\n            id=1,\n            name=\"Data Source Integration\",\n            description=\"Connect to data sources (APIs, databases, S3), implement connectors with retry logic\",\n            dependencies=[],\n            priority=\"high\",\n            estimated_time=\"2h\",\n            files=[\"connectors/api_connector.py\", \"connectors/db_connector.py\", \"connectors/s3_connector.py\"]\n        ),\n        Task(\n            id=2,\n            name=\"Data Validation & Quality Checks\",\n            description=\"Implement Great Expectations for data validation, define quality rules, alerting on anomalies\",\n            dependencies=[1],\n            priority=\"high\",\n            estimated_time=\"2.5h\",\n            files=[\"validation/expectations/\", \"validation/rules.py\", \"validation/quality_checks.py\"]\n        ),\n        Task(\n            id=3,\n            name=\"Data Transformation Layer\",\n            description=\"Build transformation pipeline with Pandas/Polars, implement data cleaning, enrichment, aggregation\",\n            dependencies=[2],\n            priority=\"high\",\n            estimated_time=\"3h\",\n            files=[\"transformers/cleaning.py\", \"transformers/enrichment.py\", \"transformers/aggregation.py\"]\n        ),\n        Task(\n            id=4,\n            name=\"Data Warehouse Loading\",\n            description=\"Implement incremental loading to data warehouse, handle deduplication, maintain idempotency\",\n            dependencies=[3],\n            priority=\"high\",\n            estimated_time=\"2h\",\n            files=[\"loaders/warehouse_loader.py\", \"loaders/incremental.py\"]\n        ),\n        Task(\n            id=5,\n            name=\"Orchestration & Scheduling\",\n            description=\"Setup Airflow/Prefect DAGs, define dependencies, configure retries and SLAs\",\n            dependencies=[4],\n            priority=\"medium\",\n            estimated_time=\"2h\",\n            files=[\"dags/main_pipeline.py\", \"dags/monitoring.py\"]\n        ),\n        Task(\n            id=6,\n            name=\"Monitoring & Alerting\",\n            description=\"Data quality metrics, pipeline performance monitoring, alerting on failures or anomalies\",\n            dependencies=[5],\n            priority=\"high\",\n            estimated_time=\"1.5h\",\n            files=[\"monitoring/metrics.py\", \"monitoring/alerts.py\"]\n        ),\n    ]",
          "metadata": {
            "language": "python",
            "approved": true,
            "task_type": "project_planning",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "project_type": "data_pipeline",
            "pattern": "task_decomposition",
            "complexity": "high",
            "tags": "planning,etl,data_engineering,pipeline,airflow",
            "quality": "production",
            "code_length": 2460,
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 5,
          "relevance_score": 0.86257463,
          "mmr_score": null
        }
      ]
    },
    {
      "query": "password strength validation policy",
      "category": "security",
      "found": 5,
      "expected": 1,
      "avg_similarity": 0.8125745819999999,
      "passed": true,
      "examples": [
        {
          "id": "f7cd7a35-a101-4562-abc7-d2ede1adad3a",
          "code": "from typing import Optional\nfrom fastapi import FastAPI, status\nfrom pydantic import BaseModel\n\nclass Item(BaseModel):\n    name: str\n    description: Optional[str] = None\n    price: float\n    tax: float = 10.5\n    tags: list[str] = []\n\napp = FastAPI()\n\n@app.post(\"/items/\", response_model=Item, status_code=status.HTTP_201_CREATED)\nasync def create_item(item: Item):\n    item_dict = item.dict()\n    if item.tax:\n        price_with_tax = item.price + item.tax\n        item_dict.update({\"price_with_tax\": price_with_tax})\n    return item_dict\n\n@app.get(\"/items/\", response_model=list[Item])\nasync def read_items():\n    return [\n        {\"name\": \"Foo\", \"price\": 50},\n        {\"name\": \"Bar\", \"description\": \"The bartenders\", \"price\": 62, \"tax\": 20.2},\n        {\"name\": \"Baz\", \"price\": 50.2, \"tax\": 10.5, \"tags\": [\"tag1\"]},\n    ]",
          "metadata": {
            "docs_section": "Advanced - Response Model",
            "source": "official_docs",
            "pattern": "fastapi_response_model",
            "framework": "fastapi",
            "quality": "official_example",
            "approved": true,
            "language": "python",
            "tags": "fastapi,response-model,status,http",
            "task_type": "api_development",
            "complexity": "medium",
            "code_length": 824,
            "indexed_at": "2025-11-03T12:59:49.615879",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 1,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "a7f7bd26-f761-4863-ba1a-02271291508f",
          "code": "from sqlalchemy.ext.hybrid import hybrid_property\nfrom sqlalchemy.orm import Mapped, mapped_column\n\nclass Product(Base):\n    __tablename__ = \"products\"\n    id: Mapped[int] = mapped_column(primary_key=True)\n    name: Mapped[str]\n    _price: Mapped[float] = mapped_column(\"price\")\n    tax_rate: Mapped[float] = mapped_column(default=0.10)\n    \n    @hybrid_property\n    def price_with_tax(self) -> float:\n        return self._price * (1 + self.tax_rate)\n    \n    @price_with_tax.expression\n    def price_with_tax(cls):\n        return cls._price * (1 + cls.tax_rate)\n\nasync def get_expensive_products(session):\n    stmt = select(Product).where(Product.price_with_tax > 100)\n    return await session.execute(stmt)",
          "metadata": {
            "pattern": "sqlalchemy_hybrid_property",
            "code_length": 708,
            "quality": "production",
            "framework": "sqlalchemy",
            "complexity": "high",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "task_type": "database_patterns",
            "tags": "sqlalchemy,hybrid_property,computed,expressions",
            "language": "python",
            "approved": true,
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257457,
          "rank": 2,
          "relevance_score": 0.8825745700000001,
          "mmr_score": null
        },
        {
          "id": "803efb55-2e90-4ffa-942c-1df8a3b92603",
          "code": "from circuitbreaker import circuit\nimport httpx\n\nclass ResilientClient:\n    @circuit(failure_threshold=5, recovery_timeout=60)\n    async def call_service(self, url: str) -> dict:\n        async with httpx.AsyncClient() as client:\n            response = await client.get(url)\n            response.raise_for_status()\n            return response.json()\n\n# Usage\nclient = ResilientClient()\ntry:\n    data = await client.call_service(\"http://api-service/endpoint\")\nexcept Exception as e:\n    # Handle circuit breaker open\n    pass",
          "metadata": {
            "task_type": "service_communication",
            "pattern": "circuit_breaker",
            "tags": "microservices,circuit-breaker,resilience",
            "code_length": 523,
            "complexity": "high",
            "quality": "production",
            "language": "python",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "approved": true,
            "framework": "circuitbreaker",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257457,
          "rank": 3,
          "relevance_score": 0.8825745700000001,
          "mmr_score": null
        },
        {
          "id": "711b0da2-ab81-4e4a-85f3-efa7c2c2f712",
          "code": "# Multi-stage Dockerfile\nFROM python:3.12-slim as builder\nWORKDIR /app\nRUN python -m venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nCOPY requirements.txt .\nRUN pip install --no-cache-dir -r requirements.txt\n\nFROM python:3.12-slim\nWORKDIR /app\nCOPY --from=builder /opt/venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nRUN useradd -m appuser\nCOPY . .\nUSER appuser\nHEALTHCHECK CMD curl -f http://localhost:8000/health\nEXPOSE 8000\nCMD [\"uvicorn\", \"main:app\", \"--host\", \"0.0.0.0\"]",
          "metadata": {
            "indexed_at": "2025-11-03T12:59:49.615879",
            "task_type": "deployment",
            "framework": "docker",
            "complexity": "medium",
            "quality": "production",
            "code_length": 471,
            "approved": true,
            "language": "dockerfile",
            "pattern": "docker_multistage",
            "tags": "docker,multistage,optimization",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257457,
          "rank": 4,
          "relevance_score": 0.8825745700000001,
          "mmr_score": null
        },
        {
          "id": "47a04ff3-af4b-4388-97ef-4b6779c36b19",
          "code": "from fastapi import FastAPI, BackgroundTasks\n\napp = FastAPI()\n\ndef write_log(message: str):\n    with open(\"log.txt\", \"a\") as f:\n        f.write(message + \"\n\")\n\n@app.post(\"/notify\")\nasync def send_notification(bg: BackgroundTasks, email: str):\n    bg.add_task(write_log, f\"Notify: {email}\")\n    return {\"status\": \"scheduled\"}",
          "metadata": {
            "pattern": "fastapi_background_tasks",
            "complexity": "low",
            "docs_section": "Background Tasks",
            "language": "python",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "quality": "official_example",
            "source": "official_docs",
            "tags": "fastapi,background,io",
            "code_length": 324,
            "framework": "fastapi",
            "approved": true,
            "task_type": "background_jobs",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257457,
          "rank": 5,
          "relevance_score": 0.8825745700000001,
          "mmr_score": null
        }
      ]
    },
    {
      "query": "pytest fixtures for async database testing",
      "category": "testing",
      "found": 5,
      "expected": 2,
      "avg_similarity": 0.8125746399999999,
      "passed": true,
      "examples": [
        {
          "id": "f7cd7a35-a101-4562-abc7-d2ede1adad3a",
          "code": "from typing import Optional\nfrom fastapi import FastAPI, status\nfrom pydantic import BaseModel\n\nclass Item(BaseModel):\n    name: str\n    description: Optional[str] = None\n    price: float\n    tax: float = 10.5\n    tags: list[str] = []\n\napp = FastAPI()\n\n@app.post(\"/items/\", response_model=Item, status_code=status.HTTP_201_CREATED)\nasync def create_item(item: Item):\n    item_dict = item.dict()\n    if item.tax:\n        price_with_tax = item.price + item.tax\n        item_dict.update({\"price_with_tax\": price_with_tax})\n    return item_dict\n\n@app.get(\"/items/\", response_model=list[Item])\nasync def read_items():\n    return [\n        {\"name\": \"Foo\", \"price\": 50},\n        {\"name\": \"Bar\", \"description\": \"The bartenders\", \"price\": 62, \"tax\": 20.2},\n        {\"name\": \"Baz\", \"price\": 50.2, \"tax\": 10.5, \"tags\": [\"tag1\"]},\n    ]",
          "metadata": {
            "framework": "fastapi",
            "code_length": 824,
            "tags": "fastapi,response-model,status,http",
            "docs_section": "Advanced - Response Model",
            "source": "official_docs",
            "language": "python",
            "pattern": "fastapi_response_model",
            "quality": "official_example",
            "approved": true,
            "task_type": "api_development",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "complexity": "medium",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257468,
          "rank": 1,
          "relevance_score": 0.8825746800000001,
          "mmr_score": null
        },
        {
          "id": "a7f7bd26-f761-4863-ba1a-02271291508f",
          "code": "from sqlalchemy.ext.hybrid import hybrid_property\nfrom sqlalchemy.orm import Mapped, mapped_column\n\nclass Product(Base):\n    __tablename__ = \"products\"\n    id: Mapped[int] = mapped_column(primary_key=True)\n    name: Mapped[str]\n    _price: Mapped[float] = mapped_column(\"price\")\n    tax_rate: Mapped[float] = mapped_column(default=0.10)\n    \n    @hybrid_property\n    def price_with_tax(self) -> float:\n        return self._price * (1 + self.tax_rate)\n    \n    @price_with_tax.expression\n    def price_with_tax(cls):\n        return cls._price * (1 + cls.tax_rate)\n\nasync def get_expensive_products(session):\n    stmt = select(Product).where(Product.price_with_tax > 100)\n    return await session.execute(stmt)",
          "metadata": {
            "complexity": "high",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "tags": "sqlalchemy,hybrid_property,computed,expressions",
            "approved": true,
            "pattern": "sqlalchemy_hybrid_property",
            "quality": "production",
            "language": "python",
            "code_length": 708,
            "framework": "sqlalchemy",
            "task_type": "database_patterns",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 2,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "711b0da2-ab81-4e4a-85f3-efa7c2c2f712",
          "code": "# Multi-stage Dockerfile\nFROM python:3.12-slim as builder\nWORKDIR /app\nRUN python -m venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nCOPY requirements.txt .\nRUN pip install --no-cache-dir -r requirements.txt\n\nFROM python:3.12-slim\nWORKDIR /app\nCOPY --from=builder /opt/venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nRUN useradd -m appuser\nCOPY . .\nUSER appuser\nHEALTHCHECK CMD curl -f http://localhost:8000/health\nEXPOSE 8000\nCMD [\"uvicorn\", \"main:app\", \"--host\", \"0.0.0.0\"]",
          "metadata": {
            "code_length": 471,
            "tags": "docker,multistage,optimization",
            "pattern": "docker_multistage",
            "framework": "docker",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "task_type": "deployment",
            "quality": "production",
            "language": "dockerfile",
            "complexity": "medium",
            "approved": true,
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 3,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "47a04ff3-af4b-4388-97ef-4b6779c36b19",
          "code": "from fastapi import FastAPI, BackgroundTasks\n\napp = FastAPI()\n\ndef write_log(message: str):\n    with open(\"log.txt\", \"a\") as f:\n        f.write(message + \"\n\")\n\n@app.post(\"/notify\")\nasync def send_notification(bg: BackgroundTasks, email: str):\n    bg.add_task(write_log, f\"Notify: {email}\")\n    return {\"status\": \"scheduled\"}",
          "metadata": {
            "indexed_at": "2025-11-03T12:59:49.615879",
            "task_type": "background_jobs",
            "source": "official_docs",
            "framework": "fastapi",
            "tags": "fastapi,background,io",
            "approved": true,
            "docs_section": "Background Tasks",
            "pattern": "fastapi_background_tasks",
            "quality": "official_example",
            "language": "python",
            "complexity": "low",
            "code_length": 324,
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 4,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "f909508d-1bb3-4a88-9807-1ee5059d9798",
          "code": "def decompose_data_pipeline_tasks(requirements: str) -> List[Task]:\n    '''Decompose data pipeline/ETL system into tasks.'''\n    return [\n        Task(\n            id=1,\n            name=\"Data Source Integration\",\n            description=\"Connect to data sources (APIs, databases, S3), implement connectors with retry logic\",\n            dependencies=[],\n            priority=\"high\",\n            estimated_time=\"2h\",\n            files=[\"connectors/api_connector.py\", \"connectors/db_connector.py\", \"connectors/s3_connector.py\"]\n        ),\n        Task(\n            id=2,\n            name=\"Data Validation & Quality Checks\",\n            description=\"Implement Great Expectations for data validation, define quality rules, alerting on anomalies\",\n            dependencies=[1],\n            priority=\"high\",\n            estimated_time=\"2.5h\",\n            files=[\"validation/expectations/\", \"validation/rules.py\", \"validation/quality_checks.py\"]\n        ),\n        Task(\n            id=3,\n            name=\"Data Transformation Layer\",\n            description=\"Build transformation pipeline with Pandas/Polars, implement data cleaning, enrichment, aggregation\",\n            dependencies=[2],\n            priority=\"high\",\n            estimated_time=\"3h\",\n            files=[\"transformers/cleaning.py\", \"transformers/enrichment.py\", \"transformers/aggregation.py\"]\n        ),\n        Task(\n            id=4,\n            name=\"Data Warehouse Loading\",\n            description=\"Implement incremental loading to data warehouse, handle deduplication, maintain idempotency\",\n            dependencies=[3],\n            priority=\"high\",\n            estimated_time=\"2h\",\n            files=[\"loaders/warehouse_loader.py\", \"loaders/incremental.py\"]\n        ),\n        Task(\n            id=5,\n            name=\"Orchestration & Scheduling\",\n            description=\"Setup Airflow/Prefect DAGs, define dependencies, configure retries and SLAs\",\n            dependencies=[4],\n            priority=\"medium\",\n            estimated_time=\"2h\",\n            files=[\"dags/main_pipeline.py\", \"dags/monitoring.py\"]\n        ),\n        Task(\n            id=6,\n            name=\"Monitoring & Alerting\",\n            description=\"Data quality metrics, pipeline performance monitoring, alerting on failures or anomalies\",\n            dependencies=[5],\n            priority=\"high\",\n            estimated_time=\"1.5h\",\n            files=[\"monitoring/metrics.py\", \"monitoring/alerts.py\"]\n        ),\n    ]",
          "metadata": {
            "complexity": "high",
            "code_length": 2460,
            "project_type": "data_pipeline",
            "pattern": "task_decomposition",
            "language": "python",
            "tags": "planning,etl,data_engineering,pipeline,airflow",
            "quality": "production",
            "task_type": "project_planning",
            "approved": true,
            "indexed_at": "2025-11-03T12:59:49.615879",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 5,
          "relevance_score": 0.86257463,
          "mmr_score": null
        }
      ]
    },
    {
      "query": "API testing with authentication headers",
      "category": "testing",
      "found": 5,
      "expected": 2,
      "avg_similarity": 0.8125746399999999,
      "passed": true,
      "examples": [
        {
          "id": "f7cd7a35-a101-4562-abc7-d2ede1adad3a",
          "code": "from typing import Optional\nfrom fastapi import FastAPI, status\nfrom pydantic import BaseModel\n\nclass Item(BaseModel):\n    name: str\n    description: Optional[str] = None\n    price: float\n    tax: float = 10.5\n    tags: list[str] = []\n\napp = FastAPI()\n\n@app.post(\"/items/\", response_model=Item, status_code=status.HTTP_201_CREATED)\nasync def create_item(item: Item):\n    item_dict = item.dict()\n    if item.tax:\n        price_with_tax = item.price + item.tax\n        item_dict.update({\"price_with_tax\": price_with_tax})\n    return item_dict\n\n@app.get(\"/items/\", response_model=list[Item])\nasync def read_items():\n    return [\n        {\"name\": \"Foo\", \"price\": 50},\n        {\"name\": \"Bar\", \"description\": \"The bartenders\", \"price\": 62, \"tax\": 20.2},\n        {\"name\": \"Baz\", \"price\": 50.2, \"tax\": 10.5, \"tags\": [\"tag1\"]},\n    ]",
          "metadata": {
            "docs_section": "Advanced - Response Model",
            "source": "official_docs",
            "complexity": "medium",
            "pattern": "fastapi_response_model",
            "task_type": "api_development",
            "approved": true,
            "tags": "fastapi,response-model,status,http",
            "quality": "official_example",
            "code_length": 824,
            "indexed_at": "2025-11-03T12:59:49.615879",
            "language": "python",
            "framework": "fastapi",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257468,
          "rank": 1,
          "relevance_score": 0.8825746800000001,
          "mmr_score": null
        },
        {
          "id": "a7f7bd26-f761-4863-ba1a-02271291508f",
          "code": "from sqlalchemy.ext.hybrid import hybrid_property\nfrom sqlalchemy.orm import Mapped, mapped_column\n\nclass Product(Base):\n    __tablename__ = \"products\"\n    id: Mapped[int] = mapped_column(primary_key=True)\n    name: Mapped[str]\n    _price: Mapped[float] = mapped_column(\"price\")\n    tax_rate: Mapped[float] = mapped_column(default=0.10)\n    \n    @hybrid_property\n    def price_with_tax(self) -> float:\n        return self._price * (1 + self.tax_rate)\n    \n    @price_with_tax.expression\n    def price_with_tax(cls):\n        return cls._price * (1 + cls.tax_rate)\n\nasync def get_expensive_products(session):\n    stmt = select(Product).where(Product.price_with_tax > 100)\n    return await session.execute(stmt)",
          "metadata": {
            "complexity": "high",
            "code_length": 708,
            "indexed_at": "2025-11-03T12:59:49.615879",
            "pattern": "sqlalchemy_hybrid_property",
            "tags": "sqlalchemy,hybrid_property,computed,expressions",
            "approved": true,
            "framework": "sqlalchemy",
            "quality": "production",
            "language": "python",
            "task_type": "database_patterns",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 2,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "711b0da2-ab81-4e4a-85f3-efa7c2c2f712",
          "code": "# Multi-stage Dockerfile\nFROM python:3.12-slim as builder\nWORKDIR /app\nRUN python -m venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nCOPY requirements.txt .\nRUN pip install --no-cache-dir -r requirements.txt\n\nFROM python:3.12-slim\nWORKDIR /app\nCOPY --from=builder /opt/venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nRUN useradd -m appuser\nCOPY . .\nUSER appuser\nHEALTHCHECK CMD curl -f http://localhost:8000/health\nEXPOSE 8000\nCMD [\"uvicorn\", \"main:app\", \"--host\", \"0.0.0.0\"]",
          "metadata": {
            "tags": "docker,multistage,optimization",
            "language": "dockerfile",
            "pattern": "docker_multistage",
            "task_type": "deployment",
            "framework": "docker",
            "code_length": 471,
            "indexed_at": "2025-11-03T12:59:49.615879",
            "approved": true,
            "quality": "production",
            "complexity": "medium",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 3,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "47a04ff3-af4b-4388-97ef-4b6779c36b19",
          "code": "from fastapi import FastAPI, BackgroundTasks\n\napp = FastAPI()\n\ndef write_log(message: str):\n    with open(\"log.txt\", \"a\") as f:\n        f.write(message + \"\n\")\n\n@app.post(\"/notify\")\nasync def send_notification(bg: BackgroundTasks, email: str):\n    bg.add_task(write_log, f\"Notify: {email}\")\n    return {\"status\": \"scheduled\"}",
          "metadata": {
            "source": "official_docs",
            "pattern": "fastapi_background_tasks",
            "tags": "fastapi,background,io",
            "complexity": "low",
            "approved": true,
            "indexed_at": "2025-11-03T12:59:49.615879",
            "quality": "official_example",
            "docs_section": "Background Tasks",
            "code_length": 324,
            "framework": "fastapi",
            "task_type": "background_jobs",
            "language": "python",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 4,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "f909508d-1bb3-4a88-9807-1ee5059d9798",
          "code": "def decompose_data_pipeline_tasks(requirements: str) -> List[Task]:\n    '''Decompose data pipeline/ETL system into tasks.'''\n    return [\n        Task(\n            id=1,\n            name=\"Data Source Integration\",\n            description=\"Connect to data sources (APIs, databases, S3), implement connectors with retry logic\",\n            dependencies=[],\n            priority=\"high\",\n            estimated_time=\"2h\",\n            files=[\"connectors/api_connector.py\", \"connectors/db_connector.py\", \"connectors/s3_connector.py\"]\n        ),\n        Task(\n            id=2,\n            name=\"Data Validation & Quality Checks\",\n            description=\"Implement Great Expectations for data validation, define quality rules, alerting on anomalies\",\n            dependencies=[1],\n            priority=\"high\",\n            estimated_time=\"2.5h\",\n            files=[\"validation/expectations/\", \"validation/rules.py\", \"validation/quality_checks.py\"]\n        ),\n        Task(\n            id=3,\n            name=\"Data Transformation Layer\",\n            description=\"Build transformation pipeline with Pandas/Polars, implement data cleaning, enrichment, aggregation\",\n            dependencies=[2],\n            priority=\"high\",\n            estimated_time=\"3h\",\n            files=[\"transformers/cleaning.py\", \"transformers/enrichment.py\", \"transformers/aggregation.py\"]\n        ),\n        Task(\n            id=4,\n            name=\"Data Warehouse Loading\",\n            description=\"Implement incremental loading to data warehouse, handle deduplication, maintain idempotency\",\n            dependencies=[3],\n            priority=\"high\",\n            estimated_time=\"2h\",\n            files=[\"loaders/warehouse_loader.py\", \"loaders/incremental.py\"]\n        ),\n        Task(\n            id=5,\n            name=\"Orchestration & Scheduling\",\n            description=\"Setup Airflow/Prefect DAGs, define dependencies, configure retries and SLAs\",\n            dependencies=[4],\n            priority=\"medium\",\n            estimated_time=\"2h\",\n            files=[\"dags/main_pipeline.py\", \"dags/monitoring.py\"]\n        ),\n        Task(\n            id=6,\n            name=\"Monitoring & Alerting\",\n            description=\"Data quality metrics, pipeline performance monitoring, alerting on failures or anomalies\",\n            dependencies=[5],\n            priority=\"high\",\n            estimated_time=\"1.5h\",\n            files=[\"monitoring/metrics.py\", \"monitoring/alerts.py\"]\n        ),\n    ]",
          "metadata": {
            "code_length": 2460,
            "quality": "production",
            "task_type": "project_planning",
            "tags": "planning,etl,data_engineering,pipeline,airflow",
            "complexity": "high",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "approved": true,
            "project_type": "data_pipeline",
            "pattern": "task_decomposition",
            "language": "python",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 5,
          "relevance_score": 0.86257463,
          "mmr_score": null
        }
      ]
    },
    {
      "query": "mocking async functions with AsyncMock",
      "category": "testing",
      "found": 5,
      "expected": 2,
      "avg_similarity": 0.8125746399999999,
      "passed": true,
      "examples": [
        {
          "id": "f7cd7a35-a101-4562-abc7-d2ede1adad3a",
          "code": "from typing import Optional\nfrom fastapi import FastAPI, status\nfrom pydantic import BaseModel\n\nclass Item(BaseModel):\n    name: str\n    description: Optional[str] = None\n    price: float\n    tax: float = 10.5\n    tags: list[str] = []\n\napp = FastAPI()\n\n@app.post(\"/items/\", response_model=Item, status_code=status.HTTP_201_CREATED)\nasync def create_item(item: Item):\n    item_dict = item.dict()\n    if item.tax:\n        price_with_tax = item.price + item.tax\n        item_dict.update({\"price_with_tax\": price_with_tax})\n    return item_dict\n\n@app.get(\"/items/\", response_model=list[Item])\nasync def read_items():\n    return [\n        {\"name\": \"Foo\", \"price\": 50},\n        {\"name\": \"Bar\", \"description\": \"The bartenders\", \"price\": 62, \"tax\": 20.2},\n        {\"name\": \"Baz\", \"price\": 50.2, \"tax\": 10.5, \"tags\": [\"tag1\"]},\n    ]",
          "metadata": {
            "pattern": "fastapi_response_model",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "docs_section": "Advanced - Response Model",
            "complexity": "medium",
            "language": "python",
            "source": "official_docs",
            "code_length": 824,
            "task_type": "api_development",
            "quality": "official_example",
            "approved": true,
            "tags": "fastapi,response-model,status,http",
            "framework": "fastapi",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257468,
          "rank": 1,
          "relevance_score": 0.8825746800000001,
          "mmr_score": null
        },
        {
          "id": "a7f7bd26-f761-4863-ba1a-02271291508f",
          "code": "from sqlalchemy.ext.hybrid import hybrid_property\nfrom sqlalchemy.orm import Mapped, mapped_column\n\nclass Product(Base):\n    __tablename__ = \"products\"\n    id: Mapped[int] = mapped_column(primary_key=True)\n    name: Mapped[str]\n    _price: Mapped[float] = mapped_column(\"price\")\n    tax_rate: Mapped[float] = mapped_column(default=0.10)\n    \n    @hybrid_property\n    def price_with_tax(self) -> float:\n        return self._price * (1 + self.tax_rate)\n    \n    @price_with_tax.expression\n    def price_with_tax(cls):\n        return cls._price * (1 + cls.tax_rate)\n\nasync def get_expensive_products(session):\n    stmt = select(Product).where(Product.price_with_tax > 100)\n    return await session.execute(stmt)",
          "metadata": {
            "tags": "sqlalchemy,hybrid_property,computed,expressions",
            "complexity": "high",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "approved": true,
            "code_length": 708,
            "language": "python",
            "pattern": "sqlalchemy_hybrid_property",
            "framework": "sqlalchemy",
            "task_type": "database_patterns",
            "quality": "production",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 2,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "711b0da2-ab81-4e4a-85f3-efa7c2c2f712",
          "code": "# Multi-stage Dockerfile\nFROM python:3.12-slim as builder\nWORKDIR /app\nRUN python -m venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nCOPY requirements.txt .\nRUN pip install --no-cache-dir -r requirements.txt\n\nFROM python:3.12-slim\nWORKDIR /app\nCOPY --from=builder /opt/venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nRUN useradd -m appuser\nCOPY . .\nUSER appuser\nHEALTHCHECK CMD curl -f http://localhost:8000/health\nEXPOSE 8000\nCMD [\"uvicorn\", \"main:app\", \"--host\", \"0.0.0.0\"]",
          "metadata": {
            "approved": true,
            "task_type": "deployment",
            "pattern": "docker_multistage",
            "quality": "production",
            "framework": "docker",
            "language": "dockerfile",
            "complexity": "medium",
            "code_length": 471,
            "indexed_at": "2025-11-03T12:59:49.615879",
            "tags": "docker,multistage,optimization",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 3,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "47a04ff3-af4b-4388-97ef-4b6779c36b19",
          "code": "from fastapi import FastAPI, BackgroundTasks\n\napp = FastAPI()\n\ndef write_log(message: str):\n    with open(\"log.txt\", \"a\") as f:\n        f.write(message + \"\n\")\n\n@app.post(\"/notify\")\nasync def send_notification(bg: BackgroundTasks, email: str):\n    bg.add_task(write_log, f\"Notify: {email}\")\n    return {\"status\": \"scheduled\"}",
          "metadata": {
            "code_length": 324,
            "docs_section": "Background Tasks",
            "task_type": "background_jobs",
            "framework": "fastapi",
            "quality": "official_example",
            "complexity": "low",
            "approved": true,
            "tags": "fastapi,background,io",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "pattern": "fastapi_background_tasks",
            "language": "python",
            "source": "official_docs",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 4,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "f909508d-1bb3-4a88-9807-1ee5059d9798",
          "code": "def decompose_data_pipeline_tasks(requirements: str) -> List[Task]:\n    '''Decompose data pipeline/ETL system into tasks.'''\n    return [\n        Task(\n            id=1,\n            name=\"Data Source Integration\",\n            description=\"Connect to data sources (APIs, databases, S3), implement connectors with retry logic\",\n            dependencies=[],\n            priority=\"high\",\n            estimated_time=\"2h\",\n            files=[\"connectors/api_connector.py\", \"connectors/db_connector.py\", \"connectors/s3_connector.py\"]\n        ),\n        Task(\n            id=2,\n            name=\"Data Validation & Quality Checks\",\n            description=\"Implement Great Expectations for data validation, define quality rules, alerting on anomalies\",\n            dependencies=[1],\n            priority=\"high\",\n            estimated_time=\"2.5h\",\n            files=[\"validation/expectations/\", \"validation/rules.py\", \"validation/quality_checks.py\"]\n        ),\n        Task(\n            id=3,\n            name=\"Data Transformation Layer\",\n            description=\"Build transformation pipeline with Pandas/Polars, implement data cleaning, enrichment, aggregation\",\n            dependencies=[2],\n            priority=\"high\",\n            estimated_time=\"3h\",\n            files=[\"transformers/cleaning.py\", \"transformers/enrichment.py\", \"transformers/aggregation.py\"]\n        ),\n        Task(\n            id=4,\n            name=\"Data Warehouse Loading\",\n            description=\"Implement incremental loading to data warehouse, handle deduplication, maintain idempotency\",\n            dependencies=[3],\n            priority=\"high\",\n            estimated_time=\"2h\",\n            files=[\"loaders/warehouse_loader.py\", \"loaders/incremental.py\"]\n        ),\n        Task(\n            id=5,\n            name=\"Orchestration & Scheduling\",\n            description=\"Setup Airflow/Prefect DAGs, define dependencies, configure retries and SLAs\",\n            dependencies=[4],\n            priority=\"medium\",\n            estimated_time=\"2h\",\n            files=[\"dags/main_pipeline.py\", \"dags/monitoring.py\"]\n        ),\n        Task(\n            id=6,\n            name=\"Monitoring & Alerting\",\n            description=\"Data quality metrics, pipeline performance monitoring, alerting on failures or anomalies\",\n            dependencies=[5],\n            priority=\"high\",\n            estimated_time=\"1.5h\",\n            files=[\"monitoring/metrics.py\", \"monitoring/alerts.py\"]\n        ),\n    ]",
          "metadata": {
            "tags": "planning,etl,data_engineering,pipeline,airflow",
            "language": "python",
            "complexity": "high",
            "quality": "production",
            "approved": true,
            "project_type": "data_pipeline",
            "task_type": "project_planning",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "pattern": "task_decomposition",
            "code_length": 2460,
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 5,
          "relevance_score": 0.86257463,
          "mmr_score": null
        }
      ]
    },
    {
      "query": "parametrized tests with pytest.mark.parametrize",
      "category": "testing",
      "found": 5,
      "expected": 1,
      "avg_similarity": 0.8125745819999999,
      "passed": true,
      "examples": [
        {
          "id": "f7cd7a35-a101-4562-abc7-d2ede1adad3a",
          "code": "from typing import Optional\nfrom fastapi import FastAPI, status\nfrom pydantic import BaseModel\n\nclass Item(BaseModel):\n    name: str\n    description: Optional[str] = None\n    price: float\n    tax: float = 10.5\n    tags: list[str] = []\n\napp = FastAPI()\n\n@app.post(\"/items/\", response_model=Item, status_code=status.HTTP_201_CREATED)\nasync def create_item(item: Item):\n    item_dict = item.dict()\n    if item.tax:\n        price_with_tax = item.price + item.tax\n        item_dict.update({\"price_with_tax\": price_with_tax})\n    return item_dict\n\n@app.get(\"/items/\", response_model=list[Item])\nasync def read_items():\n    return [\n        {\"name\": \"Foo\", \"price\": 50},\n        {\"name\": \"Bar\", \"description\": \"The bartenders\", \"price\": 62, \"tax\": 20.2},\n        {\"name\": \"Baz\", \"price\": 50.2, \"tax\": 10.5, \"tags\": [\"tag1\"]},\n    ]",
          "metadata": {
            "framework": "fastapi",
            "approved": true,
            "tags": "fastapi,response-model,status,http",
            "pattern": "fastapi_response_model",
            "docs_section": "Advanced - Response Model",
            "complexity": "medium",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "language": "python",
            "quality": "official_example",
            "source": "official_docs",
            "code_length": 824,
            "task_type": "api_development",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 1,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "a7f7bd26-f761-4863-ba1a-02271291508f",
          "code": "from sqlalchemy.ext.hybrid import hybrid_property\nfrom sqlalchemy.orm import Mapped, mapped_column\n\nclass Product(Base):\n    __tablename__ = \"products\"\n    id: Mapped[int] = mapped_column(primary_key=True)\n    name: Mapped[str]\n    _price: Mapped[float] = mapped_column(\"price\")\n    tax_rate: Mapped[float] = mapped_column(default=0.10)\n    \n    @hybrid_property\n    def price_with_tax(self) -> float:\n        return self._price * (1 + self.tax_rate)\n    \n    @price_with_tax.expression\n    def price_with_tax(cls):\n        return cls._price * (1 + cls.tax_rate)\n\nasync def get_expensive_products(session):\n    stmt = select(Product).where(Product.price_with_tax > 100)\n    return await session.execute(stmt)",
          "metadata": {
            "tags": "sqlalchemy,hybrid_property,computed,expressions",
            "pattern": "sqlalchemy_hybrid_property",
            "complexity": "high",
            "code_length": 708,
            "indexed_at": "2025-11-03T12:59:49.615879",
            "task_type": "database_patterns",
            "language": "python",
            "approved": true,
            "framework": "sqlalchemy",
            "quality": "production",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257457,
          "rank": 2,
          "relevance_score": 0.8825745700000001,
          "mmr_score": null
        },
        {
          "id": "803efb55-2e90-4ffa-942c-1df8a3b92603",
          "code": "from circuitbreaker import circuit\nimport httpx\n\nclass ResilientClient:\n    @circuit(failure_threshold=5, recovery_timeout=60)\n    async def call_service(self, url: str) -> dict:\n        async with httpx.AsyncClient() as client:\n            response = await client.get(url)\n            response.raise_for_status()\n            return response.json()\n\n# Usage\nclient = ResilientClient()\ntry:\n    data = await client.call_service(\"http://api-service/endpoint\")\nexcept Exception as e:\n    # Handle circuit breaker open\n    pass",
          "metadata": {
            "code_length": 523,
            "language": "python",
            "pattern": "circuit_breaker",
            "approved": true,
            "complexity": "high",
            "tags": "microservices,circuit-breaker,resilience",
            "framework": "circuitbreaker",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "task_type": "service_communication",
            "quality": "production",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257457,
          "rank": 3,
          "relevance_score": 0.8825745700000001,
          "mmr_score": null
        },
        {
          "id": "711b0da2-ab81-4e4a-85f3-efa7c2c2f712",
          "code": "# Multi-stage Dockerfile\nFROM python:3.12-slim as builder\nWORKDIR /app\nRUN python -m venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nCOPY requirements.txt .\nRUN pip install --no-cache-dir -r requirements.txt\n\nFROM python:3.12-slim\nWORKDIR /app\nCOPY --from=builder /opt/venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nRUN useradd -m appuser\nCOPY . .\nUSER appuser\nHEALTHCHECK CMD curl -f http://localhost:8000/health\nEXPOSE 8000\nCMD [\"uvicorn\", \"main:app\", \"--host\", \"0.0.0.0\"]",
          "metadata": {
            "complexity": "medium",
            "quality": "production",
            "task_type": "deployment",
            "framework": "docker",
            "code_length": 471,
            "pattern": "docker_multistage",
            "language": "dockerfile",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "tags": "docker,multistage,optimization",
            "approved": true,
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257457,
          "rank": 4,
          "relevance_score": 0.8825745700000001,
          "mmr_score": null
        },
        {
          "id": "47a04ff3-af4b-4388-97ef-4b6779c36b19",
          "code": "from fastapi import FastAPI, BackgroundTasks\n\napp = FastAPI()\n\ndef write_log(message: str):\n    with open(\"log.txt\", \"a\") as f:\n        f.write(message + \"\n\")\n\n@app.post(\"/notify\")\nasync def send_notification(bg: BackgroundTasks, email: str):\n    bg.add_task(write_log, f\"Notify: {email}\")\n    return {\"status\": \"scheduled\"}",
          "metadata": {
            "task_type": "background_jobs",
            "language": "python",
            "quality": "official_example",
            "tags": "fastapi,background,io",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "code_length": 324,
            "framework": "fastapi",
            "approved": true,
            "pattern": "fastapi_background_tasks",
            "source": "official_docs",
            "docs_section": "Background Tasks",
            "complexity": "low",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257457,
          "rank": 5,
          "relevance_score": 0.8825745700000001,
          "mmr_score": null
        }
      ]
    },
    {
      "query": "integration tests with test client and database rollback",
      "category": "testing",
      "found": 5,
      "expected": 2,
      "avg_similarity": 0.8125746399999999,
      "passed": true,
      "examples": [
        {
          "id": "f7cd7a35-a101-4562-abc7-d2ede1adad3a",
          "code": "from typing import Optional\nfrom fastapi import FastAPI, status\nfrom pydantic import BaseModel\n\nclass Item(BaseModel):\n    name: str\n    description: Optional[str] = None\n    price: float\n    tax: float = 10.5\n    tags: list[str] = []\n\napp = FastAPI()\n\n@app.post(\"/items/\", response_model=Item, status_code=status.HTTP_201_CREATED)\nasync def create_item(item: Item):\n    item_dict = item.dict()\n    if item.tax:\n        price_with_tax = item.price + item.tax\n        item_dict.update({\"price_with_tax\": price_with_tax})\n    return item_dict\n\n@app.get(\"/items/\", response_model=list[Item])\nasync def read_items():\n    return [\n        {\"name\": \"Foo\", \"price\": 50},\n        {\"name\": \"Bar\", \"description\": \"The bartenders\", \"price\": 62, \"tax\": 20.2},\n        {\"name\": \"Baz\", \"price\": 50.2, \"tax\": 10.5, \"tags\": [\"tag1\"]},\n    ]",
          "metadata": {
            "framework": "fastapi",
            "code_length": 824,
            "complexity": "medium",
            "docs_section": "Advanced - Response Model",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "quality": "official_example",
            "pattern": "fastapi_response_model",
            "task_type": "api_development",
            "approved": true,
            "source": "official_docs",
            "tags": "fastapi,response-model,status,http",
            "language": "python",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257468,
          "rank": 1,
          "relevance_score": 0.8825746800000001,
          "mmr_score": null
        },
        {
          "id": "a7f7bd26-f761-4863-ba1a-02271291508f",
          "code": "from sqlalchemy.ext.hybrid import hybrid_property\nfrom sqlalchemy.orm import Mapped, mapped_column\n\nclass Product(Base):\n    __tablename__ = \"products\"\n    id: Mapped[int] = mapped_column(primary_key=True)\n    name: Mapped[str]\n    _price: Mapped[float] = mapped_column(\"price\")\n    tax_rate: Mapped[float] = mapped_column(default=0.10)\n    \n    @hybrid_property\n    def price_with_tax(self) -> float:\n        return self._price * (1 + self.tax_rate)\n    \n    @price_with_tax.expression\n    def price_with_tax(cls):\n        return cls._price * (1 + cls.tax_rate)\n\nasync def get_expensive_products(session):\n    stmt = select(Product).where(Product.price_with_tax > 100)\n    return await session.execute(stmt)",
          "metadata": {
            "complexity": "high",
            "language": "python",
            "quality": "production",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "task_type": "database_patterns",
            "tags": "sqlalchemy,hybrid_property,computed,expressions",
            "framework": "sqlalchemy",
            "code_length": 708,
            "approved": true,
            "pattern": "sqlalchemy_hybrid_property",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 2,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "711b0da2-ab81-4e4a-85f3-efa7c2c2f712",
          "code": "# Multi-stage Dockerfile\nFROM python:3.12-slim as builder\nWORKDIR /app\nRUN python -m venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nCOPY requirements.txt .\nRUN pip install --no-cache-dir -r requirements.txt\n\nFROM python:3.12-slim\nWORKDIR /app\nCOPY --from=builder /opt/venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nRUN useradd -m appuser\nCOPY . .\nUSER appuser\nHEALTHCHECK CMD curl -f http://localhost:8000/health\nEXPOSE 8000\nCMD [\"uvicorn\", \"main:app\", \"--host\", \"0.0.0.0\"]",
          "metadata": {
            "language": "dockerfile",
            "framework": "docker",
            "pattern": "docker_multistage",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "tags": "docker,multistage,optimization",
            "code_length": 471,
            "task_type": "deployment",
            "quality": "production",
            "approved": true,
            "complexity": "medium",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 3,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "47a04ff3-af4b-4388-97ef-4b6779c36b19",
          "code": "from fastapi import FastAPI, BackgroundTasks\n\napp = FastAPI()\n\ndef write_log(message: str):\n    with open(\"log.txt\", \"a\") as f:\n        f.write(message + \"\n\")\n\n@app.post(\"/notify\")\nasync def send_notification(bg: BackgroundTasks, email: str):\n    bg.add_task(write_log, f\"Notify: {email}\")\n    return {\"status\": \"scheduled\"}",
          "metadata": {
            "quality": "official_example",
            "approved": true,
            "tags": "fastapi,background,io",
            "docs_section": "Background Tasks",
            "source": "official_docs",
            "complexity": "low",
            "language": "python",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "framework": "fastapi",
            "task_type": "background_jobs",
            "pattern": "fastapi_background_tasks",
            "code_length": 324,
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 4,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "f909508d-1bb3-4a88-9807-1ee5059d9798",
          "code": "def decompose_data_pipeline_tasks(requirements: str) -> List[Task]:\n    '''Decompose data pipeline/ETL system into tasks.'''\n    return [\n        Task(\n            id=1,\n            name=\"Data Source Integration\",\n            description=\"Connect to data sources (APIs, databases, S3), implement connectors with retry logic\",\n            dependencies=[],\n            priority=\"high\",\n            estimated_time=\"2h\",\n            files=[\"connectors/api_connector.py\", \"connectors/db_connector.py\", \"connectors/s3_connector.py\"]\n        ),\n        Task(\n            id=2,\n            name=\"Data Validation & Quality Checks\",\n            description=\"Implement Great Expectations for data validation, define quality rules, alerting on anomalies\",\n            dependencies=[1],\n            priority=\"high\",\n            estimated_time=\"2.5h\",\n            files=[\"validation/expectations/\", \"validation/rules.py\", \"validation/quality_checks.py\"]\n        ),\n        Task(\n            id=3,\n            name=\"Data Transformation Layer\",\n            description=\"Build transformation pipeline with Pandas/Polars, implement data cleaning, enrichment, aggregation\",\n            dependencies=[2],\n            priority=\"high\",\n            estimated_time=\"3h\",\n            files=[\"transformers/cleaning.py\", \"transformers/enrichment.py\", \"transformers/aggregation.py\"]\n        ),\n        Task(\n            id=4,\n            name=\"Data Warehouse Loading\",\n            description=\"Implement incremental loading to data warehouse, handle deduplication, maintain idempotency\",\n            dependencies=[3],\n            priority=\"high\",\n            estimated_time=\"2h\",\n            files=[\"loaders/warehouse_loader.py\", \"loaders/incremental.py\"]\n        ),\n        Task(\n            id=5,\n            name=\"Orchestration & Scheduling\",\n            description=\"Setup Airflow/Prefect DAGs, define dependencies, configure retries and SLAs\",\n            dependencies=[4],\n            priority=\"medium\",\n            estimated_time=\"2h\",\n            files=[\"dags/main_pipeline.py\", \"dags/monitoring.py\"]\n        ),\n        Task(\n            id=6,\n            name=\"Monitoring & Alerting\",\n            description=\"Data quality metrics, pipeline performance monitoring, alerting on failures or anomalies\",\n            dependencies=[5],\n            priority=\"high\",\n            estimated_time=\"1.5h\",\n            files=[\"monitoring/metrics.py\", \"monitoring/alerts.py\"]\n        ),\n    ]",
          "metadata": {
            "quality": "production",
            "pattern": "task_decomposition",
            "language": "python",
            "tags": "planning,etl,data_engineering,pipeline,airflow",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "complexity": "high",
            "approved": true,
            "code_length": 2460,
            "project_type": "data_pipeline",
            "task_type": "project_planning",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 5,
          "relevance_score": 0.86257463,
          "mmr_score": null
        }
      ]
    },
    {
      "query": "mocking external services with patch decorator",
      "category": "testing",
      "found": 5,
      "expected": 1,
      "avg_similarity": 0.8125745819999999,
      "passed": true,
      "examples": [
        {
          "id": "f7cd7a35-a101-4562-abc7-d2ede1adad3a",
          "code": "from typing import Optional\nfrom fastapi import FastAPI, status\nfrom pydantic import BaseModel\n\nclass Item(BaseModel):\n    name: str\n    description: Optional[str] = None\n    price: float\n    tax: float = 10.5\n    tags: list[str] = []\n\napp = FastAPI()\n\n@app.post(\"/items/\", response_model=Item, status_code=status.HTTP_201_CREATED)\nasync def create_item(item: Item):\n    item_dict = item.dict()\n    if item.tax:\n        price_with_tax = item.price + item.tax\n        item_dict.update({\"price_with_tax\": price_with_tax})\n    return item_dict\n\n@app.get(\"/items/\", response_model=list[Item])\nasync def read_items():\n    return [\n        {\"name\": \"Foo\", \"price\": 50},\n        {\"name\": \"Bar\", \"description\": \"The bartenders\", \"price\": 62, \"tax\": 20.2},\n        {\"name\": \"Baz\", \"price\": 50.2, \"tax\": 10.5, \"tags\": [\"tag1\"]},\n    ]",
          "metadata": {
            "indexed_at": "2025-11-03T12:59:49.615879",
            "pattern": "fastapi_response_model",
            "task_type": "api_development",
            "quality": "official_example",
            "approved": true,
            "framework": "fastapi",
            "code_length": 824,
            "docs_section": "Advanced - Response Model",
            "tags": "fastapi,response-model,status,http",
            "complexity": "medium",
            "language": "python",
            "source": "official_docs",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257463,
          "rank": 1,
          "relevance_score": 0.88257463,
          "mmr_score": null
        },
        {
          "id": "803efb55-2e90-4ffa-942c-1df8a3b92603",
          "code": "from circuitbreaker import circuit\nimport httpx\n\nclass ResilientClient:\n    @circuit(failure_threshold=5, recovery_timeout=60)\n    async def call_service(self, url: str) -> dict:\n        async with httpx.AsyncClient() as client:\n            response = await client.get(url)\n            response.raise_for_status()\n            return response.json()\n\n# Usage\nclient = ResilientClient()\ntry:\n    data = await client.call_service(\"http://api-service/endpoint\")\nexcept Exception as e:\n    # Handle circuit breaker open\n    pass",
          "metadata": {
            "framework": "circuitbreaker",
            "complexity": "high",
            "approved": true,
            "tags": "microservices,circuit-breaker,resilience",
            "code_length": 523,
            "language": "python",
            "pattern": "circuit_breaker",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "task_type": "service_communication",
            "quality": "production",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257457,
          "rank": 2,
          "relevance_score": 0.8825745700000001,
          "mmr_score": null
        },
        {
          "id": "711b0da2-ab81-4e4a-85f3-efa7c2c2f712",
          "code": "# Multi-stage Dockerfile\nFROM python:3.12-slim as builder\nWORKDIR /app\nRUN python -m venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nCOPY requirements.txt .\nRUN pip install --no-cache-dir -r requirements.txt\n\nFROM python:3.12-slim\nWORKDIR /app\nCOPY --from=builder /opt/venv /opt/venv\nENV PATH=\"/opt/venv/bin:$PATH\"\nRUN useradd -m appuser\nCOPY . .\nUSER appuser\nHEALTHCHECK CMD curl -f http://localhost:8000/health\nEXPOSE 8000\nCMD [\"uvicorn\", \"main:app\", \"--host\", \"0.0.0.0\"]",
          "metadata": {
            "framework": "docker",
            "approved": true,
            "complexity": "medium",
            "quality": "production",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "tags": "docker,multistage,optimization",
            "task_type": "deployment",
            "code_length": 471,
            "language": "dockerfile",
            "pattern": "docker_multistage",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257457,
          "rank": 3,
          "relevance_score": 0.8825745700000001,
          "mmr_score": null
        },
        {
          "id": "47a04ff3-af4b-4388-97ef-4b6779c36b19",
          "code": "from fastapi import FastAPI, BackgroundTasks\n\napp = FastAPI()\n\ndef write_log(message: str):\n    with open(\"log.txt\", \"a\") as f:\n        f.write(message + \"\n\")\n\n@app.post(\"/notify\")\nasync def send_notification(bg: BackgroundTasks, email: str):\n    bg.add_task(write_log, f\"Notify: {email}\")\n    return {\"status\": \"scheduled\"}",
          "metadata": {
            "docs_section": "Background Tasks",
            "source": "official_docs",
            "task_type": "background_jobs",
            "code_length": 324,
            "indexed_at": "2025-11-03T12:59:49.615879",
            "language": "python",
            "quality": "official_example",
            "framework": "fastapi",
            "approved": true,
            "tags": "fastapi,background,io",
            "pattern": "fastapi_background_tasks",
            "complexity": "low",
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257457,
          "rank": 4,
          "relevance_score": 0.8825745700000001,
          "mmr_score": null
        },
        {
          "id": "f909508d-1bb3-4a88-9807-1ee5059d9798",
          "code": "def decompose_data_pipeline_tasks(requirements: str) -> List[Task]:\n    '''Decompose data pipeline/ETL system into tasks.'''\n    return [\n        Task(\n            id=1,\n            name=\"Data Source Integration\",\n            description=\"Connect to data sources (APIs, databases, S3), implement connectors with retry logic\",\n            dependencies=[],\n            priority=\"high\",\n            estimated_time=\"2h\",\n            files=[\"connectors/api_connector.py\", \"connectors/db_connector.py\", \"connectors/s3_connector.py\"]\n        ),\n        Task(\n            id=2,\n            name=\"Data Validation & Quality Checks\",\n            description=\"Implement Great Expectations for data validation, define quality rules, alerting on anomalies\",\n            dependencies=[1],\n            priority=\"high\",\n            estimated_time=\"2.5h\",\n            files=[\"validation/expectations/\", \"validation/rules.py\", \"validation/quality_checks.py\"]\n        ),\n        Task(\n            id=3,\n            name=\"Data Transformation Layer\",\n            description=\"Build transformation pipeline with Pandas/Polars, implement data cleaning, enrichment, aggregation\",\n            dependencies=[2],\n            priority=\"high\",\n            estimated_time=\"3h\",\n            files=[\"transformers/cleaning.py\", \"transformers/enrichment.py\", \"transformers/aggregation.py\"]\n        ),\n        Task(\n            id=4,\n            name=\"Data Warehouse Loading\",\n            description=\"Implement incremental loading to data warehouse, handle deduplication, maintain idempotency\",\n            dependencies=[3],\n            priority=\"high\",\n            estimated_time=\"2h\",\n            files=[\"loaders/warehouse_loader.py\", \"loaders/incremental.py\"]\n        ),\n        Task(\n            id=5,\n            name=\"Orchestration & Scheduling\",\n            description=\"Setup Airflow/Prefect DAGs, define dependencies, configure retries and SLAs\",\n            dependencies=[4],\n            priority=\"medium\",\n            estimated_time=\"2h\",\n            files=[\"dags/main_pipeline.py\", \"dags/monitoring.py\"]\n        ),\n        Task(\n            id=6,\n            name=\"Monitoring & Alerting\",\n            description=\"Data quality metrics, pipeline performance monitoring, alerting on failures or anomalies\",\n            dependencies=[5],\n            priority=\"high\",\n            estimated_time=\"1.5h\",\n            files=[\"monitoring/metrics.py\", \"monitoring/alerts.py\"]\n        ),\n    ]",
          "metadata": {
            "pattern": "task_decomposition",
            "language": "python",
            "indexed_at": "2025-11-03T12:59:49.615879",
            "task_type": "project_planning",
            "project_type": "data_pipeline",
            "complexity": "high",
            "quality": "production",
            "tags": "planning,etl,data_engineering,pipeline,airflow",
            "approved": true,
            "code_length": 2460,
            "collection": "curated",
            "source_collection": "curated"
          },
          "similarity": 0.81257457,
          "rank": 5,
          "relevance_score": 0.86257457,
          "mmr_score": null
        }
      ]
    }
  ],
  "failed_categories": {}
}