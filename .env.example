# ========================================
# DevMatrix MVP - Environment Variables
# ========================================

# ========================================
# REQUIRED SECURITY SETTINGS (No Defaults)
# ========================================

# JWT Secret Key (REQUIRED)
# Must be at least 32 characters
# Generate with: python -c "import secrets; print(secrets.token_hex(32))"
JWT_SECRET=your_super_secret_jwt_key_min_32_chars_required_change_this_in_production

# Database URL (REQUIRED)
# Format: postgresql://user:password@host:port/database
DATABASE_URL=postgresql://devmatrix_user:devmatrix_password@localhost:5432/devmatrix_db

# ========================================
# CORS Configuration
# ========================================

# Comma-separated list of allowed CORS origins
# Example: http://localhost:3000,https://app.example.com
CORS_ALLOWED_ORIGINS=http://localhost:3000

# ========================================
# Redis Configuration
# ========================================

REDIS_HOST=localhost
REDIS_PORT=6379
# REDIS_PASSWORD=optional_redis_password

# ========================================
# JWT Configuration
# ========================================

JWT_ACCESS_TOKEN_EXPIRE_MINUTES=60
JWT_REFRESH_TOKEN_EXPIRE_DAYS=30
JWT_ALGORITHM=HS256

# ========================================
# Environment
# ========================================

ENVIRONMENT=development

# ========================================
# Phase 2: Password Policy (NIST Compliant)
# ========================================

PASSWORD_MIN_LENGTH=12
PASSWORD_MAX_LENGTH=128
PASSWORD_MIN_ENTROPY=3

# ========================================
# Phase 2: Account Lockout Protection
# ========================================

ACCOUNT_LOCKOUT_THRESHOLD=5
ACCOUNT_LOCKOUT_WINDOW_MINUTES=15
ACCOUNT_LOCKOUT_DURATIONS=15,30,60,120,240

# ========================================
# Phase 2: Session Timeout Management
# ========================================

SESSION_IDLE_TIMEOUT_MINUTES=30
SESSION_ABSOLUTE_TIMEOUT_HOURS=12

# ========================================
# Phase 2: IP-Based Access Controls
# ========================================

# Comma-separated list of IPs and CIDR ranges allowed to access admin endpoints
# Example: 192.168.1.0/24,10.0.0.5,203.0.113.0/25
# Empty string allows all IPs (IP restriction disabled)
ADMIN_IP_WHITELIST=

# ========================================
# Phase 2: 2FA/MFA Settings
# ========================================

TOTP_ISSUER_NAME=DevMatrix
TOTP_DIGITS=6
TOTP_INTERVAL=30
ENFORCE_2FA=false

# Fernet encryption key for TOTP secrets (base64-encoded 32-byte key)
# Generate with: python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
# TOTP_ENCRYPTION_KEY=your_fernet_encryption_key_here

# ========================================
# Phase 2: Enhanced Audit Logging
# ========================================

# Enable logging of read operations (GET requests)
AUDIT_READ_OPERATIONS=true

# Comma-separated list of paths to exclude from read operation logging
AUDIT_EXCLUDED_PATHS=/health,/metrics,/auth/session/keep-alive

# ========================================
# Phase 2: Security Monitoring
# ========================================

# Interval (in minutes) for running security event detection batch job
SECURITY_MONITORING_INTERVAL_MINUTES=5

# Path to GeoIP2 database file for geo-location detection (optional)
# Example: /path/to/GeoLite2-Country.mmdb
# If not provided, geo-location detection will use country data from audit log metadata
# GEOIP2_DATABASE_PATH=/path/to/GeoLite2-Country.mmdb

# ========================================
# Phase 2: Alert System (Task Group 14)
# ========================================

# Slack webhook URL for alert notifications (optional)
# Get webhook URL from: https://api.slack.com/messaging/webhooks
# Example: https://hooks.slack.com/services/T00000000/B00000000/XXXXXXXXXXXXXXXXXXXX
# If not provided, Slack alerts will be disabled
# SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL

# PagerDuty Events API v2 routing key for critical alerts (optional)
# Get routing key from: https://support.pagerduty.com/docs/services-and-integrations
# Example: R0XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
# If not provided, PagerDuty alerts will be disabled
# PAGERDUTY_API_KEY=R0XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX

# Hours to throttle duplicate alerts (max 1 alert per event type per user per hour)
ALERT_THROTTLE_HOURS=1

# ========================================
# MGE V2 Configuration (Masterplan Generation Engine V2)
# ========================================

# Enable MGE V2 execution pipeline (vs legacy OrchestratorAgent)
# Set to 'true' to use MGE V2 (98% precision, 1.5 hour execution)
# Set to 'false' to use legacy V1 (87% precision, 13 hour execution)
MGE_V2_ENABLED=false

# Maximum concurrent atoms per wave (default: 100)
# Higher values = faster execution but more memory usage
MGE_V2_MAX_CONCURRENCY=100

# Maximum retry attempts per atom (default: 4)
# Includes initial attempt + 3 retries with temperature backoff
MGE_V2_MAX_RETRIES=4

# Enable MGE V2 LLM response caching (default: true)
# Reduces costs by 90% for cached responses
MGE_V2_ENABLE_CACHING=true

# Enable RAG (Retrieval-Augmented Generation) for masterplan generation (default: true)
# Uses code examples from ChromaDB to improve generation quality
MGE_V2_ENABLE_RAG=true


FIGMA_API_KEY=your_figma_api_key_here
# ==========================================
# Cognitive Architecture MVP - Infrastructure
# ==========================================

# Neo4j Configuration (EXISTING INFRASTRUCTURE - 30,071 pattern nodes)
NEO4J_URI=bolt://localhost:7687
NEO4J_USER=neo4j
NEO4J_PASSWORD=your_neo4j_password_here
NEO4J_DATABASE=neo4j

# Qdrant Configuration (EXISTING INFRASTRUCTURE - 21,624 patterns)
QDRANT_HOST=localhost
QDRANT_PORT=6333
QDRANT_COLLECTION_PATTERNS=devmatrix_patterns
QDRANT_COLLECTION_SEMANTIC=semantic_patterns

# Cognitive Architecture Settings
PATTERN_SIMILARITY_THRESHOLD=0.85
PATTERN_REUSE_TARGET=0.30
CPIE_MAX_INFERENCE_TIME=5
CPIE_PRECISION_THRESHOLD=0.95
E2E_PRECISION_TARGET=0.88
ATOMIC_PRECISION_TARGET=0.92
UNIT_TEST_COVERAGE_TARGET=0.95
CO_REASONING_ENABLED=true
LRM_ENABLED=false
LRM_COMPLEXITY_THRESHOLD=0.8
